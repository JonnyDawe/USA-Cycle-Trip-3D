(self.webpackChunk=self.webpackChunk||[]).push([[3471],{73471:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>y});var a=i(78155),r=i(20215),s=i(80219),n=i(88903),h=i(98548),o=i(9892),d=i(31280),p=i(10594),l=i(50822),m=i(71391),c=i(9591);i(20736),i(4169),i(92858),i(26799),i(43356),i(93875),i(14215),i(60816),i(86897),i(5772),i(79766),i(24776),i(2098),i(78191),i(80163),i(1045),i(75200),i(80987),i(31531),i(17762),i(334),i(93242),i(87405),i(67726),i(59312),i(29831),i(89710),i(40130),i(31516),i(36845),i(58404),i(25290),i(65352),i(12046),i(95186),i(93443),i(13564),i(29218),i(32769),i(83731),i(62121),i(55688),i(15015),i(95629),i(9612),i(52109),i(6585),i(3621),i(63358),i(76326),i(4807),i(30316),i(29126),i(61888),i(18559),i(42296),i(17331),i(41290),i(91236),i(82906),i(52957),i(82361),i(71394),i(73574),i(81135),i(94527),i(29832),i(95559),i(68631),i(56803),i(18143),i(47365),i(67079),i(2903),i(85570),i(71470),i(80136),i(91507),i(85289),i(98843),i(91790),i(52737),i(16040),i(34396),i(5250),i(49878),i(84271),i(48643),i(4618),i(80657),i(94449),i(97325),i(3629),i(79506),i(26779),i(98420),i(54223),i(8725),i(51218),i(21793),i(13895),i(15576),i(28941),i(19438),i(15022),i(56416),i(92758),i(78435),i(53902),i(40481),i(78730),i(2570),i(71666),i(72257),i(41822),i(99987),i(11838),i(39068),i(10662);const u=s.n.getLogger("esri.views.2d.layers.WMSLayerView2D");let g=class extends((0,c.a)((0,m.aa)((0,d.l)(l.d)))){initialize(){const{layer:e,view:t}=this;e.supportsSpatialReference(t.spatialReference)||this.addResolvingPromise(Promise.reject(new r.s("layerview:spatial-reference-incompatible","The spatial references supported by this WMS layer are incompatible with the spatial reference of the view",{layer:e})))}hitTest(){return null}update(e){this.strategy.update(e).catch((e=>{(0,r.g)(e)||u.error(e)}))}attach(){const{layer:e}=this,{imageMaxHeight:t,imageMaxWidth:i}=e;this._bitmapContainer=new o.t,this.container.addChild(this._bitmapContainer),this.strategy=new p.S({container:this._bitmapContainer,fetchSource:this.fetchImage.bind(this),requestUpdate:this.requestUpdate.bind(this),imageMaxHeight:t,imageMaxWidth:i,imageRotationSupported:!1,imageNormalizationSupported:!1,hidpi:!1}),this.handles.add(this.watch("exportImageVersion",(()=>this.requestUpdate())),"exportImageVersion")}detach(){this.handles.remove("exportImageVersion"),this.strategy.destroy(),this.container.removeChild(this._bitmapContainer),this._bitmapContainer.removeAllChildren()}moveStart(){}viewChange(){}moveEnd(){this.requestUpdate()}createFetchPopupFeaturesQuery(e){const{view:t}=this,i=this._bitmapContainer,{x:a,y:r}=e,{spatialReference:s}=t;let n=null,o=0,d=0;if(i.children.some((e=>{const{width:t,height:i,resolution:p,x:l,y:m}=e,c=l+p*t,u=m-p*i;return a>=l&&a<=c&&r<=m&&r>=u&&(n=new h.M({xmin:l,ymin:u,xmax:c,ymax:m,spatialReference:s}),o=t,d=i,!0)})),!n)return null;const p=n.width/o,l=Math.round((a-n.xmin)/p),m=Math.round((n.ymax-r)/p);return{extent:n,width:o,height:d,x:l,y:m}}async doRefresh(){this.requestUpdate()}isUpdating(){return this.strategy.updating||this.updateRequested}fetchImage(e,t,i,a){return this.layer.fetchImage(e,t,i,{timeExtent:this.timeExtent,timestamp:this.refreshTimestamp,...a})}};(0,a.e)([(0,n.y)()],g.prototype,"strategy",void 0),(0,a.e)([(0,n.y)()],g.prototype,"updating",void 0),g=(0,a.e)([(0,n.n)("esri.views.2d.layers.WMSLayerView2D")],g);const y=g}}]);
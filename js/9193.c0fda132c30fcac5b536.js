(self.webpackChunk=self.webpackChunk||[]).push([[9193],{29193:(e,n,t)=>{"use strict";t.r(n),t.d(n,{registerFunctions:()=>y});var r=t(9389),i=t(50985),a=t(67098),l=t(20215),s=t(54622),o=t(16040),f=t(47365);function u(e,n,t){const r=e.getVariables();if(r.length>0){const i=[];for(let e=0;e<r.length;e++){const a={name:r[e]};i.push(n.evaluateIdentifier(t,a))}return(0,l.c)(i).then((n=>{const t={};for(let e=0;e<r.length;e++)t[r[e]]=n[e];return e.parameters=t,e}))}return(0,l.x)(e)}function c(e,n,t=null){for(const t in e)if(t.toLowerCase()===n.toLowerCase())return e[t];return t}function d(e){if(null===e)return null;const n={type:c(e,"type",""),name:c(e,"name","")};if("range"===n.type)n.range=c(e,"range",[]);else{n.codedValues=[];for(const t of c(e,"codedValues",[]))n.codedValues.push({name:c(t,"name",""),code:c(t,"code",null)})}return n}function m(e){if(null===e)return null;const n={},t=c(e,"wkt",null);null!==t&&(n.wkt=t);const r=c(e,"wkid",null);return null!==r&&(n.wkid=r),n}function p(e){if(null===e)return null;const n={hasZ:c(e,"hasz",!1),hasM:c(e,"hasm",!1)},t=c(e,"spatialreference",null);t&&(n.spatialReference=m(t));const r=c(e,"x",null);if(null!==r)return n.x=r,n.y=c(e,"y",null),n;const i=c(e,"rings",null);if(null!==i)return n.rings=i,n;const a=c(e,"paths",null);if(null!==a)return n.paths=a,n;const l=c(e,"points",null);if(null!==l)return n.points=l,n;for(const t of["xmin","xmax","ymin","ymax","zmin","zmax","mmin","mmax"]){const r=c(e,t,null);null!==r&&(n[t]=r)}return n}function y(e){"async"===e.mode&&(e.functions.getuser=function(n,t){return e.standardFunctionAsync(n,t,((e,t,a)=>{(0,r.J)(a,1,2);let l=(0,r.M)(a[1],""),s=!0===l;if(l=!0===l||!1===l?"":(0,r.K)(l),a[0]instanceof r.s){let e=null;return n.services&&n.services.portal&&(e=n.services.portal),e=(0,i.b)(a[0],e),(0,i.D)(e,l,s).then((e=>{if(e){const n=JSON.parse(JSON.stringify(e));for(const e of["lastLogin","created","modified"])void 0!==n[e]&&null!==n[e]&&(n[e]=new Date(n[e]));return r.i.convertObjectToArcadeDictionary(n)}return null}))}let o=null;if((0,r.l)(a[0])&&(o=a[0]),o)return s=!1,l?null:o.load().then((()=>o.getOwningSystemUrl())).then((e=>{if(!e)return l?null:o.getIdentityUser().then((e=>e?r.i.convertObjectToArcadeDictionary({username:e}):null));let t=null;return n.services&&n.services.portal&&(t=n.services.portal),t=(0,i.b)(new r.s(e),t),(0,i.D)(t,l,s).then((e=>{if(e){const n=JSON.parse(JSON.stringify(e));for(const e of["lastLogin","created","modified"])void 0!==n[e]&&null!==n[e]&&(n[e]=new Date(n[e]));return r.i.convertObjectToArcadeDictionary(n)}return null}))}));throw new Error("Invalid Parameter")}))},e.signatures.push({name:"getuser",min:"1",max:"2"}),e.functions.featuresetbyid=function(n,t){return e.standardFunctionAsync(n,t,((e,n,t)=>{if((0,r.J)(t,2,4),t[0]instanceof i.r){const e=(0,r.K)(t[1]);let n=(0,r.M)(t[2],null);const i=(0,r.W)((0,r.M)(t[3],!0));if(null===n&&(n=["*"]),!1===(0,r.Z)(n))throw new Error("Invalid Parameter");return t[0].featureSetById(e,i,n)}throw new Error("Invalid Parameter")}))},e.signatures.push({name:"featuresetbyid",min:"2",max:"4"}),e.functions.featuresetbyportalitem=function(n,t){return e.standardFunctionAsync(n,t,((e,t,a)=>{if((0,r.J)(a,2,5),null===a[0])throw new Error("Portal is required");if(a[0]instanceof r.s){const e=(0,r.K)(a[1]),t=(0,r.K)(a[2]);let l=(0,r.M)(a[3],null);const s=(0,r.W)((0,r.M)(a[4],!0));if(null===l&&(l=["*"]),!1===(0,r.Z)(l))throw new Error("Invalid Parameter");let o=null;return n.services&&n.services.portal&&(o=n.services.portal),o=(0,i.b)(a[0],o),(0,i.q)(e,t,n.spatialReference,l,s,o,n.lrucache,n.interceptor)}if(!1===(0,r.w)(a[0]))throw new Error("Portal is required");const l=(0,r.K)(a[0]),s=(0,r.K)(a[1]);let o=(0,r.M)(a[2],null);const f=(0,r.W)((0,r.M)(a[3],!0));if(null===o&&(o=["*"]),!1===(0,r.Z)(o))throw new Error("Invalid Parameter");if(n.services&&n.services.portal)return(0,i.q)(l,s,n.spatialReference,o,f,n.services.portal,n.lrucache,n.interceptor);throw new Error("Portal is required")}))},e.signatures.push({name:"featuresetbyportalitem",min:"2",max:"5"}),e.functions.featuresetbyname=function(n,t){return e.standardFunctionAsync(n,t,((e,n,t)=>{if((0,r.J)(t,2,4),t[0]instanceof i.r){const e=(0,r.K)(t[1]);let n=(0,r.M)(t[2],null);const i=(0,r.W)((0,r.M)(t[3],!0));if(null===n&&(n=["*"]),!1===(0,r.Z)(n))throw new Error("Invalid Parameter");return t[0].featureSetByName(e,i,n)}throw new Error("Invalid Parameter")}))},e.signatures.push({name:"featuresetbyname",min:"2",max:"4"}),e.functions.featureset=function(n,t){return e.standardFunction(n,t,((e,t,a)=>{(0,r.J)(a,1,1);let l=a[0];const s={layerDefinition:{geometryType:"",objectIdField:"",globalIdField:"",typeIdField:"",fields:[]},featureSet:{geometryType:"",features:[]}};if((0,r.w)(l))l=JSON.parse(l),void 0!==l.layerDefinition?(s.layerDefinition=l.layerDefinition,s.featureSet=l.featureSet,l.layerDefinition.spatialReference&&(s.layerDefinition.spatialReference=l.layerDefinition.spatialReference)):(s.featureSet.features=l.features,s.featureSet.geometryType=l.geometryType,s.layerDefinition.geometryType=s.featureSet.geometryType,s.layerDefinition.objectIdField=l.objectIdFieldName,s.layerDefinition.typeIdField=l.typeIdFieldName,s.layerDefinition.globalIdField=l.globalIdFieldName,s.layerDefinition.fields=l.fields,l.spatialReference&&(s.layerDefinition.spatialReference=l.spatialReference));else{if(!(a[0]instanceof r.i))throw new Error("Invalid Parameter");{l=JSON.parse(a[0].castToText());const e=c(l,"layerdefinition");if(null!==e){s.layerDefinition.geometryType=c(e,"geometrytype",""),s.featureSet.geometryType=s.layerDefinition.geometryType,s.layerDefinition.globalIdField=c(e,"globalidfield",""),s.layerDefinition.objectIdField=c(e,"objectidfield",""),s.layerDefinition.typeIdField=c(e,"typeidfield","");const n=c(e,"spatialreference",null);n&&(s.layerDefinition.spatialReference=m(n));for(const n of c(e,"fields",[])){const e={name:c(n,"name",""),alias:c(n,"alias",""),type:c(n,"type",""),nullable:c(n,"nullable",!0),editable:c(n,"editable",!0),length:c(n,"length",null),domain:d(c(n,"domain"))};s.layerDefinition.fields.push(e)}const t=c(l,"featureset",null);if(t){const e={};for(const n of s.layerDefinition.fields)e[n.name.toLowerCase()]=n.name;for(const n of c(t,"features",[])){const t={},r=c(n,"attributes",{});for(const n in r)t[e[n.toLowerCase()]]=r[n];s.featureSet.features.push({attributes:t,geometry:p(c(n,"geometry",null))})}}}else{s.layerDefinition.geometryType=c(l,"geometrytype",""),s.featureSet.geometryType=s.layerDefinition.geometryType,s.layerDefinition.objectIdField=c(l,"objectidfieldname",""),s.layerDefinition.typeIdField=c(l,"typeidfieldname","");const e=c(l,"spatialreference",null);e&&(s.layerDefinition.spatialReference=m(e));for(const e of c(l,"fields",[])){const n={name:c(e,"name",""),alias:c(e,"alias",""),type:c(e,"type",""),nullable:c(e,"nullable",!0),editable:c(e,"editable",!0),length:c(e,"length",null),domain:d(c(e,"domain"))};s.layerDefinition.fields.push(n)}const n={};for(const e of s.layerDefinition.fields)n[e.name.toLowerCase()]=e.name;for(const e of c(l,"features",[])){const t={},r=c(e,"attributes",{});for(const e in r)t[n[e.toLowerCase()]]=r[e];s.featureSet.features.push({attributes:t,geometry:p(c(e,"geometry",null))})}}}}if(!1===function(e){return!!e.layerDefinition&&!!e.featureSet&&!1!==function(e,n){for(const n of["","esriGeometryPoint","esriGeometryPolyline","esriGeometryPolygon","esriGeometryMultipoint","esriGeometryEnvelope"])if(n===e)return!0;return!1}(e.layerDefinition.geometryType)&&null!==e.layerDefinition.objectIdField&&""!==e.layerDefinition.objectIdField&&!1!==(0,r.Z)(e.layerDefinition.fields)&&!1!==(0,r.Z)(e.featureSet.features)}(s))throw new Error("Invalid Parameter");return i.y.create(s,n.spatialReference)}))},e.signatures.push({name:"featureset",min:"1",max:"1"}),e.functions.filter=function(n,t){return e.standardFunctionAsync(n,t,((t,a,o)=>((0,r.J)(o,2,2),(0,r.l)(o[0])?o[0].load().then((t=>{const r=s.WhereClause.create(o[1],t.getFieldsIndex()),a=r.getVariables();if(a.length>0){const t=[];for(let r=0;r<a.length;r++){const i={name:a[r]};t.push(e.evaluateIdentifier(n,i))}return(0,l.c)(t).then((e=>{const n={};for(let t=0;t<a.length;t++)n[a[t]]=e[t];return r.parameters=n,new i._({parentfeatureset:o[0],whereclause:r})}))}return(0,l.x)(new i._({parentfeatureset:o[0],whereclause:r}))})):e.failDefferred("Filter cannot accept this parameter type"))))},e.signatures.push({name:"filter",min:"2",max:"2"}),e.functions.orderby=function(n,t){return e.standardFunctionAsync(n,t,((n,t,a)=>{if((0,r.J)(a,2,2),(0,r.l)(a[0])){const e=new i.e(a[1]);return(0,l.x)(new i.a({parentfeatureset:a[0],orderbyclause:e}))}return e.failDefferred("Order cannot accept this parameter type")}))},e.signatures.push({name:"orderby",min:"2",max:"2"}),e.functions.top=function(n,t){return e.standardFunctionAsync(n,t,((n,t,a)=>((0,r.J)(a,2,2),(0,r.l)(a[0])?(0,l.x)(new i.c({parentfeatureset:a[0],topnum:a[1]})):(0,r.Z)(a[0])?(0,r.X)(a[1])>=a[0].length?a[0].slice(0):a[0].slice(0,(0,r.X)(a[1])):(0,r.E)(a[0])?(0,r.X)(a[1])>=a[0].length()?a[0].slice(0):a[0].slice(0,(0,r.X)(a[1])):e.failDefferred("Top cannot accept this parameter type"))))},e.signatures.push({name:"top",min:"2",max:"2"}),e.functions.first=function(n,t){return e.standardFunctionAsync(n,t,((e,n,t)=>((0,r.J)(t,1,1),(0,r.l)(t[0])?t[0].first(e.abortSignal).then((e=>{if(null!==e){const n=r.k.createFromGraphicLikeObject(e.geometry,e.attributes,t[0]);n._underlyingGraphic=e,e=n}return e})):(0,r.Z)(t[0])?0===t[0].length?(0,l.x)(null):(0,l.x)(t[0][0]):(0,r.E)(t[0])?0===t[0].length()?(0,l.x)(null):(0,l.x)(t[0].get(0)):null)))},e.signatures.push({name:"first",min:"1",max:"1"}),e.functions.attachments=function(n,t){return e.standardFunctionAsync(n,t,((e,t,a)=>{(0,r.J)(a,1,2);const l={minsize:-1,maxsize:-1,types:null};if(a.length>1)if(a[1]instanceof r.i){if(a[1].hasField("minsize")&&(l.minsize=(0,r.X)(a[1].field("minsize"))),a[1].hasField("maxsize")&&(l.maxsize=(0,r.X)(a[1].field("maxsize"))),a[1].hasField("types")){const e=(0,r.ah)(a[1].field("types"),!1);e.length>0&&(l.types=e)}}else if(null!==a[1])throw new Error("Invalid Parameter");if(a[0]instanceof r.k){let e=a[0]._layer;return e instanceof o.W&&(e=(0,i.A)(e,n.spatialReference,["*"],!0,n.lrucache,n.interceptor)),null===e||!1===(0,r.l)(e)?[]:e.load().then((()=>e.queryAttachments(a[0].field(e.objectIdField),l.minsize,l.maxsize,l.types)))}if(null===a[0])return[];throw new Error("Invalid Parameter")}))},e.signatures.push({name:"attachments",min:"1",max:"2"}),e.functions.featuresetbyrelationshipname=function(n,t){return e.standardFunctionAsync(n,t,((e,t,l)=>{(0,r.J)(l,2,4);const f=l[0],u=(0,r.K)(l[1]);let c=(0,r.M)(l[2],null);const d=(0,r.W)((0,r.M)(l[3],!0));if(null===c&&(c=["*"]),!1===(0,r.Z)(c))throw new Error("Invalid Parameter");if(null===l[0])return null;if(!(l[0]instanceof r.k))throw new Error("Invalid Parameter");let m=f._layer;return m instanceof o.W&&(m=(0,i.A)(m,n.spatialReference,["*"],!0,n.lrucache,n.interceptor)),null===m||!1===(0,r.l)(m)?null:m.load().then((e=>{const t=e.relationshipMetaData().filter((e=>e.name===u));if(0===t.length)return null;if(void 0!==t[0].relationshipTableId&&null!==t[0].relationshipTableId&&t[0].relationshipTableId>-1)return(0,i.j)(e,t[0],f.field(e.objectIdField),e.spatialReference,c,d,n.lrucache,n.interceptor);let r=e.serviceUrl();return r?(r="/"===r.charAt(r.length-1)?r+t[0].relatedTableId.toString():r+"/"+t[0].relatedTableId.toString(),(0,i.T)(r,e.spatialReference,c,d,n.lrucache,n.interceptor).then((n=>n.load().then((()=>n.relationshipMetaData())).then((r=>{if(r=r.filter((e=>e.id===t[0].id)),!1===f.hasField(t[0].keyField)||null===f.field(t[0].keyField))return e.getFeatureByObjectId(f.field(e.objectIdField),[t[0].keyField]).then((e=>{if(e){const i=s.WhereClause.create(r[0].keyField+"= @id",n.getFieldsIndex());return i.parameters={id:e.attributes[t[0].keyField]},n.filter(i)}return new a.c({parentfeatureset:n})}));const i=s.WhereClause.create(r[0].keyField+"= @id",n.getFieldsIndex());return i.parameters={id:f.field(t[0].keyField)},n.filter(i)}))))):null}))}))},e.signatures.push({name:"featuresetbyrelationshipname",min:"2",max:"4"}),e.functions.featuresetbyassociation=function(n,t){return e.standardFunctionAsync(n,t,((e,t,a)=>{(0,r.J)(a,2,3);const l=a[0],u=(0,r.K)((0,r.M)(a[1],"")).toLowerCase(),c=(0,r.w)(a[2])?(0,r.K)(a[2]):null;if(null===a[0])return null;if(!(a[0]instanceof r.k))throw new Error("Invalid Parameter");let d=l._layer;return d instanceof o.W&&(d=(0,i.A)(d,n.spatialReference,["*"],!0,n.lrucache,n.interceptor)),null===d||!1===(0,r.l)(d)?null:d.load().then((()=>{const e=d.serviceUrl();return(0,i.k)(e,n.spatialReference)})).then((e=>{let n=null,t=null,a=!1;if(null!==c&&""!==c&&void 0!==c){for(const n of e.terminals)n.terminalName===c&&(t=n.terminalId);null===t&&(a=!0)}const o=e.associations.getFieldsIndex(),m=o.get("TOGLOBALID").name,p=o.get("FROMGLOBALID").name,y=o.get("TOTERMINALID").name,h=o.get("FROMTERMINALID").name,g=o.get("FROMNETWORKSOURCEID").name,E=o.get("TONETWORKSOURCEID").name,I=o.get("ASSOCIATIONTYPE").name,F=o.get("ISCONTENTVISIBLE").name,w=o.get("OBJECTID").name;for(const e of d.fields)if("global-id"===e.type){n=l.field(e.name);break}let D=null,b=new i.d(new f.y({name:"percentalong",alias:"percentalong",type:"double"}),s.WhereClause.create("0",e.associations.getFieldsIndex())),x=new i.d(new f.y({name:"side",alias:"side",type:"string"}),s.WhereClause.create("''",e.associations.getFieldsIndex()));const A="globalid",N="globalId",S={};for(const n in e.lkp)S[n]=e.lkp[n].sourceId;const $=new i.C(new f.y({name:"classname",alias:"classname",type:"string"}),null,S);let T="";switch(u){case"midspan":{T=`((${m}='${n}') OR ( ${p}='${n}')) AND (${I} IN (5))`,$.codefield=s.WhereClause.create(`CASE WHEN (${m}='${n}') THEN ${g} ELSE ${E} END`,e.associations.getFieldsIndex());const t=(0,r.a2)(i.E.findField(e.associations.fields,p));t.name=A,t.alias=A,D=new i.d(t,s.WhereClause.create(`CASE WHEN (${p}='${n}') THEN ${m} ELSE ${p} END`,e.associations.getFieldsIndex())),b=e.unVersion>=4?new i.w(i.E.findField(e.associations.fields,o.get("PERCENTALONG").name)):new i.d(new f.y({name:"percentalong",alias:"percentalong",type:"double"}),s.WhereClause.create("0",e.associations.getFieldsIndex()));break}case"junctionedge":{T=`((${m}='${n}') OR ( ${p}='${n}')) AND (${I} IN (4,6))`,$.codefield=s.WhereClause.create(`CASE WHEN (${m}='${n}') THEN ${g} ELSE ${E} END`,e.associations.getFieldsIndex());const t=(0,r.a2)(i.E.findField(e.associations.fields,p));t.name=A,t.alias=A,D=new i.d(t,s.WhereClause.create(`CASE WHEN (${p}='${n}') THEN ${m} ELSE ${p} END`,e.associations.getFieldsIndex())),x=new i.d(new f.y({name:"side",alias:"side",type:"string"}),s.WhereClause.create(`CASE WHEN (${I}=4) THEN 'from' ELSE 'to' END`,e.associations.getFieldsIndex()));break}case"connected":{let a=`${m}='@T'`,l=`${p}='@T'`;null!==t&&(a+=` AND ${y}=@A`,l+=` AND ${h}=@A`),T="(("+a+") OR ("+l+"))",T=(0,r.ai)(T,"@T",n),a=(0,r.ai)(a,"@T",n),null!==t&&(a=(0,r.ai)(a,"@A",t.toString()),T=(0,r.ai)(T,"@A",t.toString())),$.codefield=s.WhereClause.create("CASE WHEN "+a+` THEN ${g} ELSE ${E} END`,e.associations.getFieldsIndex());const o=(0,r.a2)(i.E.findField(e.associations.fields,p));o.name=A,o.alias=A,D=new i.d(o,s.WhereClause.create("CASE WHEN "+a+` THEN ${p} ELSE ${m} END`,e.associations.getFieldsIndex()));break}case"container":T=`${m}='${n}' AND ${I} = 2`,null!==t&&(T+=` AND ${y} = `+t.toString()),$.codefield=g,T="( "+T+" )",D=new i.v(i.E.findField(e.associations.fields,p),A,A);case"content":T=`(${p}='${n}' AND ${I} = 2)`,null!==t&&(T+=` AND ${h} = `+t.toString()),$.codefield=E,T="( "+T+" )",D=new i.v(i.E.findField(e.associations.fields,m),A,A);break;case"structure":T=`(${m}='${n}' AND ${I} = 3)`,null!==t&&(T+=` AND ${y} = `+t.toString()),$.codefield=g,T="( "+T+" )",D=new i.v(i.E.findField(e.associations.fields,p),A,N);break;case"attached":T=`(${p}='${n}' AND ${I} = 3)`,null!==t&&(T+=` AND ${h} = `+t.toString()),$.codefield=E,T="( "+T+" )",D=new i.v(i.E.findField(e.associations.fields,m),A,N);break;default:throw new Error("Invalid Parameter")}return a&&(T="1 <> 1"),new i.E({parentfeatureset:e.associations,adaptedFields:[new i.w(i.E.findField(e.associations.fields,w)),new i.w(i.E.findField(e.associations.fields,F)),D,x,$,b],extraFilter:T?s.WhereClause.create(T,e.associations.getFieldsIndex()):null})}))}))},e.signatures.push({name:"featuresetbyassociation",min:"2",max:"6"}),e.functions.groupby=function(n,t){return e.standardFunctionAsync(n,t,((t,i,o)=>((0,r.J)(o,3,3),(0,r.l)(o[0])?o[0].load().then((t=>{const i=[],f=[];let c=!1,d=[];if((0,r.w)(o[1]))d.push(o[1]);else if(o[1]instanceof r.i)d.push(o[1]);else if((0,r.Z)(o[1]))d=o[1];else{if(!(0,r.E)(o[1]))return e.failDefferred("Illegal Value: GroupBy");d=o[1].toArray()}for(const n of d)if((0,r.w)(n)){const e=s.WhereClause.create((0,r.K)(n),t.getFieldsIndex()),l=!0===(0,a.E)(e)?(0,r.K)(n):"%%%%FIELDNAME";i.push({name:l,expression:e}),"%%%%FIELDNAME"===l&&(c=!0)}else{if(!(n instanceof r.i))return e.failDefferred("Illegal Value: GroupBy");{const r=n.hasField("name")?n.field("name"):"%%%%FIELDNAME",a=n.hasField("expression")?n.field("expression"):"";if("%%%%FIELDNAME"===r&&(c=!0),!r)return e.failDefferred("Illegal Value: GroupBy");i.push({name:r,expression:s.WhereClause.create(a||r,t.getFieldsIndex())})}}if(d=[],(0,r.w)(o[2]))d.push(o[2]);else if((0,r.Z)(o[2]))d=o[2];else if((0,r.E)(o[2]))d=o[2].toArray();else{if(!(o[2]instanceof r.i))return e.failDefferred("Illegal Value: GroupBy");d.push(o[2])}for(const n of d){if(!(n instanceof r.i))return e.failDefferred("Illegal Value: GroupBy");{const r=n.hasField("name")?n.field("name"):"",i=n.hasField("statistic")?n.field("statistic"):"",a=n.hasField("expression")?n.field("expression"):"";if(!r||!i||!a)return e.failDefferred("Illegal Value: GroupBy");f.push({name:r,statistic:i.toLowerCase(),expression:s.WhereClause.create(a,t.getFieldsIndex())})}}if(c){const e={};for(const n of t.fields)e[n.name.toLowerCase()]=1;for(const n of i)"%%%%FIELDNAME"!==n.name&&(e[n.name.toLowerCase()]=1);for(const n of f)"%%%%FIELDNAME"!==n.name&&(e[n.name.toLowerCase()]=1);let n=0;for(const t of i)if("%%%%FIELDNAME"===t.name){for(;1===e["field_"+n.toString()];)n++;e["field_"+n.toString()]=1,t.name="FIELD_"+n.toString()}}const m=[];for(const t of i)m.push(u(t.expression,e,n));for(const t of f)m.push(u(t.expression,e,n));return m.length>0?(0,l.c)(m).then((()=>(0,l.x)(o[0].groupby(i,f)))):(0,l.x)(o[0].groupby(i,f))})):e.failDefferred("Illegal Value: GroupBy"))))},e.signatures.push({name:"groupby",min:"3",max:"3"}),e.functions.distinct=function(n,t){return e.standardFunctionAsync(n,t,((t,i,o)=>(0,r.l)(o[0])?((0,r.J)(o,2,2),o[0].load().then((t=>{const i=[];let f=[];if((0,r.w)(o[1]))f.push(o[1]);else if(o[1]instanceof r.i)f.push(o[1]);else if((0,r.Z)(o[1]))f=o[1];else{if(!(0,r.E)(o[1]))return e.failDefferred("Illegal Value: GroupBy");f=o[1].toArray()}let c=!1;for(const n of f)if((0,r.w)(n)){const e=s.WhereClause.create((0,r.K)(n),t.getFieldsIndex()),l=!0===(0,a.E)(e)?(0,r.K)(n):"%%%%FIELDNAME";i.push({name:l,expression:e}),"%%%%FIELDNAME"===l&&(c=!0)}else{if(!(n instanceof r.i))return e.failDefferred("Illegal Value: GroupBy");{const r=n.hasField("name")?n.field("name"):"%%%%FIELDNAME",a=n.hasField("expression")?n.field("expression"):"";if("%%%%FIELDNAME"===r&&(c=!0),!r)return e.failDefferred("Illegal Value: GroupBy");i.push({name:r,expression:s.WhereClause.create(a||r,t.getFieldsIndex())})}}if(c){const e={};for(const n of t.fields)e[n.name.toLowerCase()]=1;for(const n of i)"%%%%FIELDNAME"!==n.name&&(e[n.name.toLowerCase()]=1);let n=0;for(const t of i)if("%%%%FIELDNAME"===t.name){for(;1===e["field_"+n.toString()];)n++;e["field_"+n.toString()]=1,t.name="FIELD_"+n.toString()}}const d=[];for(const t of i)d.push(u(t.expression,e,n));return d.length>0?(0,l.c)(d).then((()=>(0,l.x)(o[0].groupby(i,[])))):(0,l.x)(o[0].groupby(i,[]))}))):function(e,n,t,i){if(1===i.length){if((0,r.Z)(i[0]))return(0,r.aj)(e,i[0],-1);if((0,r.E)(i[0]))return(0,r.aj)(e,i[0].toArray(),-1)}return(0,r.aj)(e,i,-1)}("distinct",0,0,o)))})}t(20736),t(78155),t(80219),t(88903),t(4169),t(92858),t(98548),t(1598),t(3621),t(89710),t(29831),t(80987),t(31531),t(90258),t(73574),t(82906),t(40130),t(52957),t(29126),t(6585),t(63358),t(62121),t(81135),t(94527),t(17762),t(60816),t(61888),t(29832),t(31516),t(52109),t(60978),t(80136),t(91507),t(65352),t(52737),t(67079),t(18143),t(91236),t(56803),t(2903),t(85570),t(71470),t(85289),t(98843),t(91790),t(30316),t(71666),t(76326),t(6770),t(26779),t(34396),t(5250),t(49878),t(84271),t(48643),t(4618),t(80657),t(94449),t(97325),t(3629),t(83731),t(79506),t(82361),t(41290),t(98420),t(54223),t(8725),t(51218),t(21793),t(13895),t(15576),t(9612),t(28941),t(19438),t(15022),t(56416),t(92758),t(78435),t(53902),t(40481),t(78730),t(2570),t(72257),t(41822),t(99987)}}]);
(self.webpackChunk=self.webpackChunk||[]).push([[3476],{3476:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>p});var n=r(78155),i=r(20215),s=r(80219),a=r(88903),o=r(52737),l=r(7022),c=r(83991);function d(e,t){if((0,s.t)(e)&&(0,s.t)(t))return null;const r={};return(0,s.r)(t)&&(r.geometry=t.toJSON()),(0,s.r)(e)&&(r.where=e),r}r(80987),r(98548),r(20736),r(4169),r(92858),r(31531),r(73574),r(82906),r(40130),r(52957),r(29126),r(6585),r(3621),r(63358),r(62121),r(81135),r(94527),r(17762),r(60816),r(61888),r(29832),r(31516),r(52109),r(89710),r(47365),r(67079),r(36845),r(8725),r(18143),r(91236),r(43356),r(31280),r(1045),r(75200),r(334),r(93242),r(93443),r(13564),r(29218),r(26779),r(47473),r(13895),r(4618),r(65352),r(31393),r(81578),r(50822),r(32769),r(83731),r(71391),r(55688),r(15015),r(95629),r(9612),r(76326),r(4807),r(30316),r(18559),r(42296),r(17331),r(41290),r(82361),r(71394),r(95559),r(68631),r(56803),r(2903),r(85570),r(71470),r(80136),r(91507),r(85289),r(98843),r(91790),r(29831),r(16040),r(34396),r(5250),r(49878),r(84271),r(48643),r(80657),r(94449),r(97325),r(3629),r(79506),r(98420),r(54223),r(51218),r(21793),r(15576),r(28941),r(19438),r(15022),r(56416),r(92758),r(78435),r(53902),r(40481),r(78730),r(2570),r(71666),r(72257),r(41822),r(99987),r(11838),r(39068),r(24776),r(95186),r(67726),r(59312),r(67390),r(5772),r(14215),r(78191),r(13513),r(50388),r(58404),r(76119),r(60978);let y=class extends l.default{constructor(){super(...arguments),this._enabledDataReceived=!1,this.errorString=null,this.connectionStatus="disconnected"}initialize(){this.handles.add([this.layer.watch("purgeOptions",(()=>this._update()))])}destroy(){this.connectionStatus="disconnected"}get connectionError(){if(this.errorString)return new i.s("stream-controller",this.errorString)}on(e,t){"data-received"===e&&(this._enabledDataReceived=!0,this._proxy.enableEvent("data-received",!0));const r=super.on(e,t),n=this;return{remove(){r.remove(),"data-received"===e&&(n._proxy.closed||n.hasEventListener("data-received")||n._proxy.enableEvent("data-received",!1))}}}queryLatestObservations(e,t){if(!this.layer.timeInfo.endField&&!this.layer.timeInfo.startField)throw new i.s("streamlayer-no-timeField","queryLatestObservation can only be used with services that define a TrackIdField");return this._proxy.queryLatestObservations(this._cleanUpQuery(e),t).then((e=>{const t=o.default.fromJSON(e);return t.features.forEach((e=>{e.layer=this.layer,e.sourceLayer=this.layer})),t}))}_createClientOptions(){return{...super._createClientOptions(),setProperty:e=>{this.set(e.propertyName,e.value)}}}_createTileRendererHash(e){const t=`${JSON.stringify(this.layer.purgeOptions)}.${JSON.stringify(d(this.layer.definitionExpression,this.layer.geometryDefinition))})`;return super._createTileRendererHash(e)+t}async _createServiceOptions(){const e=this.layer,{objectIdField:t}=e,r=e.fields.map((e=>e.toJSON())),n=(0,c.f)(e.geometryType),i=e.timeInfo&&e.timeInfo.toJSON()||null,s=e.spatialReference?e.spatialReference.toJSON():null;return{type:"stream",fields:r,geometryType:n,objectIdField:t,timeInfo:i,source:this.layer.parsedUrl,serviceFilter:d(this.layer.definitionExpression,this.layer.geometryDefinition),purgeOptions:this.layer.purgeOptions.toJSON(),enableDataReceived:this._enabledDataReceived,spatialReference:s,maxReconnectionAttempts:this.layer.maxReconnectionAttempts,maxReconnectionInterval:this.layer.maxReconnectionInterval,updateInterval:this.layer.updateInterval}}};(0,n.e)([(0,a.y)()],y.prototype,"errorString",void 0),(0,n.e)([(0,a.y)({readOnly:!0})],y.prototype,"connectionError",null),(0,n.e)([(0,a.y)()],y.prototype,"connectionStatus",void 0),y=(0,n.e)([(0,a.n)("esri.views.2d.layers.StreamLayerView2D")],y);const p=y}}]);
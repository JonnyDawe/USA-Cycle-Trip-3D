import { n as n$1, y as y$2, c as s$4 } from './Message-70b34921.js';
import { a as a$1 } from './DisplayObject-8d4c95bb.js';
import { i, l as l$2, n, r as r$3 } from './Color-ae84a22a.js';
import { s as s$3 } from './promiseUtils-2ff2b194.js';
import { r as r$2 } from './mat4f32-5ff6470f.js';
import { o as o$1, s as s$2 } from './mat4-8eb66d33.js';

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
const r$1=(r,s)=>{const o=s$2(r,s,0,0,0,0,s,0,0,0,0,s,0,0,0,0,1);return o$1(o,o)},s$1=(r,s)=>{const o=s$2(r,s,0,0,.5-.5*s,0,s,0,.5-.5*s,0,0,s,.5-.5*s,0,0,0,1);return o$1(o,o)},o=(r,s)=>{const o=1-s,c=s$2(r,.2126+.7874*o,.7152-.7152*o,.0722-.0722*o,0,.2126-.2126*o,.7152+.2848*o,.0722-.0722*o,0,.2126-.2126*o,.7152-.7152*o,.0722+.9278*o,0,0,0,0,1);return o$1(c,c)},c$1=(r,s)=>{const o=Math.sin(s*Math.PI/180),c=Math.cos(s*Math.PI/180),e=s$2(r,.213+.787*c-.213*o,.715-.715*c-.715*o,.072-.072*c+.928*o,0,.213-.213*c+.143*o,.715+.285*c+.14*o,.072-.072*c-.283*o,0,.213-.213*c-.787*o,.715-.715*c+.715*o,.072+.928*c+.072*o,0,0,0,0,1);return o$1(e,e)},e=(r,s)=>{const o=1-2*s,c=s$2(r,o,0,0,s,0,o,0,s,0,0,o,s,0,0,0,1);return o$1(c,c)},u$2=(r,s)=>{const o=s$2(r,.213+.787*s,.715-.715*s,.072-.072*s,0,.213-.213*s,.715+.285*s,.072-.072*s,0,.213-.213*s,.715-.715*s,.072+.928*s,0,0,0,0,1);return o$1(o,o)},a=(r,s)=>{const o=1-s,c=s$2(r,.393+.607*o,.769-.769*o,.189-.189*o,0,.349-.349*o,.686+.314*o,.168-.168*o,0,.272-.272*o,.534-.534*o,.131+.869*o,0,0,0,0,1);return o$1(c,c)};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
class c{constructor(t,s,o){this.strength=t,this.radius=s,this.threshold=o,this.type="bloom";}interpolate(t,s,o){this.strength=m$2(t.strength,s.strength,o),this.radius=m$2(t.radius,s.radius,o),this.threshold=m$2(t.threshold,s.threshold,o);}clone(){return new c(this.strength,this.radius,this.threshold)}}class u$1{constructor(t){this.radius=t,this.type="blur";}interpolate(t,s,o){this.radius=Math.round(m$2(t.radius,s.radius,o));}clone(){return new u$1(this.radius)}}class l$1{constructor(t,s){this.type=t,this.amount=s,"invert"!==this.type&&"grayscale"!==this.type&&"sepia"!==this.type||(this.amount=Math.min(this.amount,1));}get colorMatrix(){return this._colorMatrix||this._updateMatrix(),this._colorMatrix}interpolate(t,s,o){this.amount=m$2(t.amount,s.amount,o),this._updateMatrix();}clone(){return new l$1(this.type,this.amount)}_updateMatrix(){const h=this._colorMatrix||r$2();switch(this.type){case"brightness":this._colorMatrix=r$1(h,this.amount);break;case"contrast":this._colorMatrix=s$1(h,this.amount);break;case"grayscale":this._colorMatrix=o(h,this.amount);break;case"invert":this._colorMatrix=e(h,this.amount);break;case"saturate":this._colorMatrix=u$2(h,this.amount);break;case"sepia":this._colorMatrix=a(h,this.amount);}}}class d$2{constructor(t,s,o,r){this.offsetX=t,this.offsetY=s,this.blurRadius=o,this.color=r,this.type="drop-shadow";}interpolate(t,s,o){this.offsetX=m$2(t.offsetX,s.offsetX,o),this.offsetY=m$2(t.offsetY,s.offsetY,o),this.blurRadius=m$2(t.blurRadius,s.blurRadius,o),this.color[0]=Math.round(m$2(t.color[0],s.color[0],o)),this.color[1]=Math.round(m$2(t.color[1],s.color[1],o)),this.color[2]=Math.round(m$2(t.color[2],s.color[2],o)),this.color[3]=m$2(t.color[3],s.color[3],o);}clone(){return new d$2(this.offsetX,this.offsetY,this.blurRadius,[...this.color])}}class p$2{constructor(t){this.angle=t,this.type="hue-rotate";}get colorMatrix(){return this._colorMatrix||this._updateMatrix(),this._colorMatrix}interpolate(t,s,o){this.angle=m$2(t.angle,s.angle,o),this._updateMatrix();}clone(){return new p$2(this.angle)}_updateMatrix(){const s=this._colorMatrix||r$2();this._colorMatrix=c$1(s,this.angle);}}class M$1{constructor(t){this.amount=t,this.type="opacity",this.amount=Math.min(this.amount,1);}interpolate(t,s,o){this.amount=m$2(t.amount,s.amount,o);}clone(){return new M$1(this.amount)}}function m$2(t,s,o){return t+(s-t)*o}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
var l,p$1,h$1={exports:{}};function m$1(t){let e;try{e=t?h$1.exports.parse(t):[];}catch(u){return {input:t,parsedFunctions:[],effects:[],error:new s$3("effect:invalid-syntax","Invalid effect syntax",{input:t,error:u})}}const r={input:t,parsedFunctions:e,effects:[],error:null};try{for(const t of e)r.effects.push(g$1(t));}catch(u){r.effects.length=0,r.error=u;}return r}function g$1(t){try{switch(t.name){case"grayscale":case"sepia":case"saturate":case"invert":case"brightness":case"contrast":return d$1(t);case"opacity":return v(t);case"hue-rotate":return A(t);case"blur":return y$1(t);case"drop-shadow":return w$1(t);case"bloom":return x(t)}}catch(e){throw e.details.filter=t,e}throw new s$3("effect:unknown-effect",`Effect '${t.name}' is not supported`,{effect:t})}function d$1(t){let e=1;return b(t.parameters,1),1===t.parameters.length&&(e=z(t.parameters[0])),new l$1(t.name,e)}function v(t){let e=1;return b(t.parameters,1),1===t.parameters.length&&(e=z(t.parameters[0])),new M$1(e)}function A(t){let e=0;return b(t.parameters,1),1===t.parameters.length&&(e=T(t.parameters[0])),new p$2(e)}function y$1(t){let e=0;return b(t.parameters,1),1===t.parameters.length&&(e=I(t.parameters[0]),C(e,t.parameters[0])),new u$1(e)}function w$1(t){const e=[];let r;for(const u of t.parameters)if("color"===u.type){if(e.length&&Object.freeze(e),r)throw new s$3("effect:type-error","Accepts only one color",{});r=M(u);}else {const t=I(u);if(Object.isFrozen(e))throw new s$3("effect:type-error","<length> parameters not consecutive",{lengths:e});e.push(t),3===e.length&&C(t,u);}if(e.length<2||e.length>3)throw new s$3("effect:type-error",`Expected <length>{2,3}, Actual: <length>{${e.length}}`,{lengths:e});return new d$2(e[0],e[1],e[2]||0,r||O("black"))}function x(t){let e=1,r=0,n=0;return b(t.parameters,3),t.parameters[0]&&(e=z(t.parameters[0])),t.parameters[1]&&(r=I(t.parameters[1]),C(r,t.parameters[1])),t.parameters[2]&&(n=z(t.parameters[2])),new c(e,r,n)}function b(t,e){if(t.length>e)throw new s$3("effect:type-error",`Function supports up to ${e} parameters, Actual: ${t.length}`,{parameters:t})}function F(t){return "color"===t.type?"<color>":q[t.unit]?"<length>":j[t.unit]?"<angle>":"%"===t.unit?"<percentage>":"<double>"}function C(t,e){if(t<0)throw new s$3("effect:type-error",`Negative values are not allowed, Actual: ${t}`,{term:e})}function E(t){if("quantity"!==t.type||null!==t.unit)throw new s$3("effect:type-error",`Expected <double>, Actual: ${F(t)}`,{term:t})}function $(t){if("quantity"!==t.type||null!==t.unit&&"%"!==t.unit)throw new s$3("effect:type-error",`Expected <double> or <percentage>, Actual: ${F(t)}`,{term:t})}p$1=function(){function t(t,e){function r(){this.constructor=t;}r.prototype=e.prototype,t.prototype=new r;}function e(t,r,n,u){this.message=t,this.expected=r,this.found=n,this.location=u,this.name="SyntaxError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,e);}function r(t,r){r=void 0!==r?r:{};var n,u={},a={start:Kt},c=Kt,o=_t("none"),i="none",s=Ht("none",!1),f=function(){return []},l=")",p=Ht(")",!1),h=function(t,e){return {type:"function",name:t,parameters:e||[]}},m=",",g=Ht(",",!1),d=function(t,e){return e.length>0?ie(t,e,3):[t]},v=function(t){return {type:"quantity",value:t.value,unit:t.unit}},A=function(t){return {type:"color",colorType:t.type,value:t.value}},y=_t("whitespace"),w=/^[ \t\n\r]/,x=Nt([" ","\t","\n","\r"],!1,!1),b=_t("function"),F="(",C=Ht("(",!1),E=function(t){return t},$=_t("identifier"),j=/^[a-z\-]/,k=Nt([["a","z"],"-"],!1,!1),q=function(){return Ut()},S=_t("percentage"),z="%",R=Ht("%",!1),T=function(t){return {value:t,unit:"%"}},I=_t("length"),M="px",O=Ht("px",!1),U=function(t){return {value:t,unit:"px"}},H="cm",N=Ht("cm",!1),P=function(t){return {value:t,unit:"cm"}},_="mm",B=Ht("mm",!1),D=function(t){return {value:t,unit:"mm"}},G="in",J=Ht("in",!1),K=function(t){return {value:t,unit:"in"}},L="pt",Q=Ht("pt",!1),V=function(t){return {value:t,unit:"pt"}},W="pc",X=Ht("pc",!1),Y=function(t){return {value:t,unit:"pc"}},Z=_t("angle"),tt="deg",et=Ht("deg",!1),rt=function(t){return {value:t,unit:"deg"}},nt="rad",ut=Ht("rad",!1),at=function(t){return {value:t,unit:"rad"}},ct="grad",ot=Ht("grad",!1),it=function(t){return {value:t,unit:"grad"}},st="turn",ft=Ht("turn",!1),lt=function(t){return {value:t,unit:"turn"}},pt=_t("number"),ht=function(t){return {value:t,unit:null}},mt=_t("color"),gt="#",dt=Ht("#",!1),vt=/^[0-9a-fA-F]/,At=Nt([["0","9"],["a","f"],["A","F"]],!1,!1),yt=function(){return {type:"hex",value:Ut()}},wt=function(t){return {type:"function",value:t}},xt=function(){return {type:"named",value:Ut()}},bt=/^[+\-]/,Ft=Nt(["+","-"],!1,!1),Ct=/^[0-9]/,Et=Nt([["0","9"]],!1,!1),$t=".",jt=Ht(".",!1),kt="e",qt=Ht("e",!1),St=function(){return parseFloat(Ut())},zt=0,Rt=0,Tt=[{line:1,column:1}],It=0,Mt=[],Ot=0;if("startRule"in r){if(!(r.startRule in a))throw new Error("Can't start parsing from rule \""+r.startRule+'".');c=a[r.startRule];}function Ut(){return t.substring(Rt,zt)}function Ht(t,e){return {type:"literal",text:t,ignoreCase:e}}function Nt(t,e,r){return {type:"class",parts:t,inverted:e,ignoreCase:r}}function Pt(){return {type:"end"}}function _t(t){return {type:"other",description:t}}function Bt(e){var r,n=Tt[e];if(n)return n;for(r=e-1;!Tt[r];)r--;for(n={line:(n=Tt[r]).line,column:n.column};r<e;)10===t.charCodeAt(r)?(n.line++,n.column=1):n.column++,r++;return Tt[e]=n,n}function Dt(t,e){var r=Bt(t),n=Bt(e);return {start:{offset:t,line:r.line,column:r.column},end:{offset:e,line:n.line,column:n.column}}}function Gt(t){zt<It||(zt>It&&(It=zt,Mt=[]),Mt.push(t));}function Jt(t,r,n){return new e(e.buildMessage(t,r),t,r,n)}function Kt(){var t;return (t=Lt())===u&&(t=Qt()),t}function Lt(){var e,r;return Ot++,e=zt,Yt()!==u?(t.substr(zt,4)===i?(r=i,zt+=4):(r=u,0===Ot&&Gt(s)),r!==u&&Yt()!==u?(Rt=e,e=f()):(zt=e,e=u)):(zt=e,e=u),Ot--,e===u&&0===Ot&&Gt(o),e}function Qt(){var t,e;if(t=[],(e=Vt())!==u)for(;e!==u;)t.push(e),e=Vt();else t=u;return t}function Vt(){var e,r,n,a;return e=zt,Yt()!==u&&(r=Zt())!==u&&Yt()!==u?((n=Wt())===u&&(n=null),n!==u&&Yt()!==u?(41===t.charCodeAt(zt)?(a=l,zt++):(a=u,0===Ot&&Gt(p)),a!==u&&Yt()!==u?(Rt=e,e=h(r,n)):(zt=e,e=u)):(zt=e,e=u)):(zt=e,e=u),e}function Wt(){var e,r,n,a,c,o,i,s;if(e=zt,(r=Xt())!==u){for(n=[],a=zt,(c=Yt())!==u?(44===t.charCodeAt(zt)?(o=m,zt++):(o=u,0===Ot&&Gt(g)),o===u&&(o=null),o!==u&&(i=Yt())!==u&&(s=Xt())!==u?a=c=[c,o,i,s]:(zt=a,a=u)):(zt=a,a=u);a!==u;)n.push(a),a=zt,(c=Yt())!==u?(44===t.charCodeAt(zt)?(o=m,zt++):(o=u,0===Ot&&Gt(g)),o===u&&(o=null),o!==u&&(i=Yt())!==u&&(s=Xt())!==u?a=c=[c,o,i,s]:(zt=a,a=u)):(zt=a,a=u);n!==u?(Rt=e,e=r=d(r,n)):(zt=e,e=u);}else zt=e,e=u;return e}function Xt(){var t,e;return t=zt,(e=ee())===u&&(e=re())===u&&(e=ne())===u&&(e=ue()),e!==u&&(Rt=t,e=v(e)),(t=e)===u&&(t=zt,(e=ae())!==u&&(Rt=t,e=A(e)),t=e),t}function Yt(){var e,r;for(Ot++,e=[],w.test(t.charAt(zt))?(r=t.charAt(zt),zt++):(r=u,0===Ot&&Gt(x));r!==u;)e.push(r),w.test(t.charAt(zt))?(r=t.charAt(zt),zt++):(r=u,0===Ot&&Gt(x));return Ot--,e===u&&(r=u,0===Ot&&Gt(y)),e}function Zt(){var e,r,n;return Ot++,e=zt,(r=te())!==u?(40===t.charCodeAt(zt)?(n=F,zt++):(n=u,0===Ot&&Gt(C)),n!==u?(Rt=e,e=r=E(r)):(zt=e,e=u)):(zt=e,e=u),Ot--,e===u&&(r=u,0===Ot&&Gt(b)),e}function te(){var e,r,n;if(Ot++,e=zt,r=[],j.test(t.charAt(zt))?(n=t.charAt(zt),zt++):(n=u,0===Ot&&Gt(k)),n!==u)for(;n!==u;)r.push(n),j.test(t.charAt(zt))?(n=t.charAt(zt),zt++):(n=u,0===Ot&&Gt(k));else r=u;return r!==u&&(Rt=e,r=q()),Ot--,(e=r)===u&&(r=u,0===Ot&&Gt($)),e}function ee(){var e,r,n;return Ot++,e=zt,Yt()!==u&&(r=ce())!==u?(37===t.charCodeAt(zt)?(n=z,zt++):(n=u,0===Ot&&Gt(R)),n!==u?(Rt=e,e=T(r)):(zt=e,e=u)):(zt=e,e=u),Ot--,e===u&&0===Ot&&Gt(S),e}function re(){var e,r,n;return Ot++,e=zt,Yt()!==u&&(r=ce())!==u?(t.substr(zt,2)===M?(n=M,zt+=2):(n=u,0===Ot&&Gt(O)),n!==u?(Rt=e,e=U(r)):(zt=e,e=u)):(zt=e,e=u),e===u&&(e=zt,Yt()!==u&&(r=ce())!==u?(t.substr(zt,2)===H?(n=H,zt+=2):(n=u,0===Ot&&Gt(N)),n!==u?(Rt=e,e=P(r)):(zt=e,e=u)):(zt=e,e=u),e===u&&(e=zt,Yt()!==u&&(r=ce())!==u?(t.substr(zt,2)===_?(n=_,zt+=2):(n=u,0===Ot&&Gt(B)),n!==u?(Rt=e,e=D(r)):(zt=e,e=u)):(zt=e,e=u),e===u&&(e=zt,Yt()!==u&&(r=ce())!==u?(t.substr(zt,2)===G?(n=G,zt+=2):(n=u,0===Ot&&Gt(J)),n!==u?(Rt=e,e=K(r)):(zt=e,e=u)):(zt=e,e=u),e===u&&(e=zt,Yt()!==u&&(r=ce())!==u?(t.substr(zt,2)===L?(n=L,zt+=2):(n=u,0===Ot&&Gt(Q)),n!==u?(Rt=e,e=V(r)):(zt=e,e=u)):(zt=e,e=u),e===u&&(e=zt,Yt()!==u&&(r=ce())!==u?(t.substr(zt,2)===W?(n=W,zt+=2):(n=u,0===Ot&&Gt(X)),n!==u?(Rt=e,e=Y(r)):(zt=e,e=u)):(zt=e,e=u)))))),Ot--,e===u&&0===Ot&&Gt(I),e}function ne(){var e,r,n;return Ot++,e=zt,(r=ce())!==u?(t.substr(zt,3)===tt?(n=tt,zt+=3):(n=u,0===Ot&&Gt(et)),n!==u?(Rt=e,e=r=rt(r)):(zt=e,e=u)):(zt=e,e=u),e===u&&(e=zt,(r=ce())!==u?(t.substr(zt,3)===nt?(n=nt,zt+=3):(n=u,0===Ot&&Gt(ut)),n!==u?(Rt=e,e=r=at(r)):(zt=e,e=u)):(zt=e,e=u),e===u&&(e=zt,(r=ce())!==u?(t.substr(zt,4)===ct?(n=ct,zt+=4):(n=u,0===Ot&&Gt(ot)),n!==u?(Rt=e,e=r=it(r)):(zt=e,e=u)):(zt=e,e=u),e===u&&(e=zt,(r=ce())!==u?(t.substr(zt,4)===st?(n=st,zt+=4):(n=u,0===Ot&&Gt(ft)),n!==u?(Rt=e,e=r=lt(r)):(zt=e,e=u)):(zt=e,e=u)))),Ot--,e===u&&(r=u,0===Ot&&Gt(Z)),e}function ue(){var t,e;return Ot++,t=zt,Yt()!==u&&(e=ce())!==u?(Rt=t,t=ht(e)):(zt=t,t=u),Ot--,t===u&&0===Ot&&Gt(pt),t}function ae(){var e,r,n,a;if(Ot++,e=zt,35===t.charCodeAt(zt)?(r=gt,zt++):(r=u,0===Ot&&Gt(dt)),r!==u){if(n=[],vt.test(t.charAt(zt))?(a=t.charAt(zt),zt++):(a=u,0===Ot&&Gt(At)),a!==u)for(;a!==u;)n.push(a),vt.test(t.charAt(zt))?(a=t.charAt(zt),zt++):(a=u,0===Ot&&Gt(At));else n=u;n!==u?(Rt=e,e=r=yt()):(zt=e,e=u);}else zt=e,e=u;return e===u&&(e=zt,(r=Vt())!==u&&(Rt=e,r=wt(r)),(e=r)===u&&(e=zt,(r=te())!==u&&(Rt=e,r=xt()),e=r)),Ot--,e===u&&(r=u,0===Ot&&Gt(mt)),e}function ce(){var e,r,n,a,c,o,i,s;if(e=zt,bt.test(t.charAt(zt))?(r=t.charAt(zt),zt++):(r=u,0===Ot&&Gt(Ft)),r===u&&(r=null),r!==u){for(n=zt,a=[],Ct.test(t.charAt(zt))?(c=t.charAt(zt),zt++):(c=u,0===Ot&&Gt(Et));c!==u;)a.push(c),Ct.test(t.charAt(zt))?(c=t.charAt(zt),zt++):(c=u,0===Ot&&Gt(Et));if(a!==u)if(46===t.charCodeAt(zt)?(c=$t,zt++):(c=u,0===Ot&&Gt(jt)),c!==u){if(o=[],Ct.test(t.charAt(zt))?(i=t.charAt(zt),zt++):(i=u,0===Ot&&Gt(Et)),i!==u)for(;i!==u;)o.push(i),Ct.test(t.charAt(zt))?(i=t.charAt(zt),zt++):(i=u,0===Ot&&Gt(Et));else o=u;o!==u?n=a=[a,c,o]:(zt=n,n=u);}else zt=n,n=u;else zt=n,n=u;if(n===u)if(n=[],Ct.test(t.charAt(zt))?(a=t.charAt(zt),zt++):(a=u,0===Ot&&Gt(Et)),a!==u)for(;a!==u;)n.push(a),Ct.test(t.charAt(zt))?(a=t.charAt(zt),zt++):(a=u,0===Ot&&Gt(Et));else n=u;if(n!==u){if(a=zt,101===t.charCodeAt(zt)?(c=kt,zt++):(c=u,0===Ot&&Gt(qt)),c!==u)if(bt.test(t.charAt(zt))?(o=t.charAt(zt),zt++):(o=u,0===Ot&&Gt(Ft)),o===u&&(o=null),o!==u){if(i=[],Ct.test(t.charAt(zt))?(s=t.charAt(zt),zt++):(s=u,0===Ot&&Gt(Et)),s!==u)for(;s!==u;)i.push(s),Ct.test(t.charAt(zt))?(s=t.charAt(zt),zt++):(s=u,0===Ot&&Gt(Et));else i=u;i!==u?a=c=[c,o,i]:(zt=a,a=u);}else zt=a,a=u;else zt=a,a=u;a===u&&(a=null),a!==u?(Rt=e,e=r=St()):(zt=e,e=u);}else zt=e,e=u;}else zt=e,e=u;return e}function oe(t,e){return t.map((function(t){return t[e]}))}function ie(t,e,r){return [t].concat(oe(e,r))}if((n=c())!==u&&zt===t.length)return n;throw n!==u&&zt<t.length&&Gt(Pt()),Jt(Mt,It<t.length?t.charAt(It):null,It<t.length?Dt(It,It+1):Dt(It,It))}return t(e,Error),e.buildMessage=function(t,e){var r={literal:function(t){return '"'+u(t.text)+'"'},class:function(t){var e,r="";for(e=0;e<t.parts.length;e++)r+=t.parts[e]instanceof Array?a(t.parts[e][0])+"-"+a(t.parts[e][1]):a(t.parts[e]);return "["+(t.inverted?"^":"")+r+"]"},any:function(t){return "any character"},end:function(t){return "end of input"},other:function(t){return t.description}};function n(t){return t.charCodeAt(0).toString(16).toUpperCase()}function u(t){return t.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(t){return "\\x0"+n(t)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(t){return "\\x"+n(t)}))}function a(t){return t.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(t){return "\\x0"+n(t)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(t){return "\\x"+n(t)}))}function c(t){return r[t.type](t)}function o(t){var e,r,n=new Array(t.length);for(e=0;e<t.length;e++)n[e]=c(t[e]);if(n.sort(),n.length>0){for(e=1,r=1;e<n.length;e++)n[e-1]!==n[e]&&(n[r]=n[e],r++);n.length=r;}switch(n.length){case 1:return n[0];case 2:return n[0]+" or "+n[1];default:return n.slice(0,-1).join(", ")+", or "+n[n.length-1]}}function i(t){return t?'"'+u(t)+'"':"end of input"}return "Expected "+o(t)+" but "+i(e)+" found."},{SyntaxError:e,parse:r}},(l=h$1).exports&&(l.exports=p$1());const j={deg:1,grad:.9,rad:180/Math.PI,turn:360};function k(t){if("quantity"!==t.type||(0!==t.value||null!==t.unit)&&null==j[t.unit])throw new s$3("effect:type-error",`Expected <angle>, Actual: ${F(t)}`,{term:t})}const q={px:1,cm:96/2.54,mm:96/2.54/10,in:96,pc:16,pt:96/73};function S(t){if("quantity"!==t.type||(0!==t.value||null!==t.unit)&&null==q[t.unit])throw new s$3("effect:type-error",`Expected <length>, Actual: ${F(t)}`,{term:t})}function z(t){$(t);const e=t.value;return C(e,t),"%"===t.unit?.01*e:e}function R(t){return E(t),C(t.value,t),t.value}function T(t){return k(t),t.value*j[t.unit]||0}function I(t){return S(t),t.value*q[t.unit]||0}function M(e){switch(e.colorType){case"hex":return i(e.value);case"named":return O(e.value);case"function":return N(e.value)}}function O(t){const r=l$2(t);if(!r)throw new s$3("effect:unknown-color",`color '${t}' isn't valid`,{namedColor:t});return r}const U=/^rgba?/i,H=/^hsla?/i;function N(t){if(b(t.parameters,4),U.test(t.name))return [z(t.parameters[0]),z(t.parameters[1]),z(t.parameters[2]),t.parameters[3]?z(t.parameters[3]):1];if(H.test(t.name))return n(R(t.parameters[0]),z(t.parameters[1]),z(t.parameters[2]),t.parameters[3]?z(t.parameters[3]):1);throw new s$3("effect:syntax-error",`Invalid color function '${t.name}'`,{colorFunction:t})}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
const h=-1;class u{constructor(e=200){this.duration=e,this._from=null,this._to=null,this._final=null,this._current=[],this._time=0,this._effect="",this._effects=[],this._scale=0;}get effect(){return this._effect}set effect(e){if(e=e||"",this._effect===e)return;this._effect=e;const t=_(e);Array.isArray(t)?this._transitionTo(t):(this._transitionTo([]),n$1.getLogger("esri.views.layers.effects.EffectList").warn("Invalid Effect",{effect:e,error:t}));}get hasEffects(){return this.transitioning||!!this._effects.length}get effects(){return this._effects}get scale(){return this._scale}get transitioning(){return null!==this._to}transitionStep(e,t){this._applyTimeTransition(e),this._updateForScale(t);}_transitionTo(e){this.scale>0&&d(this._current,e,this.scale)?(this._final=e,this._to=y$2(e),y(this._current,this._to,this.scale),this._from=y$2(this._current),this._time=0):(this._from=this._to=this._final=null,this._current=e),this._effects=this._current[0]?y$2(this._current[0].effects):[];}_applyTimeTransition(e){if(!this._to)return;this._time+=e;const t=Math.min(1,this._time/this.duration);for(let s=0;s<this._current.length;s++){const e=this._current[s],r=this._from[s],n=this._to[s];e.scale=w(r.scale,n.scale,t);for(let s=0;s<e.effects.length;s++){const f=e.effects[s],c=r.effects[s],i=n.effects[s];f.interpolate(c,i,t);}}1===t&&(this._current=this._final,this._effects=this._current[0]?y$2(this._current[0].effects):[],this._from=this._to=this._final=null);}_updateForScale(e){if(0===this._current.length)return;this._scale=e;const t=this._current,s=this._current.length-1;let r,n,f=1;if(1===t.length||e>=t[0].scale)n=r=t[0].effects;else if(e<=t[s].scale)n=r=t[s].effects;else for(let c=0;c<s;c++){const s=t[c],i=t[c+1];if(s.scale>=e&&i.scale<=e){f=(e-s.scale)/(i.scale-s.scale),r=s.effects,n=i.effects;break}}for(let c=0;c<this._effects.length;c++){this._effects[c].interpolate(r[c],n[c],f);}}}function _(e){if(!e)return [];if("string"==typeof e){const t=m$1(e);return t.error?t.error:[{scale:h,effects:t.effects}]}const s=[];for(const r of e){if(!isFinite(r.scale)||r.scale<=0)return new s$3("effect:invalid-scale","scale must be finite and greater than 0",{stop:r});const e=m$1(r.value);if(e.error)return e.error;s.push({scale:r.scale,effects:e.effects});}s.sort(((e,t)=>t.effects.length-e.effects.length));for(let r=0;r<s.length-1;r++){if(!p(s[r].effects,s[r+1].effects))return new s$3("effect:interpolation-impossible","Cannot interpolate by scale between 2 lists of mixed effects",{a:s[r].effects,b:s[r+1].effects});m(s[r].effects,s[r+1].effects);}return s.sort(((e,t)=>t.scale-e.scale)),s}function g(t){switch(t.type){case"grayscale":case"sepia":case"invert":return new l$1(t.type,0);case"saturate":case"brightness":case"contrast":return new l$1(t.type,1);case"opacity":return new M$1(1);case"hue-rotate":return new p$2(0);case"blur":return new u$1(0);case"drop-shadow":return new d$2(0,0,0,[...r$3("transparent")]);case"bloom":return new c(0,0,0)}}function p(e,t){const s=e.length>t.length?e:t;return (e.length>t.length?t:e).every(((e,t)=>e.type===s[t].type))}function m(e,t){const s=e.length>t.length?e:t,r=e.length>t.length?t:e;for(let n=r.length;n<s.length;n++)r.push(g(s[n]));}function d(e,t,s){var r,n,f,c;if(null==(r=e[0])||!r.effects||null==(n=t[0])||!n.effects)return !0;return !(((null==(f=e[0])?void 0:f.scale)===h||(null==(c=t[0])?void 0:c.scale)===h)&&(e.length>1||t.length>1)&&s<=0)&&p(e[0].effects,t[0].effects)}function y(e,t,s){var r,n;const f=e.length>t.length?e:t,c=e.length>t.length?t:e,i=c[c.length-1],l=null!=(r=null==i?void 0:i.scale)?r:s,o=null!=(n=null==i?void 0:i.effects)?n:[];for(let a=c.length;a<f.length;a++)c.push({scale:l,effects:[...o]});for(let a=0;a<f.length;a++)c[a].scale=c[a].scale===h?s:c[a].scale,f[a].scale=f[a].scale===h?s:f[a].scale,m(c[a].effects,f[a].effects);}function w(e,t,s){return e+(t-e)*s}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
const s=s$4("mapview-transitions-duration");class r extends a$1{constructor(){super(...arguments),this._childrenSet=new Set,this.children=[],this._effectList=null;}get blendMode(){return this._blendMode}set blendMode(e){this._blendMode=e,this.requestRender();}get clips(){return this._clips}set clips(e){this._clips=e,this.children.forEach((t=>t.clips=e));}get computedEffects(){var e,t;return null!=(e=null==(t=this._effectList)?void 0:t.effects)?e:null}get effect(){var e,t;return null!=(e=null==(t=this._effectList)?void 0:t.effect)?e:""}set effect(e){(this._effectList||e)&&(this._effectList||(this._effectList=new u(s)),this._effectList.effect=e,this.requestRender());}updateTransitionProperties(e,t){super.updateTransitionProperties(e,t),this._effectList&&(this._effectList.transitionStep(e,t),this._effectList.transitioning&&this.requestRender());}doRender(e){const t=this.createRenderParams(e);this.renderChildren(t);}addChild(e){return this.addChildAt(e,this.children.length)}addChildAt(e,t=this.children.length){if(!e)return e;if(this.contains(e))return e;const i=e.parent;return i&&i!==this&&i.removeChild(e),t>=this.children.length?this.children.push(e):this.children.splice(t,0,e),this._childrenSet.add(e),e.parent=this,e.stage=this.stage,this!==this.stage&&(e.clips=this.clips),this.requestRender(),e}contains(e){return this._childrenSet.has(e)}removeAllChildren(){this._childrenSet.clear();for(const e of this.children)this!==this.stage&&(e.clips=null),e.stage=null,e.parent=null;this.children.length=0;}removeChild(e){return this.contains(e)?this.removeChildAt(this.children.indexOf(e)):e}removeChildAt(e){if(e<0||e>=this.children.length)return null;const t=this.children.splice(e,1)[0];return this._childrenSet.delete(t),this!==this.stage&&(t.clips=null),t.stage=null,t.parent=null,t}sortChildren(e){return this.children.sort(e)}onAttach(){super.onAttach();const e=this.stage;for(const t of this.children)t.stage=e;}onDetach(){super.onDetach();for(const e of this.children)e.stage=null;}renderChildren(e){for(const t of this.children)t.beforeRender(e);for(const t of this.children)t.processRender(e);for(const t of this.children)t.afterRender(e);}createRenderParams(e){return {...e,blendMode:this.blendMode,effects:this.computedEffects,globalOpacity:e.globalOpacity*this.computedOpacity,inFadeTransition:this.inFadeTransition}}}

export { r, u };

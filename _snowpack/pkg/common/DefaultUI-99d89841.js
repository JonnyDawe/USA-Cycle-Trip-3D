import { e as e$c, k as t$e, p as p$q, A as A$5, o as o$i, a as a$j, M as M$5, j as v$8, q as s$o, w as n$B } from './JSONSupport-9346590f.js';
import { u as u$g } from './Handles-af859b7b.js';
import { d as d$f, C as C$4, h as h$h, B as B$6, O as O$5, j as j$5, y as y$e, $ as $$3, w as w$7 } from './watchUtils-06a91cc9.js';
import { y as y$c, n as n$s, u as u$l } from './subclass-fe5fcf78.js';
import { b as r$f, n as n$t, t as t$f, r as r$g, f as e$f, c as s$l, a as s$n, x as o$j, g as g$j } from './Message-70b34921.js';
import { s as s$j, A as A$4, i as i$h, h as h$g, C as C$5, k as k$3, E as E$4, g as g$h, v as v$9, a as a$k, B as B$7, m as m$g, U as U$5, o as o$l, y as y$g } from './promiseUtils-2ff2b194.js';
import { j as j$6 } from './Map-566c621c.js';
import { y as y$f } from './TimeExtent-02acfb1c.js';
import { L as L$3 } from './Collection-32506e74.js';
import { p as p$t } from './CollectionFlattener-af542a66.js';
import { L as L$5, n as n$v, e as i$i, d as n$x, f as f$d, m as m$i } from './Loadable-d16b3d7d.js';
import { l as l$i, d as d$g, a as a$h } from './HandleOwner-fbf91095.js';
import { l as l$j, o as o$g, i as i$f, a as c$v, d as c$w, e as c$x, f as c$y, g as c$z, h as a$i } from './PopupTemplate-d97f5e88.js';
import { M as M$6, t as t$k } from './Polyline-ccd8fb47.js';
import { v as v$a } from './HeightModelInfo-992659fb.js';
import { d as d$l, k as k$4, s as s$r, S as S$a } from './SpatialReference-843b1520.js';
import { u as u$m, m as m$h } from './GraphicsCollection-60679841.js';
import { c as c$B } from './SimpleLineSymbol-9959d1ea.js';
import { e as e$g } from './Queue-a5bdb7c1.js';
import { o as o$f, c as c$A, _ as _$8, j as j$4, z as z$4, n as n$w, a as o$h, s as s$m, d as d$j, u as u$k, y as y$d, x as x$3, N as N$3, r as r$j, b as s$q, e as s$u } from './mathUtils-a477cc74.js';
import { i as i$e, e as e$d, x as x$2, n as n$u, p as p$r, u as u$j, d as d$h, l as l$l, w as w$6, a as e$e, b as b$9, t as t$g, g as g$g, c as e$h, r as r$h, f as t$h, E as E$5, o as o$m } from './widget-734a78a2.js';
import { m as m$e, u as u$h, L as L$4, S as S$8, s as s$k } from './intl-21ab9759.js';
import { c as c$u, d as d$i, b as b$b, x as x$4, g as g$i, s as s$p, p as p$v } from './Point-ee7951c3.js';
import { I as I$6, E as E$3, F as F$4, N as N$2, O as O$4, G as G$3 } from './unitUtils-b17203be.js';
import { h as h$f } from './Graphic-bb07b7e4.js';
import { l as l$k, Q as Q$2 } from './QueryTask-55cf149f.js';
import { u as u$i, l as l$m } from './TopFeaturesQuery-b22907ac.js';
import { f as fe, a as a$f, J as J$2 } from './fieldUtils-22be41cd.js';
import { a as a$g } from './assets-73c8998f.js';
import { b as b$8, m as m$f } from './Query-619f76b0.js';
import { i as i$g } from './locale-b874fc68.js';
import { W as We } from './FeatureLayer-a1f2dd15.js';
import { S as S$9 } from './symbols-9e680ec7.js';
import { b as b$a } from './Layer-aafbe66d.js';
import { v as v$7, M as M$4, q as q$3 } from './utils-4028018e.js';
import { d as d$k } from './arcgisLayerUrl-cb5a8728.js';
import { e as e$i } from './reader-fa0f173d.js';
import { p as p$s } from './jsonUtils-f0a19240.js';
import { h as h$i, e as e$j, n as n$z, i as i$j, c as c$C, M as M$7, r as r$k, a as n$A, t as t$j } from './vec2f32-556b449a.js';
import { s as s$t, r as r$l, M as M$8, h as h$j, i as i$k } from './mat3-6cb40036.js';
import { r as r$i, a as a$l, D as D$5, C as C$6, l as l$n, p as p$u, s as s$s, o as o$k, g as g$k, j as j$7, _ as _$9, b as b$c } from './vec2-513a0296.js';
import { n as n$y, t as t$i } from './vec2f64-3fb878b3.js';
import { r as r$m } from './capabilities-39806eb7.js';
import { a as a$m } from './asyncUtils-015dfd6e.js';

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
const l$h={widthBreakpoint:{getValue(e){const i=e.viewSize[0],s=e.breakpoints,a=this.values;return i<=s.xsmall?a.xsmall:i<=s.small?a.small:i<=s.medium?a.medium:i<=s.large?a.large:a.xlarge},values:{xsmall:"xsmall",small:"small",medium:"medium",large:"large",xlarge:"xlarge"},valueToClassName:{xsmall:"esri-view-width-xsmall esri-view-width-less-than-small esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge",small:"esri-view-width-small esri-view-width-greater-than-xsmall esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge",medium:"esri-view-width-medium esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-less-than-large esri-view-width-less-than-xlarge",large:"esri-view-width-large esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-less-than-xlarge",xlarge:"esri-view-width-xlarge esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-greater-than-large"}},heightBreakpoint:{getValue(e){const i=e.viewSize[1],s=e.breakpoints,a=this.values;return i<=s.xsmall?a.xsmall:i<=s.small?a.small:i<=s.medium?a.medium:i<=s.large?a.large:a.xlarge},values:{xsmall:"xsmall",small:"small",medium:"medium",large:"large",xlarge:"xlarge"},valueToClassName:{xsmall:"esri-view-height-xsmall esri-view-height-less-than-small esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge",small:"esri-view-height-small esri-view-height-greater-than-xsmall esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge",medium:"esri-view-height-medium esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-less-than-large esri-view-height-less-than-xlarge",large:"esri-view-height-large esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-less-than-xlarge",xlarge:"esri-view-height-xlarge esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-greater-than-large"}},orientation:{getValue(e){const i=e.viewSize,s=i[0],a=i[1],t=this.values;return a>=s?t.portrait:t.landscape},values:{portrait:"portrait",landscape:"landscape"},valueToClassName:{portrait:"esri-view-orientation-portrait",landscape:"esri-view-orientation-landscape"}}},h$e={xsmall:544,small:768,medium:992,large:1200};function n$r(e){const i=e;return i&&i.xsmall<i.small&&i.small<i.medium&&i.medium<i.large}function o$e(e,i){return i?l$h[e].valueToClassName[i].split(" "):[]}const m$d=m=>{let g=class extends m{constructor(...e){super(...e),this._breakpointsHandles=new u$g,this.orientation=null,this.widthBreakpoint=null,this.heightBreakpoint=null,this.breakpoints=h$e;}initialize(){this._breakpointsHandles.add(d$f(this,["breakpoints","size"],this._updateClassNames));}destroy(){this.destroyed||(this._removeActiveClassNames(),this._breakpointsHandles.destroy(),this._breakpointsHandles=null);}set breakpoints(e){if(e===this._get("breakpoints"))return;const i=n$r(e);if(!i){const e=JSON.stringify(h$e,null,2);console.warn("provided breakpoints are not valid, using defaults:"+e);}e=i?e:h$e,this._set("breakpoints",{...e});}_updateClassNames(){if(!this.container)return;const e=t$e.acquire(),s=t$e.acquire();let a,t=!1;for(a in l$h){const i=this[a],r=l$h[a].getValue({viewSize:this.size,breakpoints:this.breakpoints});i!==r&&(t=!0,this[a]=r,o$e(a,i).forEach((e=>s.push(e))),o$e(a,r).forEach((i=>e.push(i))));}t&&(this._applyClassNameChanges(e,s),t$e.release(e),t$e.release(s));}_applyClassNameChanges(e,i){const s=this.container;s&&(i.forEach((e=>s.classList.remove(e))),e.forEach((e=>s.classList.add(e))));}_removeActiveClassNames(){const e=this.container;if(!e)return;let i;for(i in l$h)o$e(i,this[i]).forEach((i=>e.classList.remove(i)));}};return e$c([y$c()],g.prototype,"breakpoints",null),e$c([y$c()],g.prototype,"orientation",void 0),e$c([y$c()],g.prototype,"widthBreakpoint",void 0),e$c([y$c()],g.prototype,"heightBreakpoint",void 0),g=e$c([n$s("esri.views.BreakpointsOwner")],g),g};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
let c$t=class extends p$q{constructor(){super(...arguments),this.items=new L$3,this._watchUpdatingTracking=new l$i,this._callbacks=new Map,this._projector=i$e(),this._hiddenProjector=i$e();}get needsRender(){return this.items.length>0}initialize(){const t=document.createElement("div");t.className="esri-overlay-surface",this._set("surface",t),this._hiddenSurface=document.createElement("div"),this._hiddenSurface.setAttribute("style","visibility: hidden;"),t.appendChild(this._hiddenSurface),this._watchUpdatingTracking.addOnCollectionChange(this.items,(t=>{t.added.map((t=>{const e=()=>t.render();this._callbacks.set(t,e),this._projector.append(this.surface,e);})),t.removed.map((t=>{const e=this._projector.detach(this._callbacks.get(t));this.surface.removeChild(e.domNode),this._callbacks.delete(t);}));}));}addItem(t){this.items.add(t);}removeItem(t){this.items.remove(t);}destroy(){this.items.removeAll(),this._callbacks.forEach((t=>this._projector.detach(t))),this._callbacks=null,this._projector=null,this._watchUpdatingTracking.destroy();}render(){this._projector.renderNow();}computeBoundingRect(t){const e=this._hiddenSurface,r=this._hiddenProjector;let o=null;const s=()=>(o=t.render(),o);r.append(e,s),r.renderNow();const i={left:0,top:0,right:0,bottom:0};if(o&&o.domNode){const t=o.domNode.getBoundingClientRect();i.left=t.left,i.top=t.top,i.right=t.right,i.bottom=t.bottom;}for(r.detach(s);e.firstChild;)e.removeChild(e.firstChild);return i}overlaps(t,e){const r=this.computeBoundingRect(t),o=this.computeBoundingRect(e);return Math.max(r.left,o.left)<=Math.min(r.right,o.right)&&Math.max(r.top,o.top)<=Math.min(r.bottom,o.bottom)}get hasVisibleItems(){return this.items.some((t=>t.visible))}renderCanvas(t){if(!this.items.some((t=>t.visible)))return;const e=t.getContext("2d");e.save(),e.font=`10px ${getComputedStyle(this.surface).fontFamily}`,this.items.forEach((t=>{e.save(),t.renderCanvas(e),e.restore();})),e.restore();}};e$c([y$c({readOnly:!0})],c$t.prototype,"surface",void 0),e$c([y$c({readOnly:!0})],c$t.prototype,"items",void 0),e$c([y$c({readOnly:!0})],c$t.prototype,"needsRender",null),e$c([y$c({readOnly:!0})],c$t.prototype,"_watchUpdatingTracking",void 0),e$c([y$c({readOnly:!0,aliasOf:"_watchUpdatingTracking.updating"})],c$t.prototype,"updating",void 0),c$t=e$c([n$s("esri.views.overlay.ViewOverlay")],c$t);var n$q=c$t;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
function e$b(e,t,l,n){let o=null,u=1e3;"number"==typeof t?(u=t,n=l):(o=null!=t?t:null,u=l);let p,r=0;const a=()=>{r=0,e.apply(n,p);},c=(...e)=>{o&&o.apply(n,e),p=e,u?r||(r=setTimeout(a,u)):a();};return c.remove=()=>{r&&(clearTimeout(r),r=0);},c.forceUpdate=()=>{r&&(clearTimeout(r),a());},c.hasPendingUpdates=()=>!!r,c}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
function a$e(t,n,i){return t.units[n][i]}function f$c(t,n,i,r=2,o="abbr"){return `${m$e(n,{minimumFractionDigits:r,maximumFractionDigits:r})} ${a$e(t,i,o)}`}function b$7(t,n,o,u=2,e="abbr"){const s=E$3(n,o);return f$c(t,I$6(n,o,s),s,u,e)}function l$g(t,n,i,u=2,e="abbr"){const s=F$4(n,i);return f$c(t,I$6(n,i,s),s,u,e)}function g$f(t,n,i,o=2,e="abbr"){const s=N$2(n,i);return f$c(t,I$6(n,i,s),s,o,e)}function F$3(t,n,i,o=2,u="abbr"){const s=O$4(n,i);return f$c(t,I$6(n,i,s),s,o,u)}function d$e(t,n,i=2){let o=I$6(t,n,"degrees"),u=o-Math.floor(o);o-=u,u*=60;let e=u-Math.floor(u);return u-=e,e*=60,`${o.toFixed()}° ${u.toFixed()}' ${e.toFixed(i)}"`}const D$4=["B","kB","MB","GB","TB"];function M$3(i,r){let o=0===r?0:Math.floor(Math.log(r)/Math.log(1024));o=o$f(o,0,D$4.length-1);const u=m$e(r/1024**o,{maximumFractionDigits:2});return r$f(i.units.bytes[D$4[o]],{fileSize:u})}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
const f$b="esri.widgets.Feature.support.featureUtils",c$s=n$t.getLogger(f$b),d$d=/href=(""|'')/gi,p$p=/(\{([^\{\r\n]+)\})/g,m$c=/\'/g,y$b=/^\s*expression\//i,g$e=/(\n)/gi,h$d=/[\u00A0-\u9999<>\&]/gim,b$6=/href\s*=\s*(?:\"([^\"]+)\"|\'([^\']+)\')/gi,F$2=/^(?:mailto:|tel:)/,I$5="relationships/",w$5=S$8("short-date-short-time");function N$1(e){if(!t$f(e))return e.get("sourceLayer")||e.get("layer")}async function j$3(e,t){return "function"==typeof e?e.call(null,t):e}function v$6(e=""){if(e)return !F$2.test(e.trim().toLowerCase())}function C$3(e){return y$b.test(e)}function L$2(e,t){if(!C$3(t)||!e)return null;const r=t.replace(y$b,"").toLowerCase();let n;return e.some((e=>e.name.toLowerCase()===r&&(n=e,!0))),n}function x$1(e,t){const r=L$2(t,null==e?void 0:e.fieldName);return r?r.title||null:e?e.label||e.fieldName:null}function D$3(e,t){const r=t.get(e.toLowerCase());return `{${r&&r.fieldName||e}}`}function A$3(e){return e.replace(d$d,"")}function E$2(e,t){const r=M$2(t,e);return r?r.name:e}function q$2(e,t){return e&&e.map((e=>E$2(e,t)))}function M$2(e,t){return e&&"function"==typeof e.getField?e.getField(t):null}function $$2(e){return `${e}`.trim()}function G$2({attributes:e,globalAttributes:t,layer:r,text:n,expressionAttributes:i,fieldInfoMap:o}){return n?R$3({formattedAttributes:t,template:k$2(n,{...t,...i,...e},r),fieldInfoMap:o}):""}function R$3({formattedAttributes:e,template:t,fieldInfoMap:n}){return $$2(A$3(r$f(r$f(t,(e=>D$3(e,n))),e)))}function S$7(e,t,r=!1){const n=t[e];if("string"==typeof n){const i="%27",o=(r?encodeURIComponent(n):n).replace(m$c,i);t[e]=o;}}function T$3(e,t=!1){const r={...e};return Object.keys(r).forEach((e=>S$7(e,r,t))),r}function O$3(e,t,n){const i=(t=$$2(t))&&"{"!==t[0];return r$f(e,T$3(n,i))}function U$4(e,t){return e.replace(p$p,((e,r,n)=>{const i=M$2(t,n);return i?`{${i.name}}`:r}))}function k$2(e,t,r){const n=U$4(e,r);return n?n.replace(b$6,((e,r,n)=>O$3(e,r||n,t))):n}function Q$1(e,t){if("string"==typeof e&&t&&null==t.dateFormat&&(null!=t.places||null!=t.digitSeparator)){const t=Number(e);if(!isNaN(t))return t}return e}function P$3(e,t){const r=t.fieldInfos,n=t.fieldName,i=z$3(r,n),u=null==i?void 0:i.clone(),s=t.preventPlacesFormatting,f=M$2(t.layer,n);if(u&&f&&"date"===f.type){const e=u.format||new l$j;e.dateFormat=e.dateFormat||"short-date-short-time",u.format=e;}const c=u&&u.format;return "string"==typeof(e=Q$1(e,c))||null==e||null==c?e:s?m$e(e,{...u$h(c),minimumFractionDigits:0,maximumFractionDigits:20}):c.format(e)}function z$3(e,t){if(!e||!e.length||!t)return;const r=t.toLowerCase();let n;return e.some((e=>!(!e.fieldName||e.fieldName.toLowerCase()!==r)&&(n=e,!0))),n}function B$5({fieldName:e,graphic:t,layer:r}){if(re(e))return null;if(!r||"function"!=typeof r.getFeatureType)return null;const{typeIdField:n}=r;if(!n||e!==n)return null;const i=r.getFeatureType(t);return i?i.name:null}function H$2({fieldName:e,value:t,graphic:r,layer:n}){if(re(e))return null;if(!n||"function"!=typeof n.getFieldDomain)return null;const i=n.getFieldDomain(e,{feature:r});return i&&"coded-value"===i.type?i.getName(t):null}function J$1(e,t){const{creatorField:r,creationDateField:i,editorField:o,editDateField:a}=e;if(!t)return;const u=t[a];if("number"==typeof u){const e=t[o];return {type:"edit",date:L$4(u,w$5),user:e}}const l=t[i];if("number"==typeof l){const e=t[r];return {type:"create",date:L$4(l,w$5),user:e}}return null}function K$1(e,t){const r=new Map;return e&&e.forEach((e=>{const n=E$2(e.fieldName,t);e.fieldName=n,r.set(n.toLowerCase(),e);})),r}function V$3(e){const t=[];if(!e)return t;const{fieldInfos:r,content:n}=e;return r&&t.push(...r),n&&Array.isArray(n)?(n.forEach((e=>{if("fields"===e.type){const r=e&&e.fieldInfos;r&&t.push(...r);}})),t):t}function W$4(e){return e.replace(h$d,(e=>`&#${e.charCodeAt(0)};`))}function X$1(e){return "string"==typeof e?e.replace(g$e,'<br class="esri-text-new-line" />'):e}function Y$1(e){const{value:t,fieldName:r,fieldInfos:i,fieldInfoMap:o,layer:a,graphic:u}=e;if(null==t)return "";const l=H$2({fieldName:r,value:t,graphic:u,layer:a});if(l)return l;const s=B$5({fieldName:r,graphic:u,layer:a});if(s)return s;if(o.get(r.toLowerCase()))return P$3(t,{fieldInfos:i,fieldName:r,layer:a});const f=a&&a.fieldsIndex;return f&&f.isDateField(r)?L$4(t,w$5):X$1(t)}function Z$1({fieldInfos:e,attributes:t,layer:r,graphic:n,fieldInfoMap:i,relatedInfos:o}){const a={...t};return null==o||o.forEach((e=>oe(a,e))),Object.keys(a).forEach((t=>{const o=a[t];a[t]=Y$1({fieldName:t,fieldInfos:e,fieldInfoMap:i,layer:r,value:o,graphic:n});})),a}async function _$7(e,t){var r,n;const{layer:i,graphic:o,outFields:a,objectIds:u,returnGeometry:l,spatialReference:s}=e,f=u[0];if("number"!=typeof f&&"string"!=typeof f){const e="Could not query required fields for the specified feature. The feature's ID is invalid.",t={layer:i,graphic:o,objectId:f,requiredFields:a};return c$s.warn(e,t),null}if(null==(r=i.capabilities)||null==(n=r.operations)||!n.supportsQuery){const e="The specified layer cannot be queried. The following fields will not be available.",t={layer:i,graphic:o,requiredFields:a,returnGeometry:l};return c$s.warn(e,t),null}const d=i.createQuery();d.objectIds=u,d.outFields=a,d.returnGeometry=!!l,d.outSpatialReference=s;return (await i.queryFeatures(d,t)).features[0]}async function ee(e){var t;if(null==(t=e.expressionInfos)||!t.length)return !1;const r=await a$f(),{arcadeUtils:{hasGeometryFunctions:n}}=r;return n(e)}async function te({graphic:e,popupTemplate:t,layer:r,spatialReference:n},i){if(!r||!t)return;if("function"==typeof r.load&&await r.load(i),!e.attributes)return;const o=e.attributes[r.objectIdField];if(null==o)return;const a=[o],l=await t.getRequiredFields(r.fieldsIndex),s=fe(l,e),f=s?[]:l,c=t.returnGeometry||await ee(t);if(s&&!c)return;const d=await _$7({layer:r,graphic:e,outFields:f,objectIds:a,returnGeometry:c,spatialReference:n},i);d&&(d.geometry&&(e.geometry=d.geometry),d.attributes&&(e.attributes={...e.attributes,...d.attributes}));}function re(e=""){return !!e&&-1!==e.indexOf(I$5)}function ne(e){return e?`${I$5}${e.layerId}/${e.fieldName}`:""}function ie({attributes:e,graphic:t,relatedInfo:r}){e&&t&&r&&Object.keys(t.attributes).forEach((n=>{const i=ne({layerId:r.relation.id.toString(),fieldName:n});e[i]=t.attributes[n];}));}function oe(e,t){e&&t&&(t.relatedFeatures&&t.relatedFeatures&&t.relatedFeatures.forEach((r=>ie({attributes:e,graphic:r,relatedInfo:t}))),t.relatedStatsFeatures&&t.relatedStatsFeatures&&t.relatedStatsFeatures.forEach((r=>ie({attributes:e,graphic:r,relatedInfo:t}))));}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
const p$o={editing:!1,operations:{add:!0,update:!0,delete:!0}},u$f=L$3.ofType(l$k),y$a="graphic.layer.capabilities.operations.supportsResizeAttachments";let f$a=class extends d$g{constructor(t){super(t),this._getAttachmentsPromise=null,this._attachmentLayer=null,this.abilities={...p$o},this.activeAttachmentInfo=null,this.attachmentInfos=new u$f,this.graphic=null,this.mode="view",this.handles.add([d$f(this,"graphic",(()=>this._graphicChanged()))]);}destroy(){this._attachmentLayer=null,this.graphic=null;}castAbilities(t){return {...p$o,...t}}get state(){return this._getAttachmentsPromise?"loading":this.graphic?"ready":"disabled"}get supportsResizeAttachments(){return this.get(y$a)||!1}async getAttachments(){const{_attachmentLayer:t,attachmentInfos:e}=this;if(!t||"function"!=typeof t.queryAttachments)throw new s$j("invalid-layer","getAttachments(): A valid layer is required.");const a=this._getFeatureId(),r=new u$i({objectIds:[a],returnMetadata:!0}),n=[],s=t.queryAttachments(r).then((t=>t[a]||n)).catch((()=>n));this._getAttachmentsPromise=s,this.notifyChange("state");const o=await s;return e.removeAll(),o.length&&e.addMany(o),this._getAttachmentsPromise=null,this.notifyChange("state"),o}async addAttachment(t){const{_attachmentLayer:e,attachmentInfos:a,graphic:r,abilities:n}=this;if(!t)throw new s$j("invalid-attachment","addAttachment(): An attachment is required.",{attachment:t});if(!n.operations.add)throw new s$j("invalid-abilities","addAttachment(): add abilities are required.");if(!e||"function"!=typeof e.addAttachment)throw new s$j("invalid-layer","addAttachment(): A valid layer is required.");const s=e.addAttachment(r,t).then((t=>this._queryAttachment(t.objectId))),o=await s;return a.add(o),o}async deleteAttachment(t){const{_attachmentLayer:e,attachmentInfos:a,graphic:r,abilities:n}=this;if(!t)throw new s$j("invalid-attachment-info","deleteAttachment(): An attachmentInfo is required.",{attachmentInfo:t});if(!n.operations.delete)throw new s$j("invalid-abilities","deleteAttachment(): delete abilities are required.");if(!e||"function"!=typeof e.deleteAttachments)throw new s$j("invalid-layer","deleteAttachment(): A valid layer is required.");const s=e.deleteAttachments(r,[t.id]).then((()=>t)),o=await s;return a.remove(o),o}async updateAttachment(t,e=this.activeAttachmentInfo){const{_attachmentLayer:a,attachmentInfos:r,graphic:n,abilities:s}=this;if(!t)throw new s$j("invalid-attachment","updateAttachment(): An attachment is required.",{attachment:t});if(!e)throw new s$j("invalid-attachment-info","updateAttachment(): An attachmentInfo is required.",{attachmentInfo:e});if(!s.operations.update)throw new s$j("invalid-abilities","updateAttachment(): Update abilities are required.");const o=r.findIndex((t=>t===e));if(!a||"function"!=typeof a.updateAttachment)throw new s$j("invalid-layer","updateAttachment(): A valid layer is required.");const c=a.updateAttachment(n,e.id,t).then((t=>this._queryAttachment(t.objectId))),h=await c;return r.splice(o,1,h),h}async _queryAttachment(t){if(!t)throw new s$j("invalid-attachment-id","Could not query attachment.");const{_attachmentLayer:e}=this,a=this._getFeatureId(),r=new u$i({objectIds:[a],attachmentsWhere:`AttachmentId=${t}`,returnMetadata:!0});return e.queryAttachments(r).then((t=>t[a][0]))}_getFeatureId(){const{_attachmentLayer:t,graphic:e}=this;if(!t||!e)return null;const{objectIdField:a}=t,{attributes:i}=e;return i&&i[a]}_graphicChanged(){this.graphic&&(this._setAttachmentLayer(),this.getAttachments().catch((()=>{})));}_setAttachmentLayer(){const{graphic:t}=this,e=N$1(t);this._attachmentLayer=e?"scene"===e.type&&r$g(e.associatedLayer)?e.associatedLayer:e:null;}};e$c([y$c()],f$a.prototype,"abilities",void 0),e$c([c$u("abilities")],f$a.prototype,"castAbilities",null),e$c([y$c()],f$a.prototype,"activeAttachmentInfo",void 0),e$c([y$c({readOnly:!0,type:u$f})],f$a.prototype,"attachmentInfos",void 0),e$c([y$c({type:h$f})],f$a.prototype,"graphic",void 0),e$c([y$c()],f$a.prototype,"mode",void 0),e$c([y$c({readOnly:!0})],f$a.prototype,"state",null),e$c([y$c({readOnly:!0})],f$a.prototype,"supportsResizeAttachments",null),f$a=e$c([n$s("esri.widgets.Attachments.AttachmentsViewModel")],f$a);var A$2=f$a;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
function e$a(i){const e=i.toLowerCase();return "image/bmp"===e||"image/emf"===e||"image/exif"===e||"image/gif"===e||"image/x-icon"===e||"image/jpeg"===e||"image/png"===e||"image/tiff"===e||"image/x-wmf"===e}function p$n(e){const p=a$g("esri/themes/base/images/files/");return e?"text/plain"===e?`${p}text-32.svg`:"application/pdf"===e?`${p}pdf-32.svg`:"text/csv"===e?`${p}csv-32.svg`:"application/gpx+xml"===e?`${p}gpx-32.svg`:"application/x-dwf"===e?`${p}cad-32.svg`:"application/postscript"===e||"application/json"===e||"text/xml"===e||"model/vrml"===e?`${p}code-32.svg`:"application/x-zip-compressed"===e||"application/x-7z-compressed"===e||"application/x-gzip"===e||"application/x-tar"===e||"application/x-gtar"===e||"application/x-bzip2"===e||"application/gzip"===e||"application/x-compress"===e||"application/x-apple-diskimage"===e||"application/x-rar-compressed"===e||"application/zip"===e?`${p}zip-32.svg`:-1!==e.indexOf("image/")?`${p}image-32.svg`:-1!==e.indexOf("audio/")?`${p}sound-32.svg`:-1!==e.indexOf("video/")?`${p}video-32.svg`:-1!==e.indexOf("msexcel")||-1!==e.indexOf("ms-excel")||-1!==e.indexOf("spreadsheetml")?`${p}excel-32.svg`:-1!==e.indexOf("msword")||-1!==e.indexOf("ms-word")||-1!==e.indexOf("wordprocessingml")?`${p}word-32.svg`:-1!==e.indexOf("powerpoint")||-1!==e.indexOf("presentationml")?`${p}report-32.svg`:`${p}generic-32.svg`:`${p}generic-32.svg`}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
const f$9={addButton:!0,addSubmitButton:!0,cancelAddButton:!0,cancelUpdateButton:!0,deleteButton:!0,errorMessage:!0,progressBar:!0,updateButton:!0},v$5={base:"esri-attachments",loaderContainer:"esri-attachments__loader-container",loader:"esri-attachments__loader",fadeIn:"esri-attachments--fade-in",container:"esri-attachments__container",containerList:"esri-attachments__container--list",containerPreview:"esri-attachments__container--preview",actions:"esri-attachments__actions",deleteButton:"esri-attachments__delete-button",addAttachmentButton:"esri-attachments__add-attachment-button",errorMessage:"esri-attachments__error-message",items:"esri-attachments__items",item:"esri-attachments__item",itemButton:"esri-attachments__item-button",itemMask:"esri-attachments__item-mask",itemMaskIcon:"esri-attachments__item-mask--icon",itemImage:"esri-attachments__image",itemImageResizable:"esri-attachments__image--resizable",itemLabel:"esri-attachments__label",itemFilename:"esri-attachments__filename",itemChevronIcon:"esri-attachments__item-chevron-icon",itemLink:"esri-attachments__item-link",itemLinkOverlay:"esri-attachments__item-link-overlay",itemLinkOverlayIcon:"esri-attachments__item-link-overlay-icon",itemEditIcon:"esri-attachments__item-edit-icon",itemAddIcon:"esri-attachments__item-add-icon",itemAddButton:"esri-attachments__item-add-button",formNode:"esri-attachments__form-node",fileFieldset:"esri-attachments__file-fieldset",fileLabel:"esri-attachments__file-label",fileName:"esri-attachments__file-name",fileInput:"esri-attachments__file-input",metadata:"esri-attachments__metadata",metadataFieldset:"esri-attachments__metadata-fieldset",progressBar:"esri-attachments__progress-bar",esriWidget:"esri-widget",esriButton:"esri-button",buttonDisabled:"esri-button--disabled",esriButtonSecondary:"esri-button--secondary",esriButtonTertiary:"esri-button--tertiary",esriButtonThird:"esri-button--third",esriButtonSmall:"esri-button--small",esriButtonHalf:"esri-button--half",empty:"esri-widget__content--empty",iconExternalLink:"esri-icon-link-external",iconEdit:"esri-icon-edit",iconRight:"esri-icon-right",iconLeft:"esri-icon-left",iconPlus:"esri-icon-plus"},y$9=window.CSS;let B$4=class extends x$2{constructor(t,e){super(t,e),this.abilities=null,this.displayType="list",this.graphic=null,this.label=void 0,this.messages=null,this.messagesUnits=null,this.selectedFile=null,this.submitting=!1,this.viewModel=new A$2,this.visibleElements={...f$9},this._supportsImageOrientation=y$9&&y$9.supports&&y$9.supports("image-orientation","from-image"),this._addAttachmentForm=null,this._updateAttachmentForm=null;}initialize(){this.own(C$4(this,"viewModel.attachmentInfos","change",(()=>this.scheduleRender())),d$f(this,"viewModel.mode",(()=>this._modeChanged())));}castVisibleElements(t){return {...f$9,...t}}addAttachment(){const{_addAttachmentForm:t,viewModel:s}=this;return this._set("submitting",!0),this._set("error",null),s.addAttachment(t).then((t=>(this._set("submitting",!1),this._set("error",null),s.mode="view",t))).catch((t=>{throw this._set("submitting",!1),this._set("error",new s$j("attachments:add-attachment",this.messages.addErrorMessage,t)),t}))}deleteAttachment(t){const{viewModel:s}=this;return this._set("submitting",!0),this._set("error",null),s.deleteAttachment(t).then((t=>(this._set("submitting",!1),this._set("error",null),s.mode="view",t))).catch((t=>{throw this._set("submitting",!1),this._set("error",new s$j("attachments:delete-attachment",this.messages.deleteErrorMessage,t)),t}))}updateAttachment(){const{viewModel:t}=this,{_updateAttachmentForm:s}=this;return this._set("submitting",!0),this._set("error",null),t.updateAttachment(s).then((e=>(this._set("submitting",!1),this._set("error",null),t.mode="view",e))).catch((t=>{throw this._set("submitting",!1),this._set("error",new s$j("attachments:update-attachment",this.messages.updateErrorMessage,t)),t}))}render(){const{submitting:t,viewModel:e}=this,{state:s}=e;return n$u("div",{class:this.classes(v$5.base,v$5.esriWidget)},t?this.renderProgressBar():null,"loading"===s?this.renderLoading():this.renderAttachments(),this.renderErrorMessage())}renderErrorMessage(){const{error:t,visibleElements:e}=this;return t&&e.errorMessage?n$u("div",{key:"error-message",class:v$5.errorMessage},t.message):null}renderAttachments(){const{mode:t,activeAttachmentInfo:e}=this.viewModel;return "add"===t?this.renderAddForm():"edit"===t?this.renderDetailsForm(e):this.renderAttachmentContainer()}renderLoading(){return n$u("div",{class:v$5.loaderContainer,key:"loader"},n$u("div",{class:v$5.loader}))}renderProgressBar(){return this.visibleElements.progressBar?n$u("div",{class:v$5.progressBar,key:"progress-bar"}):null}renderAddForm(){const{submitting:t,selectedFile:e}=this,s=t||!e,i=this.visibleElements.cancelAddButton?n$u("button",{type:"button",bind:this,disabled:t,onclick:this._cancelForm,class:this.classes(v$5.esriButton,v$5.esriButtonTertiary,v$5.esriButtonSmall,v$5.esriButtonHalf,t&&v$5.buttonDisabled)},this.messages.cancel):null,a=this.visibleElements.addSubmitButton?n$u("button",{type:"submit",disabled:s,class:this.classes(v$5.esriButton,v$5.esriButtonSecondary,v$5.esriButtonSmall,v$5.esriButtonHalf,{[v$5.buttonDisabled]:s})},this.messages.add):null,n=e?n$u("span",{key:"file-name",class:v$5.fileName},e.name):null,r=n$u("form",{bind:this,afterCreate:p$r,afterRemoved:u$j,"data-node-ref":"_addAttachmentForm",onsubmit:this._submitAddAttachment},n$u("fieldset",{class:v$5.fileFieldset},n,n$u("label",{class:this.classes(v$5.fileLabel,v$5.esriButton,v$5.esriButtonSecondary)},e?this.messages.changeFile:this.messages.selectFile,n$u("input",{class:v$5.fileInput,type:"file",name:"attachment",bind:this,onchange:this._handleFileInputChange}))),a,i);return n$u("div",{key:"add-form-container",class:v$5.formNode},r)}renderDetailsForm(t){const{visibleElements:e,viewModel:i,selectedFile:a,submitting:n}=this,{contentType:r,size:o,url:l}=t,{abilities:m}=i,d=n||!a,c=m.editing&&m.operations.delete&&e.deleteButton?n$u("button",{key:"delete-button",type:"button",disabled:n,bind:this,onclick:e=>this._submitDeleteAttachment(e,t),class:this.classes(v$5.esriButton,v$5.esriButtonSmall,v$5.esriButtonTertiary,v$5.deleteButton,{[v$5.buttonDisabled]:n})},this.messages.delete):null,h=m.editing&&m.operations.update&&e.updateButton?n$u("button",{disabled:d,key:"update-button",type:"submit",class:this.classes(v$5.esriButton,v$5.esriButtonSmall,v$5.esriButtonThird,{[v$5.buttonDisabled]:d})},this.messages.update):null,b=this.visibleElements.cancelUpdateButton?n$u("button",{disabled:n,key:"cancel-button",type:"button",bind:this,onclick:this._cancelForm,class:this.classes(v$5.esriButton,v$5.esriButtonSmall,v$5.esriButtonTertiary,v$5.esriButtonThird,{[v$5.buttonDisabled]:n})},this.messages.cancel):null,_=a?n$u("span",{key:"file-name",class:v$5.fileName},a.name):null,f=m.editing&&m.operations.update?n$u("fieldset",{key:"file",class:v$5.fileFieldset},_,n$u("label",{class:this.classes(v$5.fileLabel,v$5.esriButton,v$5.esriButtonSecondary)},this.messages.changeFile,n$u("input",{class:v$5.fileInput,type:"file",name:"attachment",bind:this,onchange:this._handleFileInputChange}))):null,y=n$u("fieldset",{key:"size",class:v$5.metadataFieldset},n$u("label",null,M$3(this.messagesUnits,o))),B=n$u("fieldset",{key:"content-type",class:v$5.metadataFieldset},n$u("label",null,r)),A=n$u("form",{bind:this,afterCreate:p$r,afterRemoved:u$j,"data-node-ref":"_updateAttachmentForm",onsubmit:this._submitUpdateAttachment},n$u("div",{class:v$5.metadata},y,B),f,n$u("div",{class:v$5.actions},c,b,h));return n$u("div",{key:"edit-form-container",class:v$5.formNode},n$u("a",{class:v$5.itemLink,href:l,rel:"noreferrer",target:"_blank"},this.renderImageMask({attachmentInfo:t,size:400}),n$u("div",{class:v$5.itemLinkOverlay},n$u("span",{class:v$5.itemLinkOverlayIcon},n$u("svg",{xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32",viewBox:"0 0 32 32"},n$u("path",{d:"M28 13h1v16H3V3h16v1H4v24h24zm-5-9h4.293L15.646 15.638l.707.707L28 4.707V9h1V3h-6z"}),n$u("path",{fill:"none",d:"M0 0h32v32H0z"}))))),A)}renderImageMask({attachmentInfo:t,size:e}){const{supportsResizeAttachments:s}=this.viewModel,{contentType:i,name:a,url:n}=t,r=s&&e$a(i),o=this._getCSSTransform(t,r),l=o?{transform:o,"image-orientation":"none"}:{},m=-1===n.indexOf("?")?"?":"&",d=r?`${n}${m}w=${e}`:p$n(i),u={[v$5.itemMaskIcon]:!r},p={[v$5.itemImageResizable]:s};return n$u("div",{class:this.classes(u,v$5.itemMask)},n$u("img",{styles:l,alt:a,src:d,class:this.classes(p,v$5.itemImage)}))}renderAttachmentInfo({attachmentInfo:t,displayType:e}){const{viewModel:s}=this,{abilities:i}=s,{name:a,url:n}=t,r=this.renderImageMask({attachmentInfo:t,size:"list"===e?48:400}),o=i.editing?n$u("span",{"aria-hidden":"true",class:this.classes(v$5.itemChevronIcon,d$h()?v$5.iconLeft:v$5.iconRight)}):null,l=[r,n$u("label",{class:v$5.itemLabel},n$u("span",{class:v$5.itemFilename},a||this.messages.noTitle),o)],m=i.editing?n$u("button",{key:"details-button",bind:this,class:v$5.itemButton,title:this.messages.attachmentDetails,"aria-label":this.messages.attachmentDetails,"data-attachment-info-id":t.id,onclick:()=>this._startEditAttachment(t),type:"button"},l):n$u("a",{key:"details-link",class:v$5.itemButton,href:n,target:"_blank"},l);return n$u("li",{class:v$5.item,key:t},m)}renderAttachmentContainer(){const{displayType:t,viewModel:e,visibleElements:s}=this,{attachmentInfos:i,abilities:a}=e,n=i&&i.length,r={[v$5.containerList]:"preview"!==t,[v$5.containerPreview]:"preview"===t},o=a.editing&&a.operations.add&&s.addButton?n$u("button",{bind:this,onclick:()=>this._startAddAttachment(),class:this.classes(v$5.esriButton,v$5.esriButtonTertiary,v$5.addAttachmentButton),type:"button"},n$u("span",{"aria-hidden":"true",class:this.classes(v$5.itemAddIcon,v$5.iconPlus)}),this.messages.add):null,l=n?n$u("ul",{class:v$5.items},i.toArray().map((e=>this.renderAttachmentInfo({attachmentInfo:e,displayType:t})))):n$u("div",{class:v$5.empty},this.messages.noAttachments);return n$u("div",{key:"attachments-container",class:this.classes(v$5.container,r)},l,o)}_modeChanged(){this._set("error",null),this._set("selectedFile",null);}_handleFileInputChange(t){const e=t.target,s=e&&e.files&&e.files.item(0);this._set("selectedFile",s);}_submitDeleteAttachment(t,e){t.preventDefault(),this.deleteAttachment(e);}_submitAddAttachment(t){t.preventDefault(),this.addAttachment();}_submitUpdateAttachment(t){t.preventDefault(),this.updateAttachment();}_startEditAttachment(t){const{viewModel:e}=this;e.activeAttachmentInfo=t,e.mode="edit";}_startAddAttachment(){this.viewModel.mode="add";}_cancelForm(t){t.preventDefault(),this.viewModel.mode="view";}_getCSSTransform(t,e){const{orientationInfo:s}=t;return !this._supportsImageOrientation&&e&&s?[s.rotation?`rotate(${s.rotation}deg)`:"",s.mirrored?"scaleX(-1)":""].join(" "):""}};e$c([o$g("viewModel.abilities")],B$4.prototype,"abilities",void 0),e$c([y$c()],B$4.prototype,"displayType",void 0),e$c([o$g("viewModel.graphic")],B$4.prototype,"graphic",void 0),e$c([y$c({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],B$4.prototype,"label",void 0),e$c([y$c(),e$d("esri/widgets/Attachments/t9n/Attachments")],B$4.prototype,"messages",void 0),e$c([y$c(),e$d("esri/core/t9n/Units")],B$4.prototype,"messagesUnits",void 0),e$c([y$c({readOnly:!0})],B$4.prototype,"selectedFile",void 0),e$c([y$c({readOnly:!0})],B$4.prototype,"submitting",void 0),e$c([y$c({readOnly:!0})],B$4.prototype,"error",void 0),e$c([y$c({type:A$2})],B$4.prototype,"viewModel",void 0),e$c([y$c()],B$4.prototype,"visibleElements",void 0),e$c([c$u("visibleElements")],B$4.prototype,"castVisibleElements",null),B$4=e$c([n$s("esri.widgets.Attachments")],B$4);var A$1=B$4;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
let s$i=class extends A$2{constructor(t){super(t),this.description=null,this.title=null;}};e$c([y$c()],s$i.prototype,"description",void 0),e$c([y$c()],s$i.prototype,"title",void 0),s$i=e$c([n$s("esri.widgets.Feature.FeatureAttachments.FeatureAttachmentsViewModel")],s$i);var c$r=s$i;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
const r$e={heading:"esri-widget__heading"};function s$h(s,i){const c=`h${o$f(Math.ceil(s.level),1,6)}`;return delete s.level,n$u(c,{...s,class:l$l(r$e.heading,s.class)},i)}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
const p$m={base:"esri-feature-element-info",title:"esri-feature-element-info__title",description:"esri-feature-element-info__description"};let n$p=class extends x$2{constructor(e,t){super(e,t),this.description=null,this.headingLevel=2,this.title=null;}render(){return n$u("div",{class:p$m.base},this.renderTitle(),this.renderDescription())}renderTitle(){const{title:e}=this;return e?n$u(s$h,{level:this.headingLevel,class:p$m.title},e):null}renderDescription(){const{description:e}=this;return e?n$u("div",{key:"description",class:p$m.description},e):null}};e$c([y$c()],n$p.prototype,"description",void 0),e$c([y$c()],n$p.prototype,"headingLevel",void 0),e$c([y$c()],n$p.prototype,"title",void 0),n$p=e$c([n$s("esri.widgets.Feature.support.FeatureElementInfo")],n$p);var c$q=n$p;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
const d$c={base:"esri-feature-attachments"};let c$p=class extends x$2{constructor(e,t){super(e,t),this._featureElementInfo=null,this.attachmentsWidget=new A$1,this.description=null,this.displayType=null,this.graphic=null,this.headingLevel=2,this.title=null,this.viewModel=new c$r;}initialize(){this._featureElementInfo=new c$q,d$f(this,["viewModel.description","viewModel.title","headingLevel"],(()=>this._setupFeatureElementInfo())),d$f(this,"viewModel.graphic",(e=>this.attachmentsWidget.graphic=e));}destroy(){this.attachmentsWidget.destroy(),this._featureElementInfo.destroy();}render(){var e;const{attachmentsWidget:t}=this;return n$u("div",{class:d$c.base},null==(e=this._featureElementInfo)?void 0:e.render(),null==t?void 0:t.render())}_setupFeatureElementInfo(){const{description:e,title:t,headingLevel:o}=this;this._featureElementInfo.set({description:e,title:t,headingLevel:o});}};e$c([y$c({readOnly:!0})],c$p.prototype,"attachmentsWidget",void 0),e$c([o$g("viewModel.description")],c$p.prototype,"description",void 0),e$c([o$g("attachmentsWidget.displayType")],c$p.prototype,"displayType",void 0),e$c([o$g("viewModel.graphic")],c$p.prototype,"graphic",void 0),e$c([y$c()],c$p.prototype,"headingLevel",void 0),e$c([o$g("viewModel.title")],c$p.prototype,"title",void 0),e$c([y$c({type:c$r})],c$p.prototype,"viewModel",void 0),c$p=e$c([n$s("esri.widgets.Feature.FeatureAttachments")],c$p);var h$c=c$p;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
let n$o=class extends(a$h(p$q)){constructor(t){super(t),this._loadingPromise=null,this.created=null,this.creator=null,this.destroyer=null,this.graphic=null,this.handles.add(d$f(this,"creator",(t=>{this._destroyContent(),this._createContent(t);})));}destroy(){this._destroyContent();}get state(){return this._loadingPromise?"loading":"ready"}_destroyContent(){const{created:t,graphic:e,destroyer:r}=this;t&&(j$3(r,{graphic:e}).catch((()=>null)),this._set("created",null));}async _createContent(t){const{graphic:e}=this,r=j$3(t,{graphic:e}).catch((()=>null));this._loadingPromise=r,this.notifyChange("state");const o=await r;r===this._loadingPromise&&(this._loadingPromise=null,this.notifyChange("state"),this._set("created",o));}};e$c([y$c({readOnly:!0})],n$o.prototype,"created",void 0),e$c([y$c()],n$o.prototype,"creator",void 0),e$c([y$c()],n$o.prototype,"destroyer",void 0),e$c([y$c({type:h$f})],n$o.prototype,"graphic",void 0),e$c([y$c({readOnly:!0})],n$o.prototype,"state",null),n$o=e$c([n$s("esri.widgets.Feature.FeatureContent.FeatureContentViewModel")],n$o);var p$l=n$o;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
function t$d(){return function(n,t){if(!n[t])throw new TypeError(`Cannot auto bind undefined function '${t}'`);return {value:o$d(n[t])}}}function e$9(n){const{type:t}=n;return n instanceof KeyboardEvent||"keyup"===t||"keydown"===t||"keypress"===t}function o$d(t){return function(o,...r){e$9(o)?w$6(o.key)&&(o.preventDefault(),o.stopPropagation(),o.target.click()):t.call(this,o,...r);}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
function n$n(n){return n.split(",").map((n=>n.trim()))}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
function t$c(t){return a=>{a.hasOwnProperty("_delegatedEventNames")||(a._delegatedEventNames=a._delegatedEventNames?a._delegatedEventNames.slice():[]);const r=a._delegatedEventNames,s=Array.isArray(t)?t:n$n(t);r.push(...s);}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
const c$o={base:"esri-feature-content",loaderContainer:"esri-feature-content__loader-container",loader:"esri-feature-content__loader"};let l$f=class extends x$2{constructor(e,r){super(e,r),this.creator=null,this.graphic=null,this.viewModel=null,this._addTargetToAnchors=e=>{Array.from(e.querySelectorAll("a")).forEach((e=>{v$6(e.href)&&!e.hasAttribute("target")&&e.setAttribute("target","_blank");}));};}renderLoading(){return n$u("div",{class:c$o.loaderContainer,key:"loader"},n$u("div",{class:c$o.loader}))}renderCreated(){var e;const r=null==(e=this.viewModel)?void 0:e.created;return r?r instanceof HTMLElement?n$u("div",{key:r,bind:r,afterCreate:this._attachToNode}):e$e(r)?n$u("div",{key:r},!r.destroyed&&r.render()):n$u("div",{key:r,innerHTML:r,afterCreate:this._addTargetToAnchors}):null}render(){var e;const r=null==(e=this.viewModel)?void 0:e.state;return n$u("div",{class:c$o.base},"loading"===r?this.renderLoading():this.renderCreated())}_attachToNode(e){const r=this;e.appendChild(r);}};e$c([o$g("viewModel.creator")],l$f.prototype,"creator",void 0),e$c([o$g("viewModel.graphic")],l$f.prototype,"graphic",void 0),e$c([y$c({type:p$l})],l$f.prototype,"viewModel",void 0),l$f=e$c([n$s("esri.widgets.Feature.FeatureContent")],l$f);var p$k=l$f;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
let l$e=class extends p$q{constructor(o){super(o),this.attributes=null,this.expressionInfos=null,this.description=null,this.fieldInfos=null,this.title=null;}get formattedFieldInfos(){const{expressionInfos:o,fieldInfos:e}=this,r=[];return null==e||e.forEach((e=>{if(!(!e.hasOwnProperty("visible")||e.visible))return;const s=e.clone();s.label=x$1(s,o),r.push(s);})),r}};e$c([y$c()],l$e.prototype,"attributes",void 0),e$c([y$c({type:[i$f]})],l$e.prototype,"expressionInfos",void 0),e$c([y$c()],l$e.prototype,"description",void 0),e$c([y$c({type:[c$v]})],l$e.prototype,"fieldInfos",void 0),e$c([y$c({readOnly:!0})],l$e.prototype,"formattedFieldInfos",null),e$c([y$c()],l$e.prototype,"title",void 0),l$e=e$c([n$s("esri.widgets.Feature.FeatureFields.FeatureFieldsViewModel")],l$e);var n$m=l$e;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
const s$g=[{pattern:/^\s*(https?:\/\/([^\s]+))\s*$/i,target:"_blank",label:"{messages.view}"},{pattern:/^\s*(tel:([^\s]+))\s*$/i,label:"{hierPart}"},{pattern:/^\s*(mailto:([^\s]+))\s*$/i,label:"{hierPart}"},{pattern:/^\s*(arcgis-appstudio-player:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"App Studio Player"},{pattern:/^\s*(arcgis-collector:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Collector"},{pattern:/^\s*(arcgis-explorer:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Explorer"},{pattern:/^\s*(arcgis-navigator:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Navigator"},{pattern:/^\s*(arcgis-survey123:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Survey123"},{pattern:/^\s*(arcgis-trek2there:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Trek2There"},{pattern:/^\s*(arcgis-workforce:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Workforce"},{pattern:/^\s*(iform:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"iForm"},{pattern:/^\s*(flow:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"FlowFinity"},{pattern:/^\s*(lfmobile:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Laserfische"},{pattern:/^\s*(mspbi:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Microsoft Power Bi"}];function a$d(e){let a=null;return s$g.some((s=>(s.pattern.test(e)&&(a=s),!!a))),a}function p$j(s,p){if("string"!=typeof p||!p)return p;const r=a$d(p);if(!r)return p;const t=p.match(r.pattern),n=t&&t[2],l=r$f(r$f(r.label,{messages:s,hierPart:n}),{appName:r.appName}),i=r.target?` target="${r.target}"`:"",o="_blank"===r.target?' rel="noreferrer"':"";return p.replace(r.pattern,`<a${i} href="$1"${o}>${l}</a>`)}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
const f$8={base:"esri-feature-fields",fieldHeader:"esri-feature-fields__field-header",fieldData:"esri-feature-fields__field-data",fieldDataDate:"esri-feature-fields__field-data--date",esriTable:"esri-widget__table"};let u$e=class extends x$2{constructor(e,t){super(e,t),this._featureElementInfo=null,this.attributes=null,this.description=null,this.expressionInfos=null,this.fieldInfos=null,this.title=null,this.viewModel=new n$m,this.messages=null,this.messagesURIUtils=null;}initialize(){this._featureElementInfo=new c$q,d$f(this,["viewModel.description","viewModel.title"],(()=>this._setupFeatureElementInfo()));}destroy(){this._featureElementInfo.destroy();}renderFieldInfo(e,t){const{attributes:s}=this.viewModel,r=e.fieldName,i=e.label||r,o=s?null==s[r]?"":s[r]:"",l=!(!e.format||!e.format.dateFormat),a="number"==typeof o&&!l?this._forceLTR(o):p$j(this.messagesURIUtils,o),n={[f$8.fieldDataDate]:l};return n$u("tr",{key:`fields-element-info-row-${r}-${t}`},n$u("th",{key:`fields-element-info-row-header-${r}-${t}`,class:f$8.fieldHeader,innerHTML:i}),n$u("td",{key:`fields-element-info-row-data-${r}-${t}`,class:this.classes(f$8.fieldData,n),innerHTML:a}))}renderFields(){const{formattedFieldInfos:e}=this.viewModel;return e.length?n$u("table",{class:f$8.esriTable,summary:this.messages.fieldsSummary},n$u("tbody",null,e.map(((e,t)=>this.renderFieldInfo(e,t))))):null}render(){var e;return n$u("div",{class:f$8.base},null==(e=this._featureElementInfo)?void 0:e.render(),this.renderFields())}_setupFeatureElementInfo(){const{description:e,title:t}=this;this._featureElementInfo.set({description:e,title:t});}_forceLTR(e){return `&lrm;${e}`}};e$c([o$g("viewModel.attributes")],u$e.prototype,"attributes",void 0),e$c([o$g("viewModel.description")],u$e.prototype,"description",void 0),e$c([o$g("viewModel.expressionInfos")],u$e.prototype,"expressionInfos",void 0),e$c([o$g("viewModel.fieldInfos")],u$e.prototype,"fieldInfos",void 0),e$c([o$g("viewModel.title")],u$e.prototype,"title",void 0),e$c([y$c({type:n$m})],u$e.prototype,"viewModel",void 0),e$c([y$c(),e$d("esri/widgets/Feature/t9n/Feature")],u$e.prototype,"messages",void 0),e$c([y$c(),e$d("esri/widgets/support/t9n/uriUtils")],u$e.prototype,"messagesURIUtils",void 0),u$e=e$c([n$s("esri.widgets.Feature.FeatureFields")],u$e);var m$b=u$e;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
const c$n="esri.widgets.Feature.support.relatedFeatureUtils",d$b=n$t.getLogger(c$n),f$7=new Map;function p$i(e){if(!re(e))return null;const[t,r]=e.split("/").slice(1);return {layerId:t,fieldName:r}}function m$a(e,t){if(!t.relationships)return null;let r=null;const{relationships:s}=t;return s.some((t=>t.id===parseInt(e,10)&&(r=t,!0))),r}function y$8({originRelationship:e,relationships:t,layerId:r}){let s;return t&&t.some((t=>(`${t.relatedTableId}`===r&&t.id===e.id&&(s=t),!!s))),s}function F$1(e,t){const r=t.toLowerCase();for(const s in e)if(s.toLowerCase()===r)return e[s];return null}function h$b(e,t){const r=m$a(e,t);if(!r)return;const s=`${t.url}/${r.relatedTableId}`;return {url:s,queryTask:new Q$2({url:s,sourceSpatialReference:t.spatialReference}),relation:r,relatedFields:[],outStatistics:[]}}function I$4(e,t){if(!t)return;if(!e)return;const{features:r,statsFeatures:s}=e,i=r&&r.value;t.relatedFeatures=i?i.features:[];const o=s&&s.value;t.relatedStatsFeatures=o?o.features:[];}function w$4(e,t,r,s){const i=new l$m;return i.outFields=["*"],i.relationshipId="number"==typeof t.id?t.id:parseInt(t.id,10),i.objectIds=[e.attributes[r.objectIdField]],r.queryRelatedFeatures(i,s)}function b$5(e,t,r){let s=0;const i=[];for(;s<t.length;)i.push(`${e} IN (${t.slice(s,r+s)})`),s+=r;return i.join(" OR ")}async function j$2(e,t,r,n){const a=r.layerId.toString(),{layerInfo:l,queryTask:u,relation:c,relatedFields:d,outStatistics:f}=t,p=y$8({originRelationship:c,relationships:l.relationships,layerId:a});if(p.relationshipTableId&&p.keyFieldInRelationshipTable){const t=(await w$4(e,p,r,n))[e.attributes[r.objectIdField]];if(!t)return null;const i=t.features.map((e=>e.attributes[l.objectIdField]));if((null==f?void 0:f.length)>0&&l.supportsStatistics){const e=new b$8;e.where=b$5(l.objectIdField,i,1e3),e.outFields=d,e.outStatistics=f;const r={features:Promise.resolve(t),statsFeatures:u.execute(e)};return A$4(r)}}const m=null==p?void 0:p.keyField;if(m){const r=J$2(q$1(l.fields,m)),a=F$1(e.attributes,c.keyField),d=r?`${m}=${a}`:`${m}='${a}'`,f=u.execute(new b$8({where:d,outFields:t.relatedFields}),n),p=t.outStatistics&&t.outStatistics.length>0&&l.supportsStatistics?u.execute(new b$8({where:d,outFields:t.relatedFields,outStatistics:t.outStatistics}),n):null,y={features:f};return p&&(y.statsFeatures=p),A$4(y)}return null}function g$d(t,r){return L$5(t,{query:{f:"json"},signal:r&&r.signal})}function S$6({relatedInfos:e,layer:r},i){const o={};return e.forEach(((e,s)=>{const{relation:n}=e;if(!n){const e=new s$j("relation-required","A relation is required on a layer to retrieve related records.");throw d$b.error(e),e}const{relatedTableId:a}=n;if("number"!=typeof a){const e=new s$j("A related table ID is required on a layer to retrieve related records.");throw d$b.error(e),e}const l=`${r.url}/${a}`,u=f$7.get(l),c=u||g$d(l,i);u||f$7.set(l,c),o[s]=c;})),A$4(o)}function T$2({graphic:e,relatedInfos:t,layer:r},i){const o={};return t.forEach(((t,s)=>{t.layerInfo&&(o[s]=j$2(e,t,r,i));})),A$4(o)}function $$1({relatedInfo:e,fieldName:t,fieldInfo:r}){if(e.relatedFields.push(t),r.statisticType){const s=new m$f({statisticType:r.statisticType,onStatisticField:t,outStatisticFieldName:t});e.outStatistics.push(s);}}function q$1(e,t){if(null!=e){t=t.toLowerCase();for(const r of e)if(r&&r.name.toLowerCase()===t)return r}return null}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
let y$7=class extends p$q{constructor(t){super(t),this.activeMediaInfoIndex=0,this.attributes=null,this.description=null,this.fieldInfoMap=null,this.formattedAttributes=null,this.expressionAttributes=null,this.layer=null,this.mediaInfos=null,this.popupTemplate=null,this.relatedInfos=null,this.title=null;}get activeMediaInfo(){return this.formattedMediaInfos[this.activeMediaInfoIndex]||null}get formattedMediaInfos(){return this._formatMediaInfos()||[]}get formattedMediaInfoCount(){return this.formattedMediaInfos.length}setActiveMedia(t){this._setContentElementMedia(t);}next(){this._pageContentElementMedia(1);}previous(){this._pageContentElementMedia(-1);}_setContentElementMedia(t){const{formattedMediaInfoCount:e}=this,o=(t+e)%e;this.activeMediaInfoIndex=o;}_pageContentElementMedia(t){const{activeMediaInfoIndex:e}=this,o=e+t;this._setContentElementMedia(o);}_formatMediaInfos(){const{attributes:t,mediaInfos:e,formattedAttributes:o,expressionAttributes:i,fieldInfoMap:r,layer:a}=this;return null==e?void 0:e.map((e=>{if(!e)return null;if(e.title=G$2({attributes:t,fieldInfoMap:r,globalAttributes:o,expressionAttributes:i,layer:a,text:e.title}),e.caption=G$2({attributes:t,fieldInfoMap:r,globalAttributes:o,expressionAttributes:i,layer:a,text:e.caption}),e.altText=G$2({attributes:t,fieldInfoMap:r,globalAttributes:o,expressionAttributes:i,layer:a,text:e.altText}),"image"===e.type){const{value:t}=e;return this._setImageValue({value:t,formattedAttributes:o,layer:a}),e.value.sourceURL?e:void 0}if("pie-chart"===e.type||"line-chart"===e.type||"column-chart"===e.type||"bar-chart"===e.type){const{value:i}=e;return this._setChartValue({value:i,chartType:e.type,attributes:t,formattedAttributes:o,layer:a}),e}return null})).filter(Boolean)}_setImageValue(t){const{fieldInfoMap:e}=this,{value:o,formattedAttributes:i,layer:r}=t,{linkURL:a,sourceURL:s}=o;if(s){const t=U$4(s,r);o.sourceURL=R$3({formattedAttributes:i,template:t,fieldInfoMap:e});}if(a){const t=U$4(a,r);o.linkURL=R$3({formattedAttributes:i,template:t,fieldInfoMap:e});}}_setChartValue(t){const{value:e,attributes:o,formattedAttributes:i,chartType:r,layer:a}=t,{popupTemplate:s,relatedInfos:l}=this,{fields:n,normalizeField:f}=e;e.fields=q$2(n,a),f&&(e.normalizeField=E$2(f,a));if(!n.some((t=>!!(null!=i[t]||re(t)&&l.size))))return;const m=null==s?void 0:s.fieldInfos;n.forEach((t=>{if(re(t))return void(e.series=[...e.series,...this._getRelatedChartInfos({fieldInfos:m,fieldName:t,formattedAttributes:i,chartType:r,value:e})]);const a=this._getChartOption({value:e,attributes:o,chartType:r,formattedAttributes:i,fieldName:t,fieldInfos:m});e.series.push(a);}));}_getRelatedChartInfos(t){var e;const{fieldInfos:o,fieldName:i,formattedAttributes:r,chartType:a,value:s}=t,l=[],n=p$i(i),{layerId:d,fieldName:p}=n,u=null==(e=this.relatedInfos)?void 0:e.get(d.toString());if(!u)return l;const{relatedFeatures:f,relation:m}=u;if(!m||!f)return l;const{cardinality:c}=m;f.forEach((t=>{const{attributes:e}=t;e&&Object.keys(e).forEach((t=>{t===p&&l.push(this._getChartOption({value:s,attributes:e,formattedAttributes:r,fieldName:i,chartType:a,relatedFieldName:t,fieldInfos:o}));}));}));return "one-to-many"===c||"many-to-many"===c?l:[l[0]]}_getTooltip({label:t,value:e,chartType:o}){return "pie-chart"===o?t:`${t}: ${e}`}_getChartOption(t){var e;const{value:o,attributes:i,formattedAttributes:s,fieldName:l,relatedFieldName:n,fieldInfos:d,chartType:y}=t,{layer:I}=this,{normalizeField:v,tooltipField:b}=o,M=v?re(v)?i[p$i(v).fieldName]:i[v]:null,g=n&&void 0!==i[n]?i[n]:void 0!==i[l]?i[l]:s[l],A=void 0===g?null:g&&M?g/M:g,_=new c$w({value:A});if(re(l)){const t=p$i(l),e=p$i(b),o=e?e.fieldName:null,r=P$3(A,{fieldInfos:d,fieldName:n,layer:I,preventPlacesFormatting:!!M}),a=t?t.label||t.fieldName:n,s=o&&void 0!==i[o]?i[o]:a;return _.tooltip=this._getTooltip({label:s,value:r,chartType:y}),_}const x=z$3(d,l),T=E$2(l,I),C=b&&void 0!==s[b]?s[b]:x$1(x||new c$v({fieldName:T}),null==(e=this.popupTemplate)?void 0:e.expressionInfos),F=s[T];return _.tooltip=this._getTooltip({label:C,value:F,chartType:y}),_}};e$c([y$c()],y$7.prototype,"activeMediaInfoIndex",void 0),e$c([y$c({readOnly:!0})],y$7.prototype,"activeMediaInfo",null),e$c([y$c()],y$7.prototype,"attributes",void 0),e$c([y$c()],y$7.prototype,"description",void 0),e$c([y$c()],y$7.prototype,"fieldInfoMap",void 0),e$c([y$c()],y$7.prototype,"formattedAttributes",void 0),e$c([y$c()],y$7.prototype,"expressionAttributes",void 0),e$c([y$c({readOnly:!0})],y$7.prototype,"formattedMediaInfos",null),e$c([y$c()],y$7.prototype,"layer",void 0),e$c([y$c({readOnly:!0})],y$7.prototype,"formattedMediaInfoCount",null),e$c([y$c()],y$7.prototype,"mediaInfos",void 0),e$c([y$c()],y$7.prototype,"popupTemplate",void 0),e$c([y$c()],y$7.prototype,"relatedInfos",void 0),e$c([y$c()],y$7.prototype,"title",void 0),y$7=e$c([n$s("esri.widgets.Feature.FeatureMedia.FeatureMediaViewModel")],y$7);var I$3=y$7;

var f$6=["#ffffff","#858585","#ffbebe","#ffebbe","#ffebaf","#ffffbe","#e9ffbe","#d3ffbe","#beffe8","#bee8ff","#bed2ff","#e8beff","#ffbee8","#ebebeb","#707070","#ff7f7f","#ffa77f","#ffd37f","#ffff73","#d1ff73","#a3ff73","#73ffdf","#73dfff","#73b2ff","#df73ff","#ff73df","#d6d6d6","#5c5c5c","#ff0000","#ff5500","#ffaa00","#ffff00","#aaff00","#55ff00","#00ffc5","#00c5ff","#0070ff","#c500ff","#ff00c5","#c2c2c2","#474747","#e60000","#e64c00","#e69800","#e6e600","#98e600","#4ce600","#00e6a9","#00a9e6","#005ce6","#a900e6","#e600a9","#adadad","#242424","#a80000","#a83800","#a87000","#a8a800","#70a800","#38a800","#00a884","#0084a8","#004da8","#8400a8","#a80084","#999999","#1a1a1a","#730000","#732600","#734c00","#737300","#4c7300","#267300","#00734c","#004c73","#002673","#4c0073","#73004"],b$4=[].concat(f$6.slice(30,39),f$6.slice(28,30).reverse()),e$8=[{name:"default",colors:b$4},{name:"cat-dark",colors:["#ed5151","#149ece","#a7c636","#9e559c","#fc921f","#ffde3e","#f789d8","#b7814a","#3caf99","#6b6bd6","#b54779","#7f7f7f"]},{name:"tropical-bliss",colors:["#fce138","#ff9399","#fcd27e","#f1983c","#a553b7","#b1a9d0","#6ecffc","#4c81cd","#fc6f84","#fc3e5a","#6af689","#48885c"]},{name:"desert-blooms",colors:["#102432","#144d59","#ffc730","#ed9310","#a64f1b","#661510","#d9351a","#b31515","#4a0932","#8c213f","#18382e","#2c6954"]},{name:"under-the-sea",colors:["#bf9727","#607100","#00734c","#704489","#01acca","#024e76","#f09100","#ea311f","#c6004b","#7570b3","#666666","#333333"]},{name:"vibrant-rainbow",colors:["#fffb00","#f5cb11","#9fd40c","#46e39c","#32b8a6","#7ff2fa","#ac08cc","#dd33ff","#eb7200","#e8a784","#bf2e2e","#6c7000"]},{name:"ocean-bay",colors:["#191921","#11495c","#78b1c2","#454f4b","#8f8f82","#9be0c0","#87b051","#f7ec88","#ebdcc1","#dbb658","#c43541","#75351e"]},{name:"prairie-summer",colors:["#332424","#751555","#d47013","#d68989","#211173","#82aad6","#7bfaeb","#6ec9a8","#6b6408","#eada40","#ccc54a","#1fc235"]},{name:"pastel-chalk",colors:["#fffd99","#f5e6a4","#c1d48c","#b8e3d0","#a0b8b5","#cbf7fa","#d791f2","#dfc1eb","#f2b983","#e8c4b2","#bf8e8e","#94995c"]},{name:"seq-yellow-orange-red-bright",colors:["#910000","#b1260b","#c0370f","#e05919","#ef6a1d","#ff7b22","#ffa143","#ffb454","#ffda74","#ffed85"]},{name:"seq-reds-bright",colors:["#57453b","#7b4238","#9f4036","#c23d33","#d7483c","#ec5244","#f3696c","#f9816c","#ffc4ae","#fff0dc"]},{name:"seq-purples-bright",colors:["#4e465c","#5a4a78","#695291","#775baa","#8663c3","#946bdc","#aa89e8","#c1a6f3","#d7c4ff","#e6e1ff"]},{name:"seq-blues-bright",colors:["#404d54","#435c6c","#48799d","#4b88b6","#4d96ce","#50a5e7","#74bbed","#98d0f3","#bce6f9","#e6faff"]},{name:"seq-greens-bright",colors:["#39544c","#386757","#368165","#359b73","#33b581","#4bc392","#64d2a2","#7ce0b3","#cbf6d9","#f4ffea"]},{name:"seq-browns-bright",colors:["#524834","#715b38","#8f6e3c","#ae8140","#cc9444","#eba748","#eeb664","#f0c47f","#f9e0b7","#fff8eb"]}];

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
const r$d="en-us",u$d=new Map([["ar",()=>import('./ar-a205c398.js').then((function(n){return n.a}))],["bs-ba",()=>import('./bs_BA-f1439b56.js').then((function(n){return n.b}))],["ca-es",()=>import('./ca_ES-30060237.js').then((function(n){return n.c}))],["cs-cz",()=>import('./cs_CZ-64b72ef9.js').then((function(n){return n.c}))],["da-dk",()=>import('./da_DK-58387606.js').then((function(n){return n.d}))],["de-de",()=>import('./de_DE-16b2a9a2.js').then((function(n){return n.d}))],["de-ch",()=>import('./de_CH-a9ef83ae.js').then((function(n){return n.d}))],["el-gr",()=>import('./el_GR-a65b42da.js').then((function(n){return n.e}))],["en-us",()=>import('./en_US-504674ec.js').then((function(n){return n.e}))],["en-ca",()=>import('./en_CA-6edf9756.js').then((function(n){return n.e}))],["es-es",()=>import('./es_ES-9d375428.js').then((function(n){return n.e}))],["et-ee",()=>import('./et_EE-e3efff17.js').then((function(n){return n.e}))],["fi-fi",()=>import('./fi_FI-51af6190.js').then((function(n){return n.f}))],["fr-fr",()=>import('./fr_FR-6195cc1d.js').then((function(n){return n.f}))],["he-il",()=>import('./he_IL-1cbc6810.js').then((function(n){return n.h}))],["hr-hr",()=>import('./hr_HR-e1731e9f.js').then((function(n){return n.h}))],["hu-hu",()=>import('./hu_HU-76e62dfb.js').then((function(n){return n.h}))],["id-id",()=>import('./id_ID-98924267.js').then((function(n){return n.i}))],["it-it",()=>import('./it_IT-3b272740.js').then((function(n){return n.i}))],["ja-jp",()=>import('./ja_JP-b99b09da.js').then((function(n){return n.j}))],["ko-kr",()=>import('./ko_KR-40c8b310.js').then((function(n){return n.k}))],["lt-lt",()=>import('./lt_LT-3de45fd1.js').then((function(n){return n.l}))],["lv-lv",()=>import('./lv_LV-60d9add1.js').then((function(n){return n.l}))],["nb-no",()=>import('./nb_NO-8a1eb149.js').then((function(n){return n.n}))],["nl-nl",()=>import('./nl_NL-f0337dbd.js').then((function(n){return n.n}))],["pl-pl",()=>import('./pl_PL-70bcc186.js').then((function(n){return n.p}))],["pt-br",()=>import('./pt_BR-d37d27d2.js').then((function(n){return n.p}))],["pt-pt",()=>import('./pt_PT-9b9343ad.js').then((function(n){return n.p}))],["ro-ro",()=>import('./ro_RO-7e50e217.js').then((function(n){return n.r}))],["ru-ru",()=>import('./ru_RU-b1e656d8.js').then((function(n){return n.r}))],["sk-sk",()=>import('./sk_SK-66a4d778.js').then((function(n){return n.s}))],["sl-sl",()=>import('./sl_SL-48a31fe9.js').then((function(n){return n.s}))],["sr-rs",()=>import('./sr_RS-ae5c7bdc.js').then((function(n){return n.s}))],["sv-se",()=>import('./sv_SE-9f2439cc.js').then((function(n){return n.s}))],["th-th",()=>import('./th_TH-61cef73a.js').then((function(n){return n.t}))],["tr-tr",()=>import('./tr_TR-973137ff.js').then((function(n){return n.t}))],["uk-ua",()=>import('./uk_UA-b5796599.js').then((function(n){return n.u}))],["vi-vn",()=>import('./vi_VN-5f594728.js').then((function(n){return n.v}))],["zh-cn",()=>import('./zh_Hans-41fbc334.js').then((function(n){return n.z}))],["zh-hk",()=>import('./zh_Hant-f78d37d0.js').then((function(n){return n.z}))],["zh-tw",()=>import('./zh_Hant-f78d37d0.js').then((function(n){return n.z}))]]);function e$7(n){const t=n.split("-")[0].toLowerCase();let r=null;for(const e of u$d.keys())if(e.startsWith(t)){r=e;break}return r}function s$f(n){return n?u$d.has(n.toLowerCase())?n.toLowerCase():e$7(n)||r$d:r$d}let o$c,i$d;async function c$m(n=i$g()){if(n=s$f(n),o$c&&n===i$d)return o$c;o$c=import('./index-e9895b2c.js').then((function(n){return n.i})),i$d=n;try{const[t,r]=await Promise.all([o$c,u$d.get(i$d)()]);i$d===n&&(t.am4core.options.defaultLocale=r.default),t.am4core.options.suppressWarnings=!0,t.am4core.options.autoDispose=!0;}catch{return o$c=null,i$d=null,null}return o$c}function h$a(t,r="default"){const u=e$8.find((n=>n.name===r));return u?u.colors.map((n=>t.color(n))):null}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
const v$4={base:"esri-feature-media",mediaContainer:"esri-feature-media__container",mediaItemContainer:"esri-feature-media__item-container",mediaItem:"esri-feature-media__item",mediaItemTitle:"esri-feature-media__item-title",mediaItemCaption:"esri-feature-media__item-caption",mediaPrevious:"esri-feature-media__previous",mediaPreviousIconLTR:"esri-feature-media__previous-icon",mediaPreviousIconRTL:"esri-feature-media__previous-icon--rtl",mediaNext:"esri-feature-media__next",mediaNextIconLTR:"esri-feature-media__next-icon",mediaNextIconRTL:"esri-feature-media__next-icon--rtl",mediaChart:"esri-feature-media__chart",mediaButton:"esri-feature-media__button",mediaIcon:"esri-feature-media__icon",iconLeftTriangleArrow:"esri-icon-left-triangle-arrow",iconRightTriangleArrow:"esri-icon-right-triangle-arrow"},_$6=.05,I$2=.95,M$1=15;let w$3=class extends x$2{constructor(e,t){super(e,t),this._refreshTimer=null,this._refreshIntervalInfo=null,this._featureElementInfo=null,this.attributes=null,this.activeMediaInfoIndex=null,this.description=null,this.fieldInfoMap=null,this.layer=null,this.mediaInfos=null,this.popupTemplate=null,this.relatedInfos=null,this.title=null,this.viewModel=new I$3,this.messages=null;}initialize(){this._featureElementInfo=new c$q,this.own(d$f(this,["viewModel.activeMediaInfo","viewModel.activeMediaInfoIndex"],(()=>this._setupMediaRefreshTimer())),d$f(this,["viewModel.description","viewModel.title"],(()=>this._setupFeatureElementInfo())));}destroy(){this._clearMediaRefreshTimer(),this._featureElementInfo.destroy();}render(){var e;return n$u("div",{bind:this,class:v$4.base,onkeyup:this._handleMediaKeyup},null==(e=this._featureElementInfo)?void 0:e.render(),this.renderMedia())}renderMedia(){const{formattedMediaInfoCount:e}=this.viewModel;return e?n$u("div",{key:"media-element-container",class:v$4.mediaContainer},this.renderMediaPageButton("previous"),this.renderMediaInfo(),this.renderMediaPageButton("next")):null}renderImageMediaInfo(e){const{_refreshIntervalInfo:t}=this,{activeMediaInfoIndex:i,formattedMediaInfoCount:r}=this.viewModel,{value:a,refreshInterval:o,altText:s,title:n,type:l}=e,{sourceURL:c,linkURL:m}=a,u=v$6(m)?"_blank":"_self",h="_blank"===u?"noreferrer":"",p=o?t:null,v=p?p.timestamp:0,_=p?p.sourceURL:c,I=n$u("img",{alt:s||n,key:`media-${l}-${i}-${r}-${v}`,src:_}),M=m?n$u("a",{title:n,href:m,rel:h,target:u},I):null;return M||I}renderChartMediaInfo(e){const{activeMediaInfoIndex:t,formattedMediaInfoCount:i}=this.viewModel;return n$u("div",{key:`media-${e.type}-${t}-${i}`,bind:this,class:v$4.mediaChart,afterCreate:this._getChartDependencies})}renderMediaInfoType(){const{activeMediaInfo:e}=this.viewModel;return e?"image"===e.type?this.renderImageMediaInfo(e):-1!==e.type.indexOf("chart")?this.renderChartMediaInfo(e):null:null}renderMediaInfo(){const{activeMediaInfo:e}=this.viewModel;if(!e)return null;const t=e.title?n$u("div",{key:"media-title",class:v$4.mediaItemTitle,innerHTML:e.title}):null,i=e.caption?n$u("div",{key:"media-caption",class:v$4.mediaItemCaption,innerHTML:e.caption}):null;return n$u("div",{key:"media-container",class:v$4.mediaItemContainer},n$u("div",{key:"media-item-container",class:v$4.mediaItem},this.renderMediaInfoType()),t,i)}renderMediaPageButton(e){if(this.viewModel.formattedMediaInfoCount<2)return null;const t="previous"===e,i=t?this.messages.previous:this.messages.next,r=t?this.classes(v$4.mediaButton,v$4.mediaPrevious):this.classes(v$4.mediaButton,v$4.mediaNext),a=t?this.classes(v$4.mediaIcon,v$4.mediaPreviousIconLTR,v$4.iconLeftTriangleArrow):this.classes(v$4.mediaIcon,v$4.mediaNextIconLTR,v$4.iconRightTriangleArrow),o=t?this.classes(v$4.mediaIcon,v$4.mediaPreviousIconRTL,v$4.iconRightTriangleArrow):this.classes(v$4.mediaIcon,v$4.mediaNextIconRTL,v$4.iconLeftTriangleArrow),s=t?"media-previous":"media-next",n=t?this._previous:this._next;return n$u("button",{type:"button",key:s,title:i,"aria-label":i,tabIndex:0,class:r,bind:this,onclick:n},n$u("span",{"aria-hidden":"true",class:a}),n$u("span",{"aria-hidden":"true",class:o}))}_setupFeatureElementInfo(){const{description:e,title:t}=this;this._featureElementInfo.set({description:e,title:t});}_next(){this.viewModel.next();}_previous(){this.viewModel.previous();}async _getChartDependencies(e){const t=await c$m(),{activeMediaInfo:i}=this.viewModel;this._renderChart({chartDiv:e,mediaInfo:i,chartsModule:t});}_handleMediaKeyup(e){const i=i$h(e);"ArrowLeft"===i&&(e.stopPropagation(),this.viewModel.previous()),"ArrowRight"===i&&(e.stopPropagation(),this.viewModel.next());}_renderChart(e){const{chartsModule:t,chartDiv:i,mediaInfo:r}=e,{value:a,type:o}=r,{am4core:s}=t,n=h$a(s);function l(e){e instanceof s.ColorSet&&n&&(e.list=n);}b$9()&&s.useTheme(t.am4themes_dark),s.useTheme(t.am4themes_animated),s.useTheme(l);const d="pie-chart"===o?this._createPieChart(e):this._createXYChart(e);i.setAttribute("aria-label",r.altText||r.title),d.data=a.series.map((e=>({tooltip:e.tooltip,value:e.value}))).filter((e=>"pie-chart"!==o||e.value>0));}_customizeChartTooltip(e,t){e.label.wrap=!0,e.label.maxWidth=200,e.autoTextColor=!1,e.getFillFromObject=!1,e.label.fill=t.color("#ffffff"),e.background.fill=t.color({r:0,g:0,b:0,a:.7});}_createPieChart(e){const{chartDiv:t,chartsModule:i}=e,{am4core:r,am4charts:a}=i,o=r.create(t,a.PieChart);o.rtl=d$h();const s=o.series.push(new a.PieSeries);return s.labels.template.disabled=!0,s.ticks.template.disabled=!0,s.dataFields.value="value",s.dataFields.category="tooltip",this._customizeChartTooltip(s.tooltip,r),o}_getMinSeriesValue(e){let t=0;return e.forEach((e=>t=Math.min(e.value,t))),t}_createColumnChart(e,t){const{chartsModule:i,mediaInfo:r}=t,{value:a}=r,{am4core:o,am4charts:s}=i,n=e.xAxes.push(new s.CategoryAxis);n.dataFields.category="tooltip",n.renderer.labels.template.disabled=!0,this._customizeChartTooltip(n.tooltip,o),n.tooltip.events.on("sizechanged",(()=>{n.tooltip.dy=-n.tooltip.contentHeight;}));const l=e.yAxes.push(new s.ValueAxis),d=l.renderer.labels.template;l.renderer.minLabelPosition=_$6,l.renderer.maxLabelPosition=I$2,l.min=this._getMinSeriesValue(a.series),this._customizeChartTooltip(l.tooltip,o),d.wrap=!0;const c=e.series.push(new s.ColumnSeries);c.dataFields.valueY="value",c.dataFields.categoryX="tooltip",e.cursor=new s.XYCursor,a.series.length>M$1&&(e.scrollbarX=new o.Scrollbar);}_createBarChart(e,t){const{chartsModule:i,mediaInfo:r}=t,{value:a}=r,{am4core:o,am4charts:s}=i,n=e.yAxes.push(new s.CategoryAxis);n.dataFields.category="tooltip",n.renderer.inversed=!0,n.renderer.labels.template.disabled=!0,this._customizeChartTooltip(n.tooltip,o),n.tooltip.events.on("sizechanged",(()=>{n.tooltip.dx=n.tooltip.contentWidth;}));const l=e.xAxes.push(new s.ValueAxis),d=l.renderer.labels.template;l.renderer.minLabelPosition=_$6,l.renderer.maxLabelPosition=I$2,l.min=this._getMinSeriesValue(a.series),this._customizeChartTooltip(l.tooltip,o),d.wrap=!0;const c=e.series.push(new s.ColumnSeries);c.dataFields.valueX="value",c.dataFields.categoryY="tooltip",e.cursor=new s.XYCursor,a.series.length>M$1&&(e.scrollbarY=new o.Scrollbar);}_createLineChart(e,t){const{chartsModule:i,mediaInfo:r}=t,{value:a}=r,{am4core:o,am4charts:s}=i,n=e.xAxes.push(new s.CategoryAxis);n.dataFields.category="tooltip",n.renderer.labels.template.disabled=!0,this._customizeChartTooltip(n.tooltip,o),n.tooltip.events.on("sizechanged",(()=>{n.tooltip.dy=-n.tooltip.contentHeight;}));const l=e.yAxes.push(new s.ValueAxis),d=l.renderer.labels.template;l.renderer.minLabelPosition=_$6,l.renderer.maxLabelPosition=I$2,l.min=this._getMinSeriesValue(a.series),this._customizeChartTooltip(l.tooltip,o),d.wrap=!0;const c=e.series.push(new s.LineSeries);c.dataFields.categoryX="tooltip",c.dataFields.valueY="value",e.cursor=new s.XYCursor,a.series.length>M$1&&(e.scrollbarX=new o.Scrollbar);}_createXYChart(e){const{chartDiv:t,chartsModule:i,mediaInfo:r}=e,{type:a}=r,{am4core:o,am4charts:s}=i,n=o.create(t,s.XYChart);return n.rtl=d$h(),"column-chart"===a&&this._createColumnChart(n,e),"bar-chart"===a&&this._createBarChart(n,e),"line-chart"===a&&this._createLineChart(n,e),n}_clearMediaRefreshTimer(){const{_refreshTimer:e}=this;e&&(clearTimeout(e),this._refreshTimer=null);}_updateMediaInfoTimestamp(e){const t=Date.now();this._refreshIntervalInfo={timestamp:t,sourceURL:this._getImageSource(e,t)},this.scheduleRender();}_setupMediaRefreshTimer(){this._clearMediaRefreshTimer();const{activeMediaInfo:e}=this.viewModel;e&&"image"===e.type&&e.refreshInterval&&this._setRefreshTimeout(e);}_setRefreshTimeout(e){const{refreshInterval:t,value:i}=e;if(!t)return;const r=6e4*t;this._updateMediaInfoTimestamp(i.sourceURL);const a=setInterval((()=>{this._updateMediaInfoTimestamp(i.sourceURL);}),r);this._refreshTimer=a;}_getImageSource(e,t){const i=-1!==e.indexOf("?")?"&":"?",[r,a=""]=e.split("#");return `${r}${i}timestamp=${t}${a?"#":""}${a}`}};e$c([o$g("viewModel.attributes")],w$3.prototype,"attributes",void 0),e$c([o$g("viewModel.activeMediaInfoIndex")],w$3.prototype,"activeMediaInfoIndex",void 0),e$c([o$g("viewModel.description")],w$3.prototype,"description",void 0),e$c([o$g("viewModel.fieldInfoMap")],w$3.prototype,"fieldInfoMap",void 0),e$c([o$g("viewModel.layer")],w$3.prototype,"layer",void 0),e$c([o$g("viewModel.mediaInfos")],w$3.prototype,"mediaInfos",void 0),e$c([o$g("viewModel.popupTemplate")],w$3.prototype,"popupTemplate",void 0),e$c([o$g("viewModel.relatedInfos")],w$3.prototype,"relatedInfos",void 0),e$c([o$g("viewModel.title")],w$3.prototype,"title",void 0),e$c([y$c({type:I$3})],w$3.prototype,"viewModel",void 0),e$c([y$c(),e$d("esri/widgets/Feature/t9n/Feature")],w$3.prototype,"messages",void 0),w$3=e$c([n$s("esri.widgets.Feature.FeatureMedia")],w$3);var g$c=w$3;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
const i$c=["$datastore","$map","$layer","$aggregatedfeatures"],o$b="esri.widgets.Feature.support.arcadeFeatureUtils",n$l=n$t.getLogger(o$b);function c$l(e){return `<ul class="esri-widget__list">${e.map((e=>`<li>${"string"==typeof e?X$1(W$4(e)):e}</li>`)).join("")}</ul>`}function p$h(e){return `<table class="esri-widget__table">${e.keys().map((r=>{const t=e.field(r);return `<tr><th>${r}</th><td>${"string"==typeof t?X$1(W$4(t)):t}</td></tr>`})).join("")}</table>`}function l$d({aggregatedFeatures:e,arcadeUtils:r,featureSetVars:a,context:s,viewInfo:i,map:o,graphic:n}){a.forEach((a=>{const c=a.toLowerCase(),p={map:o,spatialReference:i.sr};if("$map"===c&&(s.vars[c]=r.convertMapToFeatureSetCollection(p)),"$layer"===c&&(s.vars[c]=r.convertFeatureLayerToFeatureSet(n.sourceLayer,i.sr)),"$datastore"===c&&(s.vars[c]=r.convertServiceUrlToWorkspace(n.sourceLayer.url,i.sr)),"$aggregatedfeatures"===c){const a=n.layer,{fields:o,objectIdField:p,geometryType:l,spatialReference:u,displayField:f}=a,d=new We({fields:o,objectIdField:p,geometryType:l,spatialReference:u,displayField:f,..."feature"===a.type?{templates:a.templates,typeIdField:a.typeIdField,types:a.types}:null,source:e});s.vars[c]=r.convertFeatureLayerToFeatureSet(d,i.sr);}}));}function u$c(){return import('./arcadeUtils-e7a1e061.js').then(function (n) { return n.aq; })}async function f$5({graphic:e,view:r}){const{isAggregate:t,layer:a}=e;if(!t||!a||"2d"!==(null==r?void 0:r.type))return [];const s=await r.whenLayerView(a);if(!s.createQuery||!s.queryFeatures)return [];const i=s.createQuery();i.aggregateIds=[e.getObjectId()];const{features:o}=await s.queryFeatures(i);return o}async function d$a({expressionAttributes:e,info:r,arcadeUtils:t,spatialReference:o,map:u,graphic:d,view:g}){const y=`expression/${r.name}`,m=t.createSyntaxTree(r.expression),w=i$c.filter((e=>t.hasVariable(m,e)));await t.loadScriptDependencies(m,!0,w);const F=t.getViewInfo({spatialReference:o}),v=t.createExecContext(d,F);v.useAsync=!0;l$d({aggregatedFeatures:await f$5({graphic:d,view:g}),arcadeUtils:t,featureSetVars:w,context:v,viewInfo:F,map:u,graphic:d});const h=t.createFunction(m,v),x=await t.executeAsyncFunction(h,v).catch((e=>n$l.error("arcade-execution-error",{error:e,graphic:d,expressionInfo:r})));e[y]="string"==typeof x?X$1(W$4(x)):Array.isArray(x)?c$l(x):x&&"esri.arcade.Dictionary"===x.declaredClass?p$h(x):x;}async function g$b({popupTemplate:e,spatialReference:t,graphic:a,map:s,view:i}){const o=e.expressionInfos,n=[],c={};if(!o||!o.length)return c;const p=await u$c();for(const r of o)n.push(d$a({expressionAttributes:c,info:r,arcadeUtils:p,spatialReference:t,map:s,graphic:a,view:i}));return await A$4(n),c}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
const E$1=1,R$2="esri.widgets.FeatureViewModel",O$2=n$t.getLogger(R$2);let k$1=class extends p$q{constructor(e){super(e),this._handles=new u$g,this._featureAbortController=null,this.graphicChangedThrottled=e$b(this.graphicChanged,E$1,this),this._expressionAttributes=null,this.content=null,this.contentViewModels=[],this.defaultPopupTemplateEnabled=!1,this.formattedAttributes=null,this.lastEditInfo=null,this.relatedInfos=new Map,this.title="",this.view=null,this._handles.add(d$f(this,["graphic","_effectivePopupTemplate"],(()=>this.graphicChangedThrottled())));}destroy(){this._clear(),this._cancelFeatureQuery(),this._handles.destroy(),this._handles=null,this.graphic=null,this._destroyContentViewModels(),this.relatedInfos.clear();}get _effectivePopupTemplate(){return r$g(this.graphic)?this.graphic.getEffectivePopupTemplate(this.defaultPopupTemplateEnabled):null}get _fieldInfoMap(){return K$1(V$3(this._effectivePopupTemplate),this._sourceLayer)}get _sourceLayer(){return N$1(this.graphic)}set graphic(e){this._set("graphic",e?e.clone():null);}get spatialReference(){return this.get("view.spatialReference")||null}set spatialReference(e){void 0!==e?this._override("spatialReference",e):this._clearOverride("spatialReference");}get map(){return this.get("view.map")||null}set map(e){void 0!==e?this._override("map",e):this._clearOverride("map");}get waitingForContent(){return !!this._featureAbortController}setActiveMedia(e,t){const r=this.contentViewModels[e];r instanceof I$3&&r.setActiveMedia(t);}nextMedia(e){const t=this.contentViewModels[e];t instanceof I$3&&t.next();}previousMedia(e){const t=this.contentViewModels[e];t instanceof I$3&&t.previous();}_clear(){this._set("title",""),this._set("content",null),this._set("formattedAttributes",null);}async graphicChanged(){this._cancelFeatureQuery(),this._clear();const{graphic:e}=this;if(!e)return;const t=h$g();this._featureAbortController=t;try{await this._queryFeature({signal:t.signal});}catch(r){O$2.error("error","error loading popupTemplate for graphic",{error:r,graphic:e});}this._featureAbortController===t&&(this._featureAbortController=null);}_cancelFeatureQuery(){const{_featureAbortController:e}=this;e&&e.abort(),this._featureAbortController=null;}_compileContent(e){if(this._destroyContentViewModels(),this.graphic)return Array.isArray(e)?e.map(((e,t)=>"attachments"===e.type?this._compileAttachments(e,t):"custom"===e.type?this._compileCustom(e,t):"fields"===e.type?this._compileFields(e,t):"media"===e.type?this._compileMedia(e,t):"text"===e.type?this._compileText(e,t):void 0)):"string"==typeof e?this._compileText(new c$x({text:e}),0).text:e}_destroyContentViewModels(){this.contentViewModels.forEach((e=>e&&!e.destroyed&&e.destroy())),this._set("contentViewModels",[]);}_compileAttachments(e,t){const{graphic:r}=this,{description:i,title:o}=e;return this.contentViewModels[t]=new c$r({graphic:r,...this._compileTitleAndDesc({title:o,description:i})}),e}_compileCustom(e,t){const{graphic:r}=this,{creator:i,destroyer:o}=e;return this.contentViewModels[t]=new p$l({graphic:r,creator:i,destroyer:o}),e}_compileTitleAndDesc({title:e,description:t}){const{_fieldInfoMap:r,_sourceLayer:i,graphic:o,formattedAttributes:s,_expressionAttributes:a}=this,{attributes:l}=o,n=s.global;return {title:G$2({attributes:l,fieldInfoMap:r,globalAttributes:n,expressionAttributes:a,layer:i,text:e}),description:G$2({attributes:l,fieldInfoMap:r,globalAttributes:n,expressionAttributes:a,layer:i,text:t})}}_compileFields(e,t){const{_effectivePopupTemplate:r,formattedAttributes:i}=this,o=e.clone(),s=(null==e?void 0:e.fieldInfos)||(null==r?void 0:r.fieldInfos),a=null==r?void 0:r.expressionInfos,l={...i.global,...i.content[t]},{description:n,title:p}=o,c=new n$m({attributes:l,expressionInfos:a,fieldInfos:s,...this._compileTitleAndDesc({title:p,description:n})});return this.contentViewModels[t]=c,o.fieldInfos=c.formattedFieldInfos.slice(0),o}_compileMedia(e,t){const{graphic:r,_fieldInfoMap:i,_effectivePopupTemplate:o,relatedInfos:s,_sourceLayer:a,_expressionAttributes:l}=this,{attributes:n}=r,p=this.formattedAttributes.global,c=e.clone(),{description:d,mediaInfos:u,title:f}=c,h=new I$3({activeMediaInfoIndex:c.activeMediaInfoIndex||0,attributes:n,layer:a,fieldInfoMap:i,formattedAttributes:p,expressionAttributes:l,mediaInfos:u,popupTemplate:o,relatedInfos:s,...this._compileTitleAndDesc({title:f,description:d})});return c.mediaInfos=h.formattedMediaInfos.slice(0),this.contentViewModels[t]=h,c}_compileText(e,t){const r=e.clone(),{graphic:i,_fieldInfoMap:o,_sourceLayer:s,_expressionAttributes:a}=this;if(r&&r.text){const{attributes:e}=i,t=this.formattedAttributes.global;r.text=G$2({attributes:e,fieldInfoMap:o,globalAttributes:t,expressionAttributes:a,layer:s,text:r.text});}return this.contentViewModels[t]=new p$l({graphic:i,creator:r.text}),r}_compileLastEditInfo(){const{_effectivePopupTemplate:e,_sourceLayer:t,graphic:r}=this;if(!e)return;const{lastEditInfoEnabled:i}=e,o=null==t?void 0:t.editFieldsInfo;return i&&o?J$1(o,r.attributes):void 0}_compileTitle(e){const{_fieldInfoMap:t,_sourceLayer:r,graphic:i,_expressionAttributes:o}=this,{attributes:s}=i,a=this.formattedAttributes.global;return G$2({attributes:s,fieldInfoMap:t,globalAttributes:a,expressionAttributes:o,layer:r,text:e})}async _getTitle(){const{_effectivePopupTemplate:e,graphic:t}=this,r=null==e?void 0:e.title;return j$3(r,{graphic:t})}async _getContent(){const{_effectivePopupTemplate:e,graphic:t}=this,r=null==e?void 0:e.content;return j$3(r,{graphic:t})}async _queryFeature(e){const{_featureAbortController:t,_sourceLayer:r,graphic:i,_effectivePopupTemplate:o,spatialReference:s,map:a,view:n}=this,{content:{value:p},title:{value:c}}=await A$4({content:this._getContent(),title:this._getTitle()});if(t!==this._featureAbortController||!i)return;await te({graphic:i,popupTemplate:o,layer:r,spatialReference:s},e);const{expressionAttributes:{value:d}}=await A$4({checkForRelatedFeatures:this._checkForRelatedFeatures(e),expressionAttributes:g$b({popupTemplate:this._effectivePopupTemplate,spatialReference:s,graphic:i,map:a,view:n})});t===this._featureAbortController&&i&&(this._expressionAttributes=d,this._set("formattedAttributes",this._createFormattedAttributes(p,d)),this._set("title",this._compileTitle(c)),this._set("lastEditInfo",this._compileLastEditInfo()||null),this._set("content",this._compileContent(p)||null));}_createFormattedAttributes(e,t){const{_effectivePopupTemplate:r,graphic:i,relatedInfos:o,_sourceLayer:s,_fieldInfoMap:a}=this,l=null==r?void 0:r.fieldInfos,n={...i.attributes,...t},p={global:Z$1({fieldInfos:l,graphic:i,attributes:n,layer:s,fieldInfoMap:a,relatedInfos:o}),content:[]};return Array.isArray(e)&&e.forEach(((e,t)=>{"fields"===e.type&&e.fieldInfos&&(p.content[t]=Z$1({fieldInfos:e.fieldInfos,graphic:i,attributes:n,layer:s,fieldInfoMap:a,relatedInfos:o}));})),p}_checkForRelatedFeatures(e){const{graphic:t,_effectivePopupTemplate:r}=this;return this._queryRelatedInfos(t,V$3(r),e)}async _queryRelatedInfos(e,t,r){const{relatedInfos:i,_sourceLayer:o}=this;i.clear();const a=r$g(o.associatedLayer)?await o.associatedLayer.load(r):o;if(!a)return;const l=t.filter((e=>e&&re(e.fieldName)));if(!l||!l.length)return;t.forEach((e=>this._configureRelatedInfo(e,a)));const n=await S$6({relatedInfos:i,layer:a},r);Object.keys(n).forEach((e=>{var t;const r=i.get(e.toString()),o=null==(t=n[e])?void 0:t.value;r&&o&&(r.layerInfo=o.data);}));const p=await T$2({graphic:e,relatedInfos:i,layer:a},r);Object.keys(p).forEach((e=>{var t;I$4(null==(t=p[e])?void 0:t.value,i.get(e.toString()));}));}_configureRelatedInfo(e,t){const{relatedInfos:r}=this,i=p$i(e.fieldName);if(!i)return;const{layerId:o,fieldName:s}=i;if(!o)return;const a=r.get(o.toString())||h$b(o,t);a&&($$1({relatedInfo:a,fieldName:s,fieldInfo:e}),this.relatedInfos.set(o,a));}};e$c([y$c()],k$1.prototype,"_featureAbortController",void 0),e$c([y$c({readOnly:!0})],k$1.prototype,"_effectivePopupTemplate",null),e$c([y$c({readOnly:!0})],k$1.prototype,"_fieldInfoMap",null),e$c([y$c({readOnly:!0})],k$1.prototype,"_sourceLayer",null),e$c([y$c({readOnly:!0})],k$1.prototype,"content",void 0),e$c([y$c({readOnly:!0})],k$1.prototype,"contentViewModels",void 0),e$c([y$c({type:Boolean})],k$1.prototype,"defaultPopupTemplateEnabled",void 0),e$c([y$c({readOnly:!0})],k$1.prototype,"formattedAttributes",void 0),e$c([y$c({type:h$f,value:null})],k$1.prototype,"graphic",null),e$c([y$c({readOnly:!0})],k$1.prototype,"lastEditInfo",void 0),e$c([y$c()],k$1.prototype,"relatedInfos",void 0),e$c([y$c()],k$1.prototype,"spatialReference",null),e$c([y$c({readOnly:!0})],k$1.prototype,"title",void 0),e$c([y$c()],k$1.prototype,"map",null),e$c([y$c({readOnly:!0})],k$1.prototype,"waitingForContent",null),e$c([y$c()],k$1.prototype,"view",void 0),k$1=e$c([n$s(R$2)],k$1);var S$5=k$1;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
const c$k=c=>{let i=class extends c{constructor(){super(...arguments),this.renderNodeContent=e=>e$e(e)&&!e.destroyed?n$u("div",{key:e},e.render()):e instanceof HTMLElement?n$u("div",{key:e,bind:e,afterCreate:this._attachToNode}):t$g(e)?n$u("div",{key:e,bind:e.domNode,afterCreate:this._attachToNode}):null;}_attachToNode(e){const r=this;e.appendChild(r);}};return i=e$c([n$s("esri.widgets.Feature.ContentMixin")],i),i};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
const g$a={iconText:"esri-icon-font-fallback-text",iconLoading:"esri-icon-loading-indicator esri-rotating",esriTable:"esri-widget__table",esriWidget:"esri-widget",base:"esri-feature",container:"esri-feature__size-container",title:"esri-feature__title",main:"esri-feature__main-container",btn:"esri-feature__button",icon:"esri-feature__icon",content:"esri-feature__content",contentElement:"esri-feature__content-element",text:"esri-feature__text",lastEditedInfo:"esri-feature__last-edited-info",fields:"esri-feature__fields",fieldHeader:"esri-feature__field-header",fieldData:"esri-feature__field-data",fieldDataDate:"esri-feature__field-data--date",loadingSpinnerContainer:"esri-feature__loading-container",spinner:"esri-feature__loading-spinner"},y$6={title:!0,content:!0,lastEditedInfo:!0};let _$5=class extends(c$k(x$2)){constructor(e,t){super(e,t),this._contentWidgets=[],this.graphic=null,this.defaultPopupTemplateEnabled=!1,this.headingLevel=2,this.label=void 0,this.messages=null,this.messagesURIUtils=null,this.spatialReference=null,this.title=null,this.visibleElements={...y$6},this.map=null,this.view=null,this.viewModel=new S$5;}initialize(){this.own(d$f(this,"viewModel.contentViewModels",(()=>this._setupContentWidgets())));}destroy(){this._destroyContentWidgets();}castVisibleElements(e){return {...y$6,...e}}render(){const{waitingForContent:e}=this.viewModel;return n$u("div",{class:this.classes(g$a.base,g$a.esriWidget)},n$u("div",{class:g$a.container},this.renderTitle(),e?this.renderLoading():this.renderContentContainer()))}setActiveMedia(e,t){this.viewModel.setActiveMedia(e,t);}nextMedia(e){this.viewModel.nextMedia(e);}previousMedia(e){this.viewModel.previousMedia(e);}renderLoading(){return n$u("div",{key:"loading-container",class:g$a.loadingSpinnerContainer},n$u("span",{class:this.classes(g$a.iconLoading,g$a.spinner)}))}renderContentContainer(){const{visibleElements:e}=this;return e.content?n$u("div",{class:g$a.main},[this.renderContent(),this.renderLastEditInfo()]):null}renderTitle(){const{visibleElements:e,title:t}=this;return e.title?n$u(s$h,{level:this.headingLevel,class:g$a.title,innerHTML:t}):null}renderContent(){const e=this.viewModel.content,t="content";if(!e)return null;if(Array.isArray(e))return e.length?n$u("div",{key:`${t}-content-elements`},e.map(this.renderContentElement,this)):null;if("string"==typeof e){const e=this._contentWidgets[0];return !e||e.destroyed?null:n$u("div",{key:`${t}-content`},e.render())}return this.renderNodeContent(e)}renderContentElement(e,t){const{visibleElements:i}=this;if("boolean"!=typeof i.content&&!i.content[e.type])return null;switch(e.type){case"attachments":return this.renderAttachments(t);case"custom":return this.renderCustom(e,t);case"fields":return this.renderFields(t);case"media":return this.renderMedia(t);case"text":return this.renderText(e,t);default:return null}}renderAttachments(e){const t=this._contentWidgets[e];if(!t||t.destroyed)return null;const{state:i,attachmentInfos:s}=t.viewModel;return "loading"===i||s.length>0?n$u("div",{key:this._buildKey("attachments-element",e),class:this.classes(g$a.contentElement)},t.render()):null}renderCustom(e,t){const{creator:i}=e,s=this._contentWidgets[t];return !s||s.destroyed?null:i?n$u("div",{key:this._buildKey("custom-element",t),class:g$a.contentElement},s.render()):null}renderFields(e){const t=this._contentWidgets[e];return !t||t.destroyed?null:n$u("div",{key:this._buildKey("fields-element",e),class:g$a.contentElement},t.render())}renderMedia(e){const t=this._contentWidgets[e];return !t||t.destroyed?null:n$u("div",{key:this._buildKey("media-element",e),class:g$a.contentElement},t.render())}renderLastEditInfo(){const{visibleElements:e,messages:t}=this,{lastEditInfo:i}=this.viewModel;if(!i||!e.lastEditedInfo)return null;const{date:s,user:n}=i,r="edit"===i.type?n?t.lastEditedByUser:t.lastEdited:n?t.lastCreatedByUser:t.lastCreated,o=s$k(r,{date:s,user:n});return n$u("div",{key:"edit-info-element",class:this.classes(g$a.lastEditedInfo,g$a.contentElement)},o)}renderText(e,t){const i=e.text,s=this._contentWidgets[t];return !s||s.destroyed?null:i?n$u("div",{key:this._buildKey("text-element",t),class:this.classes(g$a.contentElement,g$a.text)},s.render()):null}_buildKey(e,...t){return `${e}__${this.get("viewModel.graphic.uid")||"0"}-${t.join("-")}`}_destroyContentWidgets(){this._contentWidgets.forEach((e=>{e.viewModel=null,e&&!e.destroyed&&e.destroy();})),this._contentWidgets=[];}_setupContentWidgets(){this._destroyContentWidgets();const{headingLevel:e,visibleElements:t}=this,i=this.get("viewModel.content"),{contentViewModels:s}=this.viewModel;if(Array.isArray(i))i.forEach(((i,n)=>{"attachments"===i.type&&(this._contentWidgets[n]=new h$c({displayType:i.displayType,headingLevel:t.title?e+1:e,viewModel:s[n]})),"fields"===i.type&&(this._contentWidgets[n]=new m$b({viewModel:s[n]})),"media"===i.type&&(this._contentWidgets[n]=new g$c({viewModel:s[n]})),"text"===i.type&&(this._contentWidgets[n]=new p$k({viewModel:s[n]})),"custom"===i.type&&(this._contentWidgets[n]=new p$k({viewModel:s[n]}));}),this);else {const e=s[0];e&&!e.destroyed&&(this._contentWidgets[0]=new p$k({viewModel:e}));}this.scheduleRender();}};e$c([o$g("viewModel.graphic")],_$5.prototype,"graphic",void 0),e$c([o$g("viewModel.defaultPopupTemplateEnabled")],_$5.prototype,"defaultPopupTemplateEnabled",void 0),e$c([y$c()],_$5.prototype,"headingLevel",void 0),e$c([y$c({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],_$5.prototype,"label",void 0),e$c([y$c(),e$d("esri/widgets/Feature/t9n/Feature")],_$5.prototype,"messages",void 0),e$c([y$c(),e$d("esri/widgets/support/t9n/uriUtils")],_$5.prototype,"messagesURIUtils",void 0),e$c([o$g("viewModel.spatialReference")],_$5.prototype,"spatialReference",void 0),e$c([o$g("viewModel.title")],_$5.prototype,"title",void 0),e$c([y$c()],_$5.prototype,"visibleElements",void 0),e$c([c$u("visibleElements")],_$5.prototype,"castVisibleElements",null),e$c([o$g("viewModel.map")],_$5.prototype,"map",void 0),e$c([o$g("viewModel.view")],_$5.prototype,"view",void 0),e$c([y$c({type:S$5})],_$5.prototype,"viewModel",void 0),_$5=e$c([n$s("esri.widgets.Feature")],_$5);var w$2=_$5;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
let c$j=class extends n$v.EventedAccessor{constructor(e){super(e),this._anchorHandles=new u$g,this.location=null,this.screenLocation=null,this.screenLocationEnabled=!1,this.view=null,this._anchorHandles.add([h$h(this,["screenLocationEnabled","location","view.size","view.stationary"],(()=>this._updateScreenPointAndHandle())),h$h(this,["view","view.ready"],(()=>this._wireUpView()))]);}destroy(){this.view=null,this._anchorHandles&&this._anchorHandles.destroy(),this._anchorHandles=null,this._viewpointHandle=null;}_wireUpView(){const e="view";this._anchorHandles.remove(e),this._viewpointHandle=null;if(!this.get("view.ready"))return;this._setScreenLocation();const{view:t}=this,o="3d"===t.type?"camera":"viewpoint",i=B$6(t,o,(()=>this._viewpointChange()));this._anchorHandles.add(i,e),this._viewpointHandle=i,this._toggleWatchingViewpoint();}_viewpointChange(){this._setScreenLocation(),this.emit("view-change");}_updateScreenPointAndHandle(){this._setScreenLocation(),this._toggleWatchingViewpoint();}_toggleWatchingViewpoint(){const{_viewpointHandle:e,location:t,screenLocationEnabled:o}=this;if(!e)return;t&&o?e.resume():e.pause();}_setScreenLocation(){const{location:e,view:t,screenLocationEnabled:o}=this,n=this.get("view.ready"),s=o&&n&&r$g(e)?t.toScreen(e):null;this._set("screenLocation",s);}};e$c([y$c()],c$j.prototype,"location",void 0),e$c([y$c({readOnly:!0})],c$j.prototype,"screenLocation",void 0),e$c([y$c()],c$j.prototype,"screenLocationEnabled",void 0),e$c([y$c()],c$j.prototype,"view",void 0),c$j=e$c([n$s("esri.widgets.support.AnchorElementViewModel")],c$j);var l$c=c$j;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
const t$b="esri.widgets.CompassViewModel";let p$g=class extends l$c{constructor(o){super(o),this.visible=!1;}};e$c([y$c()],p$g.prototype,"visible",void 0),p$g=e$c([n$s(t$b)],p$g);var c$i=p$g;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
const c$h={base:"esri-spinner",spinnerStart:"esri-spinner--start",spinnerFinish:"esri-spinner--finish"};let h$9=class extends x$2{constructor(i,e){super(i,e),this._animationDelay=500,this._animationPromise=null,this.location=null,this.view=null,this.viewModel=new c$i,this.visible=!1;}initialize(){this.own([h$h(this,"visible",(i=>this._visibleChange(i)))]);}destroy(){this._animationPromise=null;}show(i){const{location:e,promise:s}=i;e&&(this.viewModel.location=e),this.visible=!0;const o=()=>this.hide();s&&s.catch((()=>{})).then(o);}hide(){this.visible=!1;}render(){const{visible:i}=this,{screenLocation:e}=this.viewModel,s=!!e,o=i&&s,t=!i&&s,r={[c$h.spinnerStart]:o,[c$h.spinnerFinish]:t},n=this._getPositionStyles();return n$u("div",{class:this.classes(c$h.base,r),styles:n})}_visibleChange(i){if(i)return void(this.viewModel.screenLocationEnabled=!0);const e=C$5(this._animationDelay);this._animationPromise=e,e.catch((()=>{})).then((()=>{this._animationPromise===e&&(this.viewModel.screenLocationEnabled=!1,this._animationPromise=null);}));}_getPositionStyles(){const{screenLocation:i,view:s}=this.viewModel;if(!s||t$f(i))return {};const{padding:o}=s;return {left:i.x-o.left+"px",top:i.y-o.top+"px"}}};e$c([o$g("viewModel.location")],h$9.prototype,"location",void 0),e$c([o$g("viewModel.view")],h$9.prototype,"view",void 0),e$c([y$c({type:c$i})],h$9.prototype,"viewModel",void 0),e$c([o$g("viewModel.visible")],h$9.prototype,"visible",void 0),h$9=e$c([n$s("esri.widgets.Spinner")],h$9);var m$9=h$9;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
function b$3(e){return e&&"opacity"in e?e.opacity*b$3(e.parent):1}async function d$9(o,s){var c,u;if(!o)return;const y=o.sourceLayer,p=null!=(c=r$g(s)&&null!=(u=s.useSourceLayer)&&u?y:o.layer)?c:y,h=b$3(p);if(r$g(o.symbol)&&(!r$g(s)||!0!==s.ignoreGraphicSymbol)){const t="web-style"===o.symbol.type?await o.symbol.fetchSymbol(r$g(s)?s.abortOptions:null):o.symbol.clone();return v$7(t,null,h),t}const d=r$g(s)&&s.renderer||p&&"renderer"in p&&p.renderer;let m=d&&"getSymbolAsync"in d?await d.getSymbolAsync(o,s):null;if(!m)return;if(m="web-style"===m.type?await m.fetchSymbol(r$g(s)?s.abortOptions:null):m.clone(),!("visualVariables"in d)||!d.visualVariables||!d.visualVariables.length)return v$7(m,null,h),m;if("arcadeRequiredForVisualVariables"in d&&d.arcadeRequiredForVisualVariables&&(t$f(s)||t$f(s.arcade))){const e={...e$f(s)};e.arcade=await a$f(),s=e;}const f=await import('./visualVariableUtils-86a9e524.js'),g=[],w=[],S=[],v=[];for(const e of d.visualVariables)switch(e.type){case"color":g.push(e);break;case"opacity":w.push(e);break;case"rotation":v.push(e);break;case"size":e.target||S.push(e);}const V=!!g.length&&g[g.length-1],x=V?f.getColor(V,o,s):null,R=!!w.length&&w[w.length-1];let C=R?f.getOpacity(R,o,s):null;if(null!=h&&(C=null!=C?C*h:h),v$7(m,x,C),S.length){const e=f.getAllSizes(S,o,s);await M$4(m,e);}for(const e of v)q$3(m,f.getRotationAngle(e,o,s),e.axis);return m}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
const t$a=s$l("mac")?"Meta":"Ctrl",o$a={8:"Backspace",9:"Tab",13:"Enter",27:"Escape",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete"};for(let s=48;s<58;s++)o$a[s]=String.fromCharCode(s);for(let s=1;s<25;s++)o$a[111+s]=`F${s}`;for(let s=65;s<91;s++)o$a[s]=[String.fromCharCode(s+32),String.fromCharCode(s)];function a$c(e){if(void 0!==e.key)return i$h(e);const t=o$a[e.keyCode];return Array.isArray(t)?e.shiftKey?t[1]:t[0]:t}function n$k(r){switch(r){case"Ctrl":case"Alt":case"Shift":case"Meta":case"Primary":return !0}return !1}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
class e$6{constructor(e,t=[]){this.eventType=e,this.keyModifiers=t;}matches(e){if(e.type!==this.eventType)return !1;if(0===this.keyModifiers.length)return !0;const t=e.modifiers;for(const i of this.keyModifiers)if(!t.has(i))return !1;return !0}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
const n$j=n$t.getLogger("esri.views.input.InputHandler");class i$b{constructor(e){this._manager=null,this._incoming={},this._outgoing={},this._incomingEventMatches=null,this._incomingEventTypes=null,this._outgoingEventTypes=null,this._hasSideEffects=e;}get incomingEventMatches(){if(!this._incomingEventMatches){this._incomingEventMatches=[];for(const e in this._incoming){const t=this._incoming[e];for(const e of t)this._incomingEventMatches.push(e.match);}}return this._incomingEventMatches}get incomingEventTypes(){return this._incomingEventTypes||(this._incomingEventTypes=this.incomingEventMatches.map((e=>e.eventType))),this._incomingEventTypes}get outgoingEventTypes(){return this._outgoingEventTypes||(this._outgoingEventTypes=Object.keys(this._outgoing)),this._outgoingEventTypes}get hasSideEffects(){return this._hasSideEffects}get hasPendingInputs(){return !1}onInstall(e){this._manager?n$j.error("This InputHandler has already been registered with an InputManager"):(e.setEventCallback((e=>this._handleEvent(e))),e.setUninstallCallback((()=>this._onUninstall())),this._manager=e);}onUninstall(){}registerIncoming(e,n,i){let a;"function"==typeof n?(i=n,a=[]):a=n||[];const o="string"==typeof e?new e$6(e,a):e,h=()=>{this._incomingEventTypes=null,this._incomingEventMatches=null;},r=e=>{const t=this._incoming[e.match.eventType];if(t){const n=t.indexOf(e);t.splice(n,1),h(),this._manager&&this._manager.updateDependencies();}},g=new s$e(o,i,{onPause:r,onRemove:r,onResume:e=>{const t=this._incoming[e.match.eventType];t&&-1===t.indexOf(e)&&(t.push(e),h(),this._manager&&this._manager.updateDependencies());}});let c=this._incoming[o.eventType];return c||(c=[],this._incoming[o.eventType]=c),c.push(g),h(),this._manager&&this._manager.updateDependencies(),g}registerOutgoing(e){if(this._outgoing[e])throw Error("There is already a callback registered for this outgoing InputEvent: "+e);const t=new a$b(e,{onEmit:(e,t,n,i)=>{this._manager.emit(e.eventType,t,n,i);},onRemove:e=>{delete this._outgoing[e.eventType],this._manager.updateDependencies();}});return this._outgoing[e]=t,this._outgoingEventTypes=null,this._manager&&this._manager.updateDependencies(),t}startCapturingPointer(e){this._manager.setPointerCapture(e,!0);}stopCapturingPointer(e){this._manager.setPointerCapture(e,!1);}refreshHasPendingInputs(){this._manager.refreshHasPendingInputs();}_onUninstall(){this._manager?(this.onUninstall(),this._manager=null):n$j.error("This InputHandler is not registered with an InputManager");}_handleEvent(e){const t=this._incoming[e.type];if(t)for(const n of t)if(n.match.matches(e)&&(n.callback(e),e.shouldStopPropagation()))break}}class s$e{constructor(e,t,n){this.match=e,this._callback=t,this._handler=n;}pause(){this._handler.onPause(this);}resume(){this._handler.onResume(this);}remove(){this._handler.onRemove(this);}get callback(){return this._callback}}class a$b{constructor(e,t){this.eventType=e,this._removed=!1,this._handler=t;}emit(e,t,n){this._removed||this._handler.onEmit(this,e,t,n);}remove(){this._removed=!0,this._handler.onRemove(this);}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
class t$9 extends i$b{constructor(e){super(!0),this._onChange=e,this._value="mouse",this.registerIncoming("pointer-down",(e=>{const t="touch"===e.data.native.pointerType;this._setValue(t?"touch":"mouse");})),this._moveHandler=this.registerIncoming("pointer-move",(e=>{const t="touch"===e.data.native.pointerType;this._setValue(t?"touch":"mouse");})),this._moveHandler.pause();}_setValue(e){e!==this._value&&("touch"===e?this._moveHandler.resume():this._moveHandler.pause(),this._value=e,this._onChange(e));}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
const h$8=n$t.getLogger("esri.views.input.InputManager");let d$8=class extends p$q{constructor(e){super(e),this._pointerCaptures=new Map,this._nameToGroup={},this._handlers=[],this._currentPropagation=null,this._updateDependenciesAfterPropagation=!1,this._sourceEvents=new Set,this._keyModifiers=new Set,this._activeKeyModifiers=new Set,this._stoppedPropagationEventIds=new Set,this.primaryKey=t$a,this.latestPointerType="mouse",this.test={timestamp:void 0,hasCurrentPropagation:()=>!!this._currentPropagation};}initialize(){this.eventSource.onEventReceived=this._onEventReceived.bind(this),this._installRecognizers();}destroy(){const e=Object.keys(this._nameToGroup);for(const t of e)this.uninstallHandlers(t);this.eventSource=null,this._currentPropagation=null;}get hasPendingInputs(){return this._handlers.some((e=>e.handler.hasPendingInputs))}installHandlers(e,t,r=u$b.INTERNAL){if(this._nameToGroup[e])return void h$8.error("There is already an InputHandler group registered under the name `"+e+"`");if(0===t.length)return void h$8.error("Can't register a group of zero handlers");const i={name:e,handlers:t.map((e=>({handler:e,active:!0,removed:!1,priorityIndex:0,groupPriority:r,eventCallback:null,uninstallCallback:null})))};this._nameToGroup[e]=i;for(let n=i.handlers.length-1;n>=0;n--){const e=i.handlers[n];this._handlers.push(e),e.handler.onInstall({updateDependencies:()=>{this.updateDependencies();},emit:(t,r,i,n,s)=>{this._emitInputEvent(e.priorityIndex+1,t,r,i,s,n);},setPointerCapture:(t,r)=>{this._setPointerCapture(i,e,t,r);},setEventCallback:t=>{e.eventCallback=t;},setUninstallCallback:t=>{e.uninstallCallback=t;},refreshHasPendingInputs:()=>{this.notifyChange("hasPendingInputs");}});}this.updateDependencies();}uninstallHandlers(e){const t=this._nameToGroup[e];t?(t.handlers.forEach((e=>{e.removed=!0,e.uninstallCallback();})),delete this._nameToGroup[e],this._currentPropagation?this._currentPropagation.needsHandlerGarbageCollect=!0:this._garbageCollectRemovedHandlers()):h$8.error("There is no InputHandler group registered under the name `"+e+"`");}hasHandlers(e){return void 0!==this._nameToGroup[e]}updateDependencies(){if(this._currentPropagation)return void(this._updateDependenciesAfterPropagation=!0);this._updateDependenciesAfterPropagation=!1;const e=new Set,t=new Set;this._handlersPriority=[];for(let r=this._handlers.length-1;r>=0;r--){const e=this._handlers[r];e.priorityIndex=r,this._handlersPriority.push(e);}this._handlersPriority=this._sortHandlersPriority(this._handlersPriority);for(let r=this._handlersPriority.length-1;r>=0;r--){const i=this._handlersPriority[r];i.priorityIndex=r;let n=i.handler.hasSideEffects;if(!n)for(const t of i.handler.outgoingEventTypes)if(e.has(t)){n=!0;break}if(n)for(const r of i.handler.incomingEventMatches){e.add(r.eventType);for(const e of r.keyModifiers)n$k(e)||t.add(e);}i.active=n;}this._sourceEvents=e,this._keyModifiers=t,this._pointerCaptures.size>0&&this._sourceEvents.add("pointer-capture-lost"),this._keyModifiers.size>0&&(this._sourceEvents.add("key-down"),this._sourceEvents.add("key-up")),this.eventSource&&(this.eventSource.activeEvents=this._sourceEvents);}_setLatestPointerType(e){this._set("latestPointerType",e);}_onEventReceived(e,t){if("pointer-capture-lost"===e){const e=t;this._pointerCaptures.delete(e.native.pointerId);}this._updateKeyModifiers(e,t);const r=null!=this.test.timestamp?this.test.timestamp:t.native?t.native.timestamp:void 0,i=t.native?t.native.cancelable:void 0;this._emitInputEventFromSource(e,t,r,i);}_updateKeyModifiers(e,t){if(!t)return;let r=!1;const i=()=>{if(!r){const e=new Set;this._activeKeyModifiers.forEach((t=>{e.add(t);})),this._activeKeyModifiers=e,r=!0;}},n=(e,t)=>{t&&!this._activeKeyModifiers.has(e)?(i(),this._activeKeyModifiers.add(e)):!t&&this._activeKeyModifiers.has(e)&&(i(),this._activeKeyModifiers.delete(e));};if("key-down"===e||"key-up"===e){const r=t.key;this._keyModifiers.has(r)&&n(r,"key-down"===e);}const s=t.native;n("Alt",!(!s||!s.altKey)),n("Ctrl",!(!s||!s.ctrlKey)),n("Shift",!(!s||!s.shiftKey)),n("Meta",!(!s||!s.metaKey)),n("Primary",this._activeKeyModifiers.has(this.primaryKey));}_installRecognizers(){this._latestPointerTypeHandler=new t$9((e=>this._setLatestPointerType(e))),this.recognizers.length>0&&this.installHandlers("default",this.recognizers,u$b.INTERNAL),this.installHandlers("input-manager-logic",[this._latestPointerTypeHandler],u$b.INTERNAL);}_setPointerCapture(e,t,r,i){const n=e.name+"-"+t.priorityIndex,s=this._pointerCaptures.get(r.pointerId)||new Set;this._pointerCaptures.set(r.pointerId,s),i?(s.add(n),1===s.size&&this.eventSource&&this.eventSource.setPointerCapture(r,!0)):s.has(n)&&(s.delete(n),0===s.size&&(this._pointerCaptures.delete(r.pointerId),this.eventSource&&this.eventSource.setPointerCapture(r,!1)));}_garbageCollectRemovedHandlers(){this._handlers=this._handlers.filter((e=>!e.removed)),this.updateDependencies();}_emitInputEventFromSource(e,t,r,i){this._emitInputEvent(0,e,t,r,i);}_emitInputEvent(e,t,r,i,n,s){const o=void 0!==i?i:this._currentPropagation?this._currentPropagation.timestamp:performance.now(),a=void 0!==n&&n,p={event:new l$b(t,r,o,s||this._activeKeyModifiers,a),priorityIndex:e};this._currentPropagation?this._currentPropagation.events.push(p):this._doNewPropagation(p);}_doNewPropagation(e){this._currentPropagation={events:new e$g,currentHandler:null,needsHandlerGarbageCollect:!1,timestamp:e.event.timestamp},this._currentPropagation.events.push(e),this._continuePropagation();}_continuePropagation(){const e=this._currentPropagation;if(e){for(;this._currentPropagation.events.length>0;){const{event:t,priorityIndex:r}=this._currentPropagation.events.pop(),i=t.data&&t.data.eventId;if(!(null!=i&&this._stoppedPropagationEventIds.has(i)))for(e.currentHandler=this._handlersPriority[r];e.currentHandler;){if(e.currentHandler.removed)e.needsHandlerGarbageCollect=!0;else {if(e.currentHandler.active&&!t.shouldStopPropagation()&&e.currentHandler.eventCallback(t),t.shouldStopPropagation()){null!=i&&this._stoppedPropagationEventIds.add(i);break}if(t.shouldPausePropagation((()=>this._continuePropagation())))return void this._pausePropagation({event:t,priorityIndex:e.currentHandler.priorityIndex+1})}e.currentHandler=this._handlersPriority[e.currentHandler.priorityIndex+1];}}e.needsHandlerGarbageCollect&&this._garbageCollectRemovedHandlers(),this.hasPendingInputs||this._stoppedPropagationEventIds.clear(),this._currentPropagation=null,this._updateDependenciesAfterPropagation&&this.updateDependencies();}}_pausePropagation(e){const t=new e$g;for(t.push(e);this._currentPropagation.events.length;)t.push(this._currentPropagation.events.pop());this._currentPropagation.events=t,this._currentPropagation.currentHandler=null;}_compareHandlerPriority(e,t){if(e.handler.hasSideEffects!==t.handler.hasSideEffects)return e.handler.hasSideEffects?1:-1;if(e.groupPriority!==t.groupPriority)return e.groupPriority>t.groupPriority?-1:1;for(const r of e.handler.incomingEventMatches)for(const e of t.handler.incomingEventMatches){if(r.eventType!==e.eventType)continue;const t=r.keyModifiers.filter((t=>-1!==e.keyModifiers.indexOf(t)));if(t.length===r.keyModifiers.length!==(t.length===e.keyModifiers.length))return r.keyModifiers.length>e.keyModifiers.length?-1:1}return e.priorityIndex>t.priorityIndex?-1:1}_sortHandlersPriority(e){const t=[];for(const r of e){let e=0;for(;e<t.length&&this._compareHandlerPriority(r,t[e])>=0;)e++;t.splice(e,0,r);}return t}get debug(){const e=e=>{const t=this._setPointerCapture;this._setPointerCapture=()=>{},e(),this._setPointerCapture=t;};return {injectEvent:(t,r)=>{e((()=>{this._onEventReceived(t,r);}));},disablePointerCapture:e}}};e$c([y$c({readOnly:!0})],d$8.prototype,"hasPendingInputs",null),e$c([y$c()],d$8.prototype,"eventSource",void 0),e$c([y$c()],d$8.prototype,"recognizers",void 0),e$c([y$c({readOnly:!0})],d$8.prototype,"latestPointerType",void 0),d$8=e$c([n$s("esri.views.input.InputManager")],d$8);class l$b{constructor(e,t,r,i,n){this.type=e,this.data=t,this.timestamp=r,this.modifiers=i,this.cancelable=n,this._propagationState=0,this._resumeCallback=null;}stopPropagation(){this._propagationState|=1;}shouldStopPropagation(){return 0!=(1&this._propagationState)}async(e){this._propagationState|=2;const t=(e,t)=>{this._propagationState&=-3;const r=this._resumeCallback;if(this._resumeCallback=null,r&&r(),t)throw e;return e};return ("function"==typeof e?e():e).then((e=>t(e,!1)),(e=>t(e,!0)))}shouldPausePropagation(e){return !!(2&this._propagationState)&&(this._resumeCallback=e,!0)}preventDefault(){this.data.native.preventDefault();}}const u$b={DEFAULT:0,TOOL:-1,WIDGET:-2,INTERNAL:-3};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
function e$5(n){return n&&"function"==typeof n.highlight}function t$8(n){return n&&"function"==typeof n.maskOccludee}function c$g(e,t,c){return t$f(e)||e>c&&(0===t||e<t)}function o$9(n){let{minScale:e,maxScale:t}=n;return e=e||0,t=t||0,{minScale:e,maxScale:t}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
const s$d={iconZoom:"esri-icon-zoom-in-magnifying-glass",iconTrash:"esri-icon-trash",iconBrowseClusteredFeatures:"esri-icon-table"},o$8=new c$y({id:"zoom-to-feature",title:"{messages.zoom}",className:s$d.iconZoom}),t$7=new c$y({id:"remove-selected-feature",title:"{messages.remove}",className:s$d.iconTrash}),r$c=new c$y({id:"zoom-to-clustered-features",title:"{messages.zoom}",className:s$d.iconZoom}),i$a=new c$y({id:"browse-clustered-features",title:"{messages.browseClusteredFeatures}",className:s$d.iconBrowseClusteredFeatures});

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
const a$a="esri.widgets.Popup.PopupViewModel",s$c=n$t.getLogger(a$a),c$f=function(t){const{event:a,view:s}=t,{action:c}=a,u=s&&s.popup;if(!c)return Promise.reject(new s$j("trigger-action:missing-arguments","Event has no action"));if(!u)return Promise.reject(new s$j("trigger-action:missing-arguments","view.popup is missing"));const{disabled:d,id:w}=c;if(!w)return Promise.reject(new s$j("trigger-action:invalid-action","action.id is missing"));if(d)return Promise.reject(new s$j("trigger-action:invalid-action","Action is disabled"));if(w===o$8.id)return l$a(u.viewModel);if(w===r$c.id)return g$9(u.viewModel);if(w===i$a.id)return u.featureMenuOpen=!u.featureMenuOpen,u.viewModel.browseClusterEnabled=!u.viewModel.browseClusterEnabled,Promise.resolve();if(u.viewModel.browseClusterEnabled=!1,w===t$7.id){u.close();const{selectedFeature:t}=u;if(!t)return Promise.reject(new s$j(`trigger-action:${t$7.id}`,"selectedFeature is required",{selectedFeature:t}));const{sourceLayer:r}=t;return r?r.remove(t):s.graphics.remove(t),Promise.resolve()}return Promise.resolve()};function u$a(e){const{selectedFeature:t,location:r,view:i}=e;if(!i)return null;if("3d"===i.type)return t||r;return e.get("selectedFeature.geometry")||r}function d$7(t,r){if("3d"!==(null==r?void 0:r.type)||!t||"esri.Graphic"!==t.declaredClass)return !0;const i=r.getViewForGraphic(t);if(i&&"whenGraphicBounds"in i){let r=!1;return i.whenGraphicBounds(t,{useViewElevation:!0}).then((e=>{r=!e||!e.boundingBox||e.boundingBox[0]===e.boundingBox[3]&&e.boundingBox[1]===e.boundingBox[4]&&e.boundingBox[2]===e.boundingBox[5];})).catch((()=>{const r=new s$j("zoom-to:invalid-graphic","Could not zoom to the location of the graphic.",{graphic:t});s$c.error(r);})),r}return !0}async function l$a(t){const{location:i,selectedFeature:o,view:n,zoomFactor:a}=t,c=u$a(t);if(!c){const t=new s$j("zoom-to:invalid-target-or-view","Cannot zoom to location without a target and view.",{target:c,view:n});return s$c.error(t),Promise.reject(t)}const l=n.scale/a,g=t.get("selectedFeature.geometry")||i,w=g&&"point"===g.type&&d$7(o,n);o$8.active=!0,o$8.disabled=!0,await t.view.goTo({target:c,scale:w?l:void 0}),o$8.active=!1,o$8.disabled=!1,t.zoomToLocation=null,w&&(t.location=g);}async function g$9(t){const{selectedFeature:r,view:o}=t;if("2d"!==(null==o?void 0:o.type)){const t=new s$j("zoomToCluster:invalid-view","View must be 2d MapView.",{view:o});throw s$c.error(t),t}if(!r.isAggregate){const t=new s$j("zoomToCluster:invalid-selectedFeature","Selected feature must represent an aggregate/cluster graphic.",{selectedFeature:r});throw s$c.error(t),t}const n=r.sourceLayer,a=await o.whenLayerView(n),c=a.createQuery();c.aggregateIds=[r.getObjectId()],r$c.active=!0,r$c.disabled=!0;const{extent:u}=await a.queryExtent(c);await o.goTo({target:u}),r$c.active=!1,r$c.disabled=!1;}async function w$1(t){const{selectedFeature:r,view:i}=t;if("2d"!==(null==i?void 0:i.type)){const t=new s$j("displayClusterExtent:invalid-view","View must be 2d MapView.",{view:i});throw s$c.error(t),t}if(!r.isAggregate){const t=new s$j("zoomToCluster:invalid-selectedFeature","Selected feature must represent an aggregate/cluster graphic.",{selectedFeature:r});throw s$c.error(t),t}const o=r.sourceLayer,n=await i.whenLayerView(o),a=n.createQuery();a.aggregateIds=[r.getObjectId()];const{extent:c}=await n.queryExtent(a);t.selectedClusterBoundaryFeature.geometry=c,i.graphics.add(t.selectedClusterBoundaryFeature);}async function v$3(t){const{selectedFeature:r,view:i}=t;if("2d"!==(null==i?void 0:i.type)){const t=new s$j("browseAggregateFeatures:invalid-view","View must be 2d MapView.",{view:i});throw s$c.error(t),t}if(!r.isAggregate){const t=new s$j("browseAggregateFeatures:invalid-selectedFeature","Selected feature must represent an aggregate/cluster graphic.",{selectedFeature:r});throw s$c.error(t),t}const n=r.sourceLayer,a=await i.whenLayerView(n),c=a.createQuery();c.aggregateIds=[r.getObjectId()],i$a.active=!0,i$a.disabled=!0;const{features:u}=await a.queryFeatures(c);i$a.active=!1,i$a.disabled=!1,i.popup.open({features:[r].concat(u),featureMenuOpen:!0});}function p$f(e){e.features=e.features.filter((e=>e.isAggregate));}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
const s$b=s=>{let t=class extends s{constructor(...o){super(...o),this.goToOverride=null,this.view=null;}callGoTo(o){const{view:r}=this;return this.goToOverride?this.goToOverride(r,o):r.goTo(o.target,o.options)}};return e$c([y$c()],t.prototype,"goToOverride",void 0),e$c([y$c()],t.prototype,"view",void 0),t=e$c([n$s("esri.widgets.support.GoTo")],t),t};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
const S$4=L$3.ofType({key:"type",defaultKeyValue:"button",base:c$z,typeMap:{button:c$y,toggle:a$i}}),B$3=()=>[o$8.clone()],R$1=()=>[r$c.clone(),i$a.clone()],G$1="esri.widgets.Popup.PopupViewModel",z$2=n$t.getLogger(G$1);let U$3=class extends(s$b(l$c)){constructor(e){super(e),this._handles=new u$g,this._pendingPromises=new Set,this._fetchFeaturesController=null,this._selectedClusterFeature=null,this.featurePage=null,this.actions=new S$4,this.defaultPopupTemplateEnabled=!1,this.autoCloseEnabled=!1,this.autoOpenEnabled=!0,this.browseClusterEnabled=!1,this.content=null,this.featuresPerPage=20,this.featureViewModels=[],this.highlightEnabled=!0,this.includeDefaultActions=!0,this.selectedClusterBoundaryFeature=new h$f({symbol:new S$9({outline:{width:1.5,color:"cyan"},style:"none"})}),this.title=null,this.updateLocationEnabled=!1,this.view=null,this.visible=!1,this.zoomFactor=4,this.zoomToLocation=null;}get isLoadingFeature(){return this.featureViewModels.some((e=>e.waitingForContent))}initialize(){this._handles.add([d$f(this,["autoOpenEnabled","view"],(()=>this._autoOpenEnabledChange())),this.on("view-change",(()=>this._autoClose())),h$h(this,["highlightEnabled","selectedFeature","visible","view"],(()=>this._highlightFeature())),h$h(this,"view.animation.state",(e=>this._animationStateChange(e))),h$h(this,"location",(e=>this._locationChange(e))),h$h(this,"selectedFeature",(e=>this._selectedFeatureChange(e))),h$h(this,["selectedFeatureIndex","featureCount","featuresPerPage"],(()=>this._selectedFeatureIndexChange())),h$h(this,["featurePage","selectedFeatureIndex","featureCount","featuresPerPage, featureViewModels"],(()=>this._setGraphicOnFeatureViewModels())),h$h(this,"featureViewModels",(()=>this._featureViewModelsChange())),this.on("trigger-action",(e=>c$f({event:e,view:this.view}))),O$5(this,"waitingForResult",(()=>this._waitingForResultChange()),!0),h$h(this,["features","view","view.map","view.spatialReference"],(()=>this._updateFeatureVMs())),h$h(this,["view.scale"],this._viewScaleChange),O$5(this,"visible",(()=>this.browseClusterEnabled=!1)),h$h(this,"browseClusterEnabled",(e=>e?this.enableClusterBrowsing():this.disableClusterBrowsing()))]);}destroy(){this._cancelFetchingFeatures(),this._handles.destroy(),this._handles=null,this._pendingPromises.clear(),this.browseClusterEnabled=!1,this.view=null;}get active(){return !(!this.visible||this.waitingForResult)}get allActions(){const e=this._get("allActions")||new S$4;e.removeAll();const{actions:t,defaultActions:s,defaultPopupTemplateEnabled:i,includeDefaultActions:o,selectedFeature:r}=this,n=o?s.concat(t):t,a=r&&("function"==typeof r.getEffectivePopupTemplate&&r.getEffectivePopupTemplate(i)||r.popupTemplate),l=a&&a.actions,u=a&&a.overwriteActions?l:l?l.concat(n):n;return u&&u.filter(Boolean).forEach((t=>e.add(t))),e}get defaultActions(){var e;const t=this._get("defaultActions")||new S$4;return t.removeAll(),t.addMany(null!=(e=this.selectedFeature)&&e.isAggregate?R$1():B$3()),t}get featureCount(){return this.features.length}get features(){return this._get("features")||[]}set features(e){const t=e||[];this._set("features",t);const{pendingPromisesCount:s,promiseCount:i,selectedFeatureIndex:o}=this,r=i&&t.length;r&&s&&-1===o?this.selectedFeatureIndex=0:r&&-1!==o||(this.selectedFeatureIndex=t.length?0:-1);}get location(){return this._get("location")||null}set location(e){const t=this.get("view.spatialReference.isWebMercator");e&&e.get("spatialReference.isWGS84")&&t&&(e=d$i(e)),this._set("location",e);}get pendingPromisesCount(){return this._pendingPromises.size}get waitingForResult(){return !(!(!!this._fetchFeaturesController||this.pendingPromisesCount>0)||0!==this.featureCount)}get promiseCount(){return this.promises.length}get promises(){return this._get("promises")||[]}set promises(e){if(this._pendingPromises.clear(),this.features=[],!Array.isArray(e)||!e.length)return this._set("promises",[]),void this.notifyChange("pendingPromisesCount");this._set("promises",e),(e=e.slice(0)).forEach((e=>{this._pendingPromises.add(e);const t=t=>{this._pendingPromises.has(e)&&this._updateFeatures(t),this._updatePendingPromises(e);},s=()=>this._updatePendingPromises(e);e.then(t,s);})),this.notifyChange("pendingPromisesCount");}get selectedFeature(){const{features:e,selectedFeatureIndex:t}=this;if(-1===t)return null;return e[t]||null}get selectedFeatureIndex(){const e=this._get("selectedFeatureIndex");return "number"==typeof e?e:-1}set selectedFeatureIndex(e){const{featureCount:t}=this;e=isNaN(e)||e<-1||!t?-1:(e+t)%t,this._set("selectedFeatureIndex",e);}get selectedFeatureViewModel(){return this.featureViewModels[this.selectedFeatureIndex]||null}get state(){return this.get("view.ready")?"ready":"disabled"}centerAtLocation(){const{view:e}=this,t=u$a(this);if(!t){const s=new s$j("center-at-location:invalid-target-or-view","Cannot center at a location without a target and view.",{target:t,view:e});return z$2.error(s),Promise.reject(s)}return this.callGoTo({target:{target:t,scale:e.scale}})}clear(){this.set({promises:[],features:[],content:null,title:null,location:null});}fetchFeatures(e,t){const{view:s}=this;if(!s||!e){const t=new s$j("fetch-features:invalid-screenpoint-or-view","Cannot fetch features without a screenPoint and view.",{screenPoint:e,view:s});return z$2.error(t),Promise.reject(t)}return s.fetchPopupFeatures(e,{event:t&&t.event,defaultPopupTemplateEnabled:this.defaultPopupTemplateEnabled,signal:t&&t.signal})}open(e){const t={updateLocationEnabled:!1,promises:[],fetchFeatures:!1,...e,visible:!0},{fetchFeatures:s}=t;delete t.fetchFeatures,s&&this._setFetchFeaturesPromises(t.location),this.set(t);}triggerAction(e){const t=this.allActions.getItemAt(e);t&&!t.disabled&&this.emit("trigger-action",{action:t});}next(){return this.selectedFeatureIndex=this.selectedFeatureIndex+1,this}previous(){return this.selectedFeatureIndex=this.selectedFeatureIndex-1,this}disableClusterBrowsing(){p$f(this),this._clearBrowsedClusterGraphics();}async enableClusterBrowsing(){await w$1(this),await v$3(this);}_animationStateChange(e){this.zoomToLocation||(o$8.disabled="waiting-for-target"===e);}_clearBrowsedClusterGraphics(){var e;const t=null==(e=this.view)?void 0:e.graphics;t&&(t.remove(this.selectedClusterBoundaryFeature),t.remove(this._selectedClusterFeature)),this._selectedClusterFeature=null,this.selectedClusterBoundaryFeature.geometry=null;}_viewScaleChange(){var e;(null!=(e=this.selectedFeature)&&e.isAggregate||this.browseClusterEnabled)&&(this.browseClusterEnabled=!1,this.visible=!1);}_locationChange(e){const{selectedFeature:t,updateLocationEnabled:s}=this;s&&e&&(!t||t.geometry)&&this.centerAtLocation();}_selectedFeatureIndexChange(){this.featurePage=this.featureCount>1?Math.floor(this.selectedFeatureIndex/this.featuresPerPage)+1:null;}_featureViewModelsChange(){this.featurePage=this.featureCount>1?1:null;}_setGraphicOnFeatureViewModels(){const{features:e,featureCount:t,featurePage:s,featuresPerPage:i,featureViewModels:o}=this;if(null===s)return;const r=((s-1)*i+t)%t,n=r+i;o.slice(r,n).forEach(((t,s)=>{t&&!t.graphic&&(t.graphic=e[r+s]);}));}async _selectedFeatureChange(e){if(!e)return;const{location:t,updateLocationEnabled:s,view:i}=this;if(this.browseClusterEnabled){if(this._selectedClusterFeature&&(i.graphics.remove(this._selectedClusterFeature),this._selectedClusterFeature=null),e.isAggregate)return;return e.symbol=await d$9(e),this._selectedClusterFeature=e,void i.graphics.add(this._selectedClusterFeature)}!s&&t||!e.geometry?s&&!e.geometry&&this.centerAtLocation().then((()=>{this.location=i.center.clone();})):this.location=e$f(this._getPointFromGeometry(e.geometry));}_waitingForResultChange(){!this.featureCount&&this.promises&&(this.visible=!1);}_setFetchFeaturesPromises(e){return this._fetchFeaturesWithController(this._getScreenPoint(e||this.location)).then((e=>{const{clientOnlyGraphics:t,promisesPerLayerView:s}=e,i=Promise.resolve(t),o=s.map((e=>e.promise));this.promises=[i,...o];}))}_destroyFeatureVMs(){this.featureViewModels.forEach((e=>e&&!e.destroyed&&e.destroy())),this._set("featureViewModels",[]);}_updateFeatureVMs(){const{selectedFeature:e,features:t,featureViewModels:s}=this;if(null!=e&&e.isAggregate||(this.browseClusterEnabled=!1),this._destroyFeatureVMs(),!t||!t.length)return;const i=s.slice(0),o=[];t.forEach(((t,s)=>{if(!t)return;let r=null;if(i.some(((e,s)=>(e&&e.graphic===t&&(r=e,i.splice(s,1)),!!r))),r)o[s]=r;else {var n,a;const i=new S$5({defaultPopupTemplateEnabled:this.defaultPopupTemplateEnabled,spatialReference:null==(n=this.view)?void 0:n.spatialReference,graphic:t===e?t:null,map:null==(a=this.view)?void 0:a.map,view:this.view});o[s]=i;}})),i.forEach((e=>e&&!e.destroyed&&e.destroy())),this._set("featureViewModels",o);}_getScreenPoint(e){const{view:t}=this;return t&&e&&"function"==typeof t.toScreen?t.toScreen(e):null}_autoOpenEnabledChange(){const e="auto-fetch-features",{_handles:t,autoOpenEnabled:s}=this;if(t.remove(e),s&&this.view){const s=this.view.on("click",(e=>{"mouse"===e.pointerType&&0!==e.button||this._fetchFeaturesAndOpen(e);}),u$b.WIDGET);t.add(s,e);}}_cancelFetchingFeatures(){const e=this._fetchFeaturesController;e&&e.abort(),this._fetchFeaturesController=null,this.notifyChange("waitingForResult");}_fetchFeaturesWithController(e,t){this._cancelFetchingFeatures();const s=h$g(),{signal:i}=s;this._fetchFeaturesController=s,this.notifyChange("waitingForResult");const o=this.fetchFeatures(e,{signal:i,event:t});return o.catch((()=>{})).then((()=>{this._fetchFeaturesController=null,this.notifyChange("waitingForResult");})),o}_fetchFeaturesAndOpen(e){const{screenPoint:t,mapPoint:s}=e,{view:i}=this;this._fetchFeaturesWithController(t,e).then((e=>{const{clientOnlyGraphics:t,promisesPerLayerView:o,location:r}=e,n=[Promise.resolve(t),...o.map((e=>e.promise))];return i.popup.open({location:r||s,promises:n}),e}));}_updatePendingPromises(e){e&&this._pendingPromises.has(e)&&(this._pendingPromises.delete(e),this.notifyChange("pendingPromisesCount"));}_autoClose(){this.autoCloseEnabled&&(this.visible=!1);}_getPointFromGeometry(e){return t$f(e)?null:"point"===e.type?e:"extent"===e.type?e.center:"polygon"===e.type?e.centroid:"multipoint"===e.type||"polyline"===e.type?e.extent.center:null}async _getLayerView(e,t){return await e.when(),e.whenLayerView(t)}async _highlightFeature(){const e="highlight";this._handles.remove(e);const{selectedFeature:t,highlightEnabled:s,view:i,visible:o}=this;if(!(t&&i&&s&&o))return;let{layer:r,sourceLayer:n}=t;if("map-notes"!==(null==n?void 0:n.type)&&"subtype-group"!==(null==n?void 0:n.type)||(r=n),!(r&&r instanceof b$a))return;const a=this._getLayerView(i,r);this._highlightPromise=a;const l=await a;if(!(l&&e$5(l)&&this._highlightPromise===a&&this.selectedFeature&&this.highlightEnabled&&this.visible))return;const u="objectIdField"in r&&r.objectIdField,h=t.attributes,c=h&&u&&h[u],p=l.highlight(c||t);this._handles.add(p,e);}_updateFeatures(e){const{features:t}=this;if(!e||!e.length)return;if(!t.length)return void(this.features=e);const s=e.filter((e=>-1===t.indexOf(e)));this.features=t.concat(s);}};e$c([y$c()],U$3.prototype,"featurePage",void 0),e$c([y$c()],U$3.prototype,"isLoadingFeature",null),e$c([y$c({type:S$4})],U$3.prototype,"actions",void 0),e$c([y$c({readOnly:!0})],U$3.prototype,"active",null),e$c([y$c({readOnly:!0})],U$3.prototype,"allActions",null),e$c([y$c({type:Boolean})],U$3.prototype,"defaultPopupTemplateEnabled",void 0),e$c([y$c()],U$3.prototype,"autoCloseEnabled",void 0),e$c([y$c()],U$3.prototype,"autoOpenEnabled",void 0),e$c([y$c()],U$3.prototype,"browseClusterEnabled",void 0),e$c([y$c()],U$3.prototype,"content",void 0),e$c([y$c({type:S$4,readOnly:!0})],U$3.prototype,"defaultActions",null),e$c([y$c({readOnly:!0})],U$3.prototype,"featureCount",null),e$c([y$c()],U$3.prototype,"features",null),e$c([y$c()],U$3.prototype,"featuresPerPage",void 0),e$c([y$c({readOnly:!0})],U$3.prototype,"featureViewModels",void 0),e$c([y$c()],U$3.prototype,"highlightEnabled",void 0),e$c([y$c()],U$3.prototype,"includeDefaultActions",void 0),e$c([y$c({type:b$b})],U$3.prototype,"location",null),e$c([y$c({readOnly:!0})],U$3.prototype,"pendingPromisesCount",null),e$c([y$c({readOnly:!0})],U$3.prototype,"selectedClusterBoundaryFeature",void 0),e$c([y$c({readOnly:!0})],U$3.prototype,"waitingForResult",null),e$c([y$c({readOnly:!0})],U$3.prototype,"promiseCount",null),e$c([y$c()],U$3.prototype,"promises",null),e$c([y$c({value:null,readOnly:!0})],U$3.prototype,"selectedFeature",null),e$c([y$c({value:-1})],U$3.prototype,"selectedFeatureIndex",null),e$c([y$c({readOnly:!0})],U$3.prototype,"selectedFeatureViewModel",null),e$c([y$c({readOnly:!0})],U$3.prototype,"state",null),e$c([y$c()],U$3.prototype,"title",void 0),e$c([y$c()],U$3.prototype,"updateLocationEnabled",void 0),e$c([y$c()],U$3.prototype,"view",void 0),e$c([y$c()],U$3.prototype,"visible",void 0),e$c([y$c()],U$3.prototype,"zoomFactor",void 0),e$c([y$c()],U$3.prototype,"zoomToLocation",void 0),e$c([y$c()],U$3.prototype,"centerAtLocation",null),U$3=e$c([n$s(G$1)],U$3);var W$3=U$3;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
const O$1="selected-index",N=0,B$2="popup-spinner",T$1={iconLeftTriangleArrow:"esri-icon-left-triangle-arrow",iconRightTriangleArrow:"esri-icon-right-triangle-arrow",iconDockToTop:"esri-icon-maximize",iconDockToBottom:"esri-icon-dock-bottom",iconDockToLeft:"esri-icon-dock-left",iconDockToRight:"esri-icon-dock-right",iconClose:"esri-icon-close",iconUndock:"esri-icon-minimize",iconCheckMark:"esri-icon-check-mark",iconLoading:"esri-icon-loading-indicator",iconDefaultAction:"esri-icon-default-action",iconActionsMenu:"esri-icon-handle-horizontal",rotating:"esri-rotating",base:"esri-popup",widget:"esri-widget",main:"esri-popup__main-container",loadingContainer:"esri-popup__loading-container",isCollapsible:"esri-popup--is-collapsible",isCollapsed:"esri-popup--is-collapsed",shadow:"esri-popup--shadow",isDocked:"esri-popup--is-docked",isDockedTopLeft:"esri-popup--is-docked-top-left",isDockedTopCenter:"esri-popup--is-docked-top-center",isDockedTopRight:"esri-popup--is-docked-top-right",isDockedBottomLeft:"esri-popup--is-docked-bottom-left",isDockedBottomCenter:"esri-popup--is-docked-bottom-center",isDockedBottomRight:"esri-popup--is-docked-bottom-right",alignTopCenter:"esri-popup--aligned-top-center",alignBottomCenter:"esri-popup--aligned-bottom-center",alignTopLeft:"esri-popup--aligned-top-left",alignBottomLeft:"esri-popup--aligned-bottom-left",alignTopRight:"esri-popup--aligned-top-right",alignBottomRight:"esri-popup--aligned-bottom-right",isFeatureMenuOpen:"esri-popup--feature-menu-open",isActionsMenuOpen:"esri-popup--actions-menu-open",hasFeatureUpdated:"esri-popup--feature-updated",header:"esri-popup__header",headerButtons:"esri-popup__header-buttons",headerContainer:"esri-popup__header-container",headerContainerButton:"esri-popup__header-container--button",headerTitle:"esri-popup__header-title",content:"esri-popup__content",footer:"esri-popup__footer",footerHasPagination:"esri-popup__footer--has-pagination",footerHasActions:"esri-popup__footer--has-actions",footerHasActionsMenu:"esri-popup__footer--has-actions-menu",button:"esri-popup__button",buttonDisabled:"esri-popup__button--disabled",buttonDock:"esri-popup__button--dock",icon:"esri-popup__icon",iconDock:"esri-popup__icon--dock-icon",inlineActionsContainer:"esri-popup__inline-actions-container",actionsMenuButton:"esri-popup__actions-menu-button",actions:"esri-popup__actions",action:"esri-popup__action",actionImage:"esri-popup__action-image",actionText:"esri-popup__action-text",actionToggle:"esri-popup__action-toggle",actionToggleOn:"esri-popup__action-toggle--on",pointer:"esri-popup__pointer",pointerDirection:"esri-popup__pointer-direction",navigation:"esri-popup__navigation",paginationPrevious:"esri-popup__pagination-previous",paginationNext:"esri-popup__pagination-next",paginationPreviousIconLTR:"esri-popup__pagination-previous-icon",paginationPreviousIconRTL:"esri-popup__pagination-previous-icon--rtl",paginationNextIconLTR:"esri-popup__pagination-next-icon",paginationNextIconRTL:"esri-popup__pagination-next-icon--rtl",featureMenu:"esri-popup__feature-menu",featureMenuList:"esri-popup__feature-menu-list",featureMenuItem:"esri-popup__feature-menu-item",featureMenuViewport:"esri-popup__feature-menu-viewport",featureMenuHeader:"esri-popup__feature-menu-header",featureMenuNote:"esri-popup__feature-menu-note",featureMenuSelected:"esri-popup__feature-menu-item--selected",featureMenuButton:"esri-popup__feature-menu-button",featureMenuTitle:"esri-popup__feature-menu-title",featureMenuObserver:"esri-popup__feature-menu-observer",featureMenuLoader:"esri-popup__feature-menu-loader",collapseButton:"esri-popup__collapse-button"},D$2={buttonEnabled:!0,position:"auto",breakpoint:{width:544}},E="esri-popup";function P$2(e,t){return void 0===t?`${E}__${e}`:`${E}__${e}-${t}`}const L$1="esri.widgets.Popup",S$3=n$t.getLogger(L$1),V$2={closeButton:!0,featureNavigation:!0};let R=class extends(c$k(x$2)){constructor(e,t){super(e,t),this._blurClose=!1,this._blurContainer=!1,this._containerNode=null,this._mainContainerNode=null,this._featureMenuNode=null,this._actionsMenuNode=null,this._focusClose=!1,this._focusContainer=!1,this._focusDockButton=!1,this._focusFeatureMenuButton=!1,this._focusActionsMenuButton=!1,this._focusFirstFeature=!1,this._focusFirstAction=!1,this._handles=new u$g,this._pointerOffsetInPx=16,this._spinner=null,this._feature=null,this._featureMenuIntersectionObserverCallback=([e])=>{null!=e&&e.isIntersecting&&this.viewModel.featurePage++;},this._featureMenuIntersectionObserver=new IntersectionObserver(this._featureMenuIntersectionObserverCallback),this._displaySpinnerThrottled=e$b((()=>this._displaySpinner()),N),this.actions=null,this.alignment="auto",this.autoCloseEnabled=null,this.autoOpenEnabled=null,this.defaultPopupTemplateEnabled=null,this.content=null,this.collapsed=!1,this.collapseEnabled=!0,this.dockEnabled=!1,this.featureCount=null,this.featureMenuOpen=!1,this.features=null,this.goToOverride=null,this.headingLevel=2,this.highlightEnabled=null,this.location=null,this.label=void 0,this.maxInlineActions=3,this.messages=null,this.messagesCommon=null,this.promises=null,this.selectedFeature=null,this.selectedFeatureIndex=null,this.spinnerEnabled=!0,this.title=null,this.updateLocationEnabled=null,this.view=null,this.viewModel=new W$3,this.visible=null,this.visibleElements={...V$2},this._addSelectedFeatureIndexHandle(),this.own([h$h(this,"viewModel.screenLocation",(()=>this._positionContainer())),h$h(this,["viewModel.active","dockEnabled"],(()=>this._toggleScreenLocationEnabled())),h$h(this,"viewModel.screenLocation",((e,t)=>{!!e!=!!t&&this.reposition();})),h$h(this,["viewModel.view.padding","viewModel.view.size","viewModel.active","viewModel.location","alignment"],(()=>this.reposition())),h$h(this,"spinnerEnabled",(e=>this._spinnerEnabledChange(e))),h$h(this,"viewModel.view.size",((e,t)=>this._updateDockEnabledForViewSize(e,t))),h$h(this,"viewModel.view",((e,t)=>this._viewChange(e,t))),h$h(this,"viewModel.view.ready",((e,t)=>this._viewReadyChange(e,t))),h$h(this,["viewModel.waitingForResult","viewModel.location"],(()=>{this._hideSpinner(),this._displaySpinnerThrottled();})),h$h(this,"selectedFeatureWidget.viewModel.title",(e=>this._setTitleFromFeatureWidget(e))),h$h(this,["selectedFeatureWidget.viewModel.content","selectedFeatureWidget.viewModel.waitingForContent"],(()=>this._setContentFromFeatureWidget())),O$5(this,"collapsed",(()=>{var e,t;"xsmall"===(null==(e=this.viewModel)||null==(t=e.view)?void 0:t.widthBreakpoint)&&this.viewModel.active&&this.collapseEnabled&&this.viewModel.centerAtLocation();})),C$4(this,"viewModel.allActions","change",(()=>this._watchActions())),d$f(this,"viewModel.allActions",(()=>this._watchActions())),h$h(this,"viewModel.featureViewModels",(()=>this._featureMenuViewportScrollTop()))]);}destroy(){var e,t;this._destroySelectedFeatureWidget(),this._destroySpinner(),null==(e=this._handles)||e.destroy(),this._unobserveFeatureMenuObserver(),null==(t=this._featureMenuIntersectionObserver)||t.disconnect(),this._handles=null;}get actionsMenuId(){return `${this.id}-actions-menu`}get actionsMenuButtonId(){return `${this.id}-actions-menu-button`}get featureMenuId(){return `${this.id}-feature-menu`}get titleId(){return `${this.id}-popup-title`}get contentId(){return `${this.id}-popup-content`}get hasContent(){var e,t,i,o,n;return !!(this.selectedFeatureWidget?(null==(e=this.selectedFeatureWidget)||null==(t=e.viewModel)?void 0:t.waitingForContent)||(null==(i=this.selectedFeatureWidget)||null==(o=i.viewModel)?void 0:o.content):null==(n=this.viewModel)?void 0:n.content)}get featureNavigationVisible(){return this.viewModel.active&&this.viewModel.featureCount>1&&this.visibleElements.featureNavigation}get collapsible(){return !!(this.collapseEnabled&&this.viewModel.title&&this.hasContent)}get featureMenuVisible(){return this.featureNavigationVisible&&this.featureMenuOpen}get contentCollapsed(){return this.collapsible&&!this.featureMenuVisible&&this.collapsed}get dividedActions(){return this._divideActions()}set actionsMenuOpen(e){this._set("actionsMenuOpen",!!e);}get actionsMenuOpen(){return !!this.viewModel.active&&this._get("actionsMenuOpen")}get currentAlignment(){return this._getCurrentAlignment()}get currentDockPosition(){return this._getCurrentDockPosition()}get dockOptions(){return this._get("dockOptions")||D$2}set dockOptions(e){const t={...D$2},i=this.get("viewModel.view.breakpoints"),o={};i&&(o.width=i.xsmall,o.height=i.xsmall);const n={...t,...e},s={...t.breakpoint,...o},{breakpoint:r}=n;!0===r?n.breakpoint=s:"object"==typeof r&&(n.breakpoint={...s,...r}),this._set("dockOptions",n),this._setCurrentDockPosition(),this.reposition();}get selectedFeatureWidget(){const{_feature:e,visibleElements:t,headingLevel:i}=this,{selectedFeatureViewModel:o}=this.viewModel,n={...t,title:!1};return o?(e?(e.viewModel=o,e.visibleElements=n):this._feature=new w$2({headingLevel:i+1,viewModel:o,visibleElements:n}),this._feature):null}castVisibleElements(e){return {...V$2,...e}}blur(){const{active:e}=this.viewModel;e||S$3.warn("Popup can only be blurred when currently active."),this.visibleElements.closeButton?this._blurClose=!0:this._blurContainer=!0,this.scheduleRender();}clear(){this.viewModel.clear();}close(){this.visible=!1;}fetchFeatures(e,t){return this.viewModel.fetchFeatures(e,t)}focus(){const{active:e}=this.viewModel;e||S$3.warn("Popup can only be focused when currently active."),this.visibleElements.closeButton?this._focusClose=!0:this._focusContainer=!0,this.scheduleRender();}next(){return this.viewModel.next()}open(e){var t,i;this._handles.remove(O$1);const o=!!e&&!!e.featureMenuOpen,n=!!e&&!!e.actionsMenuOpen,s={collapsed:!!e&&!!e.collapsed,actionsMenuOpen:n,featureMenuOpen:o};"xsmall"===(null==(t=this.viewModel)||null==(i=t.view)?void 0:i.widthBreakpoint)&&(s.collapsed=!0),this.set(s),this.viewModel.open(e),this._addSelectedFeatureIndexHandle();}previous(){return this.viewModel.previous()}reposition(){this.renderNow(),this._positionContainer(),this._setCurrentAlignment();}triggerAction(e){this.viewModel.triggerAction(e);}render(){var e,t,i,o;const{actionsMenuOpen:n,dockEnabled:s,featureMenuVisible:r,dividedActions:a,currentAlignment:l,currentDockPosition:u}=this,{active:c}=this.viewModel,{menuActions:d}=a,p=c&&d.length>1&&n,h=c&&s,g=c&&!s,_=null==(e=this.selectedFeature)||null==(t=e.layer)?void 0:t.title,f=null==(i=this.selectedFeature)||null==(o=i.layer)?void 0:o.id,v={[T$1.alignTopCenter]:"top-center"===l,[T$1.alignBottomCenter]:"bottom-center"===l,[T$1.alignTopLeft]:"top-left"===l,[T$1.alignBottomLeft]:"bottom-left"===l,[T$1.alignTopRight]:"top-right"===l,[T$1.alignBottomRight]:"bottom-right"===l,[T$1.isDocked]:h,[T$1.shadow]:g,[T$1.isDockedTopLeft]:"top-left"===u,[T$1.isDockedTopCenter]:"top-center"===u,[T$1.isDockedTopRight]:"top-right"===u,[T$1.isDockedBottomLeft]:"bottom-left"===u,[T$1.isDockedBottomCenter]:"bottom-center"===u,[T$1.isDockedBottomRight]:"bottom-right"===u,[T$1.isFeatureMenuOpen]:r,[T$1.isActionsMenuOpen]:p};return n$u("div",{class:this.classes(T$1.base,v),role:"presentation","data-layer-title":_,"data-layer-id":f,bind:this,afterCreate:this._positionContainer,afterUpdate:this._positionContainer},c?[this.renderMainContainer(),this.renderPointer()]:null)}renderLoadingIcon(){return n$u("span",{"aria-hidden":"true",class:this.classes(T$1.icon,T$1.iconLoading,T$1.rotating)})}renderNavigationLoading(){const{messagesCommon:e}=this;return this.viewModel.pendingPromisesCount?n$u("div",{key:P$2("loading-container"),role:"presentation",class:T$1.loadingContainer,"aria-label":e.loading,title:e.loading},this.renderLoadingIcon()):null}renderPreviousIcon(){const e=d$h(),t={[T$1.iconRightTriangleArrow]:e,[T$1.paginationPreviousIconRTL]:e,[T$1.iconLeftTriangleArrow]:!e,[T$1.paginationPreviousIconLTR]:!e};return n$u("span",{"aria-hidden":"true",class:this.classes(T$1.icon,t)})}renderPreviousButton(){const{messages:e}=this;return n$u("div",{role:"button",tabIndex:0,bind:this,onclick:this._previous,onkeydown:this._previous,class:this.classes(T$1.button,T$1.paginationPrevious),"aria-label":e.previous,title:e.previous},this.renderPreviousIcon())}renderNextIcon(){const e=d$h(),t={[T$1.iconLeftTriangleArrow]:e,[T$1.paginationNextIconRTL]:e,[T$1.iconRightTriangleArrow]:!e,[T$1.paginationNextIconLTR]:!e};return n$u("span",{"aria-hidden":"true",class:this.classes(T$1.icon,t)})}renderNextButton(){const{messages:e}=this;return n$u("div",{role:"button",tabIndex:0,bind:this,onclick:this._next,onkeydown:this._next,class:this.classes(T$1.button,T$1.paginationNext),"aria-label":e.next,title:e.next},this.renderNextIcon())}renderFeatureMenuButton(){const{featureMenuOpen:e,featureMenuId:t,messagesCommon:i}=this,{featureCount:o,selectedFeatureIndex:n}=this.viewModel;return n$u("div",{role:"button",tabIndex:0,bind:this,onclick:this._toggleFeatureMenu,onkeydown:this._toggleFeatureMenu,afterCreate:this._focusFeatureMenuButtonNode,afterUpdate:this._focusFeatureMenuButtonNode,class:this.classes(T$1.button,T$1.featureMenuButton),"aria-haspopup":"true","aria-controls":t,"aria-expanded":e.toString(),"aria-label":i.menu,title:i.menu},this._getPageText(o,n))}renderNavigationButtons(){return this.featureNavigationVisible?[this.renderPreviousButton(),this.renderNavigationLoading()||this.renderFeatureMenuButton(),this.renderNextButton()]:null}renderDockIcon(){const{dockEnabled:e}=this,t=this._wouldDockTo(),i={[T$1.iconUndock]:e,[T$1.iconDock]:!e,[T$1.iconDockToRight]:!e&&("top-right"===t||"bottom-right"===t),[T$1.iconDockToLeft]:!e&&("top-left"===t||"bottom-left"===t),[T$1.iconDockToTop]:!e&&"top-center"===t,[T$1.iconDockToBottom]:!e&&"bottom-center"===t};return n$u("span",{"aria-hidden":"true",class:this.classes(i,T$1.icon)})}renderDockButton(){var e,t,i;const{dockEnabled:o,messages:n}=this,s=null==(e=this.viewModel)||null==(t=e.view)?void 0:t.widthBreakpoint,r=o?n.undock:n.dock;return "xsmall"!==s&&null!=(i=this.dockOptions)&&i.buttonEnabled?n$u("div",{role:"button","aria-label":r,title:r,tabIndex:0,bind:this,onclick:this._toggleDockEnabled,onkeydown:this._toggleDockEnabled,afterCreate:this._focusDockButtonNode,afterUpdate:this._focusDockButtonNode,class:this.classes(T$1.button,T$1.buttonDock)},this.renderDockIcon()):null}renderTitle(){const{title:e}=this.viewModel,{titleId:t,collapsible:i,contentCollapsed:o,messagesCommon:n}=this,s={[T$1.headerContainerButton]:i},r=n$u(s$h,{level:this.headingLevel,class:T$1.headerTitle,innerHTML:e}),a=i?n$u("button",{key:`${e}--collapsible`,id:t,title:o?n.expand:n.collapse,bind:this,enterAnimation:this._createFeatureUpdatedAnimation(),class:this.classes(T$1.headerContainer,s),"aria-expanded":o?"false":"true",onclick:this._toggleCollapsed},r):n$u("div",{key:e,id:t,bind:this,enterAnimation:this._createFeatureUpdatedAnimation(),class:this.classes(T$1.headerContainer,s)},r);return e?a:null}renderCloseIcon(){return n$u("span",{"aria-hidden":"true",class:this.classes(T$1.icon,T$1.iconClose)})}renderCloseButton(){const{visibleElements:e,messagesCommon:t}=this;return e.closeButton?n$u("div",{role:"button",tabIndex:0,bind:this,onclick:this._close,onkeydown:this._close,class:T$1.button,"aria-label":t.close,title:t.close,afterCreate:this._closeButtonNodeUpdated,afterUpdate:this._closeButtonNodeUpdated},this.renderCloseIcon()):null}renderHeader(){return n$u("header",{class:T$1.header},this.renderTitle(),n$u("div",{class:T$1.headerButtons},this.renderDockButton(),this.renderCloseButton()))}renderContentContainer(){const{contentId:e,hasContent:t,contentCollapsed:i}=this,{content:o}=this.viewModel;return t&&!i?n$u("article",{key:o,enterAnimation:this._createFeatureUpdatedAnimation(),id:e,class:T$1.content},this.renderContent()):null}renderActionsMenuButton(){const{actionsMenuId:e,actionsMenuButtonId:t,actionsMenuOpen:i,dividedActions:o,messagesCommon:n}=this,s=i?n.close:n.open,{menuActions:r}=o;return r.length?n$u("div",{key:P$2("actions-menu-button"),class:this.classes(T$1.button,T$1.actionsMenuButton),role:"button",id:t,"aria-haspopup":"true","aria-controls":i?e:null,tabIndex:0,bind:this,onclick:this._toggleActionsMenu,onkeydown:this._toggleActionsMenu,afterCreate:this._focusActionsMenuButtonNode,afterUpdate:this._focusActionsMenuButtonNode,"aria-label":s,title:s},n$u("span",{"aria-hidden":"true",class:T$1.iconActionsMenu})):null}renderMenuActions(){const{actionsMenuId:e,actionsMenuButtonId:t,actionsMenuOpen:i,dividedActions:o}=this,{menuActions:n,inlineActions:s}=o;return n.length&&i?n$u("ul",{id:e,role:"menu","aria-labelledby":t,key:P$2("actions"),class:T$1.actions,bind:this,onkeyup:this._handleActionMenuKeyup,afterCreate:this._actionsMenuNodeUpdated,afterUpdate:this._actionsMenuNodeUpdated},n.toArray().map(((e,t)=>this.renderAction({action:e,index:t+s.length,type:"menu-item"})))):null}renderInlineActions(){const{inlineActions:e}=this.dividedActions;return !!e.length&&e.toArray().map(((e,t)=>this.renderAction({action:e,index:t,type:"inline"})))}renderInlineActionsContainer(){const{inlineActions:e,menuActions:t}=this.dividedActions,i=!!e.length,o=!!t.length;return i||o?n$u("div",{key:"inline-actions-container","data-inline-actions":i.toString(),"data-menu-actions":o.toString(),class:T$1.inlineActionsContainer},this.renderInlineActions(),this.renderActionsMenuButton(),this.renderMenuActions()):null}renderNavigation(){return this.featureNavigationVisible?n$u("section",{key:P$2("navigation"),class:this.classes(T$1.navigation)},this.renderNavigationButtons()):null}renderFooter(){const{featureNavigationVisible:e,dividedActions:t}=this,{inlineActions:i,menuActions:o}=t,n=!!i.length,s=!!o.length,r={[T$1.footerHasPagination]:e,[T$1.footerHasActions]:n,[T$1.footerHasActionsMenu]:s};return e||n?n$u("div",{key:P$2("feature-buttons"),class:this.classes(T$1.footer,r)},this.renderInlineActionsContainer(),this.renderNavigation()):null}renderFeatureMenuContainer(){const{messages:e}=this,{featureViewModels:t,isLoadingFeature:i}=this.viewModel,o=s$k(e.selectedFeatures,{total:t.length});return n$u("section",{key:P$2("menu"),class:T$1.featureMenu},n$u("strong",{class:T$1.featureMenuHeader},o),n$u("nav",{bind:this,class:T$1.featureMenuViewport,"data-node-ref":"_featureMenuViewportNode",afterCreate:p$r},this.renderFeatureMenu(),n$u("div",{class:T$1.featureMenuObserver,bind:this,afterCreate:this._featureMenuIntersectionObserverCreated}),i?n$u("div",{class:T$1.featureMenuLoader},this.renderLoadingIcon()):null))}renderPointer(){return this.dockEnabled?null:n$u("div",{key:P$2("pointer"),class:T$1.pointer,role:"presentation"},n$u("div",{class:this.classes(T$1.pointerDirection,T$1.shadow)}))}renderMainContainer(){const{dockEnabled:e,currentAlignment:t,currentDockPosition:i,titleId:o,contentId:n,collapsible:s,hasContent:r,contentCollapsed:a,visibleElements:l}=this,{title:u}=this.viewModel,c="bottom-left"===t||"bottom-center"===t||"bottom-right"===t||"top-left"===i||"top-center"===i||"top-right"===i,d="top-left"===t||"top-center"===t||"top-right"===t||"bottom-left"===i||"bottom-center"===i||"bottom-right"===i,p={[T$1.shadow]:e,[T$1.isCollapsible]:s,[T$1.isCollapsed]:a};return n$u("div",{class:this.classes(T$1.main,T$1.widget,p),tabIndex:l.closeButton?null:-1,role:"dialog","aria-labelledby":u?o:"","aria-describedby":r&&!a?n:"",bind:this,onkeyup:this._handleMainKeyup,afterCreate:this._mainContainerNodeUpdated,afterUpdate:this._mainContainerNodeUpdated},c?this.renderFooter():null,c?this.renderFeatureMenuContainer():null,this.renderHeader(),this.renderContentContainer(),d?this.renderFooter():null,d?this.renderFeatureMenuContainer():null)}renderContent(){var e;const t=null==(e=this.viewModel)?void 0:e.content;return t?"string"==typeof t?n$u("div",{key:t,innerHTML:t}):this.renderNodeContent(t):null}renderActionText(e){return n$u("span",{key:"text",class:T$1.actionText},e)}renderActionIcon(e){const t=this._getActionClass(e),i=this._getActionImage(e),o={[T$1.iconLoading]:e.active,[T$1.rotating]:e.active,[T$1.icon]:!!t,[T$1.actionImage]:!e.active&&!!i};return t&&(o[t]=!e.active),n$u("span",{key:"icon","aria-hidden":"true",class:this.classes(T$1.icon,o),styles:this._getIconStyles(i)})}renderAction(e){const{action:t,index:i,type:o}=e,n=this._getActionTitle(t),s={[T$1.action]:"toggle"!==t.type,[T$1.actionToggle]:"toggle"===t.type,[T$1.actionToggleOn]:"toggle"===t.type&&t.value,[T$1.buttonDisabled]:t.disabled},r=[this.renderActionIcon(t),this.renderActionText(n)],a="menu-item"===o?n$u("li",{key:t.uid,role:"menuitem",tabIndex:0,title:n,"aria-label":n,class:this.classes(T$1.button,s),onkeyup:this._handleActionMenuItemKeyup,bind:this,"data-action-index":i,onclick:this._triggerAction,onkeydown:this._triggerAction},r):n$u("div",{key:t.uid,role:"button",tabIndex:0,title:n,"aria-label":n,class:this.classes(T$1.button,s),onkeyup:this._handleActionMenuItemKeyup,bind:this,"data-action-index":i,onclick:this._triggerAction,onkeydown:this._triggerAction},r);return t.visible?a:null}renderFeatureMenuItem(e,t){const{messages:i,messagesCommon:o}=this,{selectedFeatureIndex:n,selectedFeatureViewModel:s}=this.viewModel,r=e===s,a={[T$1.featureMenuSelected]:r},l=r?n$u("span",{key:P$2(`feature-menu-selected-feature-${n}`),title:i.selectedFeature,"aria-label":i.selectedFeature,class:T$1.iconCheckMark}):null,u=n$u("span",{innerHTML:e.title||o.untitled});return n$u("li",{role:"menuitem",tabIndex:-1,key:P$2(`feature-menu-feature-${n}`),class:this.classes(a,T$1.featureMenuItem),bind:this,"data-feature-index":t,onkeyup:this._handleFeatureMenuItemKeyup,onclick:this._selectFeature,onkeydown:this._selectFeature},n$u("span",{class:T$1.featureMenuTitle},u,l))}renderFeatureMenu(){const{featureMenuId:e}=this,{featureViewModels:t}=this.viewModel;return t.length>1?n$u("ol",{class:T$1.featureMenuList,id:e,bind:this,afterCreate:this._featureMenuNodeUpdated,afterUpdate:this._featureMenuNodeUpdated,onkeyup:this._handleFeatureMenuKeyup,role:"menu"},t.filter((e=>!!e.graphic)).map(((e,t)=>this.renderFeatureMenuItem(e,t)))):null}_getActionTitle(e){const{messages:t,selectedFeature:i,messagesCommon:o}=this,{id:n}=e,s=null==i?void 0:i.attributes,r="zoom-to-feature"===n?s$k(e.title,{messages:t}):"remove-selected-feature"===n?s$k(e.title,{messages:o}):"zoom-to-clustered-features"===n||"browse-clustered-features"===n?s$k(e.title,{messages:t}):e.title;return r&&s?s$k(r,s):r}_getActionClass(e){const{selectedFeature:t}=this,i=null==t?void 0:t.attributes,{className:o,image:n}=e,s=n||o?o:T$1.iconDefaultAction;return s&&i?s$k(s,i):s}_getActionImage(e){const{selectedFeature:t}=this,i=null==t?void 0:t.attributes,{image:o}=e;return o&&i?s$k(o,i):o}_createFeatureUpdatedAnimation(){return g$g("enter",T$1.hasFeatureUpdated)}_getInlineActionCount(){const{maxInlineActions:e,featureNavigationVisible:t}=this;if("number"!=typeof e)return null;const i=Math.round(e);return Math.max(t?i-1:i,0)}_watchActions(){const{allActions:e}=this.viewModel;this.notifyChange("dividedActions");const t="actions";this._handles.remove(t),e&&e.forEach((e=>{this._handles.add(h$h(e,["active","className","disabled","id","title","image","visible"],(()=>this.scheduleRender())),t);}));}_divideActions(){const{allActions:e}=this.viewModel,i=this._getInlineActionCount(),o=null===i,n=0===i;return {inlineActions:o?e.slice(0):n?new L$3:e.slice(0,i),menuActions:o?new L$3:n?e.slice(0):e.slice(i)}}_featureMenuOpenChanged(e){e?this._focusFirstFeature=!0:this._focusFeatureMenuButton=!0;}_actionsMenuOpenChanged(e){e?this._focusFirstAction=!0:this._focusActionsMenuButton=!0;}_setTitleFromFeatureWidget(e){const{selectedFeatureWidget:t}=this;t&&(this.viewModel.title=e||"");}_setContentFromFeatureWidget(){const{selectedFeatureWidget:e}=this;e&&(this.viewModel.content=e);}_unobserveFeatureMenuObserver(){this._featureMenuIntersectionObserverNode&&this._featureMenuIntersectionObserver.unobserve(this._featureMenuIntersectionObserverNode);}_featureMenuIntersectionObserverCreated(e){this._unobserveFeatureMenuObserver(),this._featureMenuIntersectionObserver.observe(e),this._featureMenuIntersectionObserverNode=e;}_handleFeatureMenuKeyup(e){"Escape"===i$h(e)&&(e.stopPropagation(),this._focusFeatureMenuButton=!0,this.featureMenuOpen=!1,this.scheduleRender());}_handleActionMenuKeyup(e){"Escape"===i$h(e)&&(e.stopPropagation(),this._focusActionsMenuButton=!0,this.actionsMenuOpen=!1,this.scheduleRender());}_handleFeatureMenuItemKeyup(e){const t=i$h(e),{_featureMenuNode:o}=this,n=e.currentTarget["data-feature-index"];if(!o)return;const s=o.querySelectorAll("li"),r=s.length;if("ArrowUp"!==t)if("ArrowDown"!==t)if("Home"!==t)if("End"!==t);else {e.stopPropagation();s[s.length-1].focus();}else {e.stopPropagation();s[0].focus();}else {e.stopPropagation();s[(n+1+r)%r].focus();}else {e.stopPropagation();s[(n-1+r)%r].focus();}}_handleActionMenuItemKeyup(e){const t=i$h(e),{_actionsMenuNode:o}=this,n=e.currentTarget["data-action-index"];if(!o)return;const s=o.querySelectorAll("li"),r=s.length;if("ArrowUp"!==t)if("ArrowDown"!==t)if("Home"!==t)if("End"!==t);else {e.stopPropagation();s[s.length-1].focus();}else {e.stopPropagation();s[0].focus();}else {e.stopPropagation();s[(n+1+r)%r].focus();}else {e.stopPropagation();s[(n-1+r)%r].focus();}}_handleMainKeyup(e){const t=i$h(e);"ArrowLeft"===t&&(e.stopPropagation(),this.previous()),"ArrowRight"===t&&(e.stopPropagation(),this.next());}_spinnerEnabledChange(e){if(this._destroySpinner(),!e)return;const t=this.get("viewModel.view");this._createSpinner(t);}_hideSpinner(){const{_spinner:e}=this;e&&(e.location=null,e.hide());}_displaySpinner(){const{_spinner:e}=this;if(!e)return;const{location:t,waitingForResult:i}=this.viewModel;i?e.show({location:t}):e.hide();}_getIconStyles(e){return {"background-image":e?`url(${e})`:""}}_addSelectedFeatureIndexHandle(){const e=h$h(this,"viewModel.selectedFeatureIndex",((e,t)=>this._selectedFeatureIndexUpdated(e,t)));this._handles.add(e,O$1);}_selectedFeatureIndexUpdated(e,t){const{featureCount:i}=this;i&&e!==t&&-1!==e&&(this.actionsMenuOpen=!1,this.featureMenuOpen=!1);}_destroySelectedFeatureWidget(){const{_feature:e}=this;e&&(e.viewModel=null,e&&!e.destroyed&&e.destroy()),this._feature=null;}_isScreenLocationWithinView(e,t){return e.x>-1&&e.y>-1&&e.x<=t.width&&e.y<=t.height}_isOutsideView(e){const{popupHeight:t,popupWidth:i,screenLocation:o,side:n,view:s}=e;if(isNaN(i)||isNaN(t)||!s||!o)return !1;const r=s.padding;return "right"===n&&o.x+i/2>s.width-r.right||("left"===n&&o.x-i/2<r.left||("top"===n&&o.y-t<r.top||"bottom"===n&&o.y+t>s.height-r.bottom))}_calculateAutoAlignment(e){if("auto"!==e)return e;const{_pointerOffsetInPx:t,_containerNode:i,_mainContainerNode:o,viewModel:n}=this,{screenLocation:r,view:a}=n;if(t$f(r)||!a||!i)return "top-center";if(!this._isScreenLocationWithinView(r,a))return this._get("currentAlignment")||"top-center";function l(e){return parseInt(e.replace(/[^-\d\.]/g,""),10)}const u=o?window.getComputedStyle(o,null):null,c=u?l(u.getPropertyValue("max-height")):0,d=u?l(u.getPropertyValue("height")):0,{height:p,width:h}=i.getBoundingClientRect(),g=h+t,_=Math.max(p,c,d)+t,f=this._isOutsideView({popupHeight:_,popupWidth:g,screenLocation:r,side:"right",view:a}),v=this._isOutsideView({popupHeight:_,popupWidth:g,screenLocation:r,side:"left",view:a}),m=this._isOutsideView({popupHeight:_,popupWidth:g,screenLocation:r,side:"top",view:a}),b=this._isOutsideView({popupHeight:_,popupWidth:g,screenLocation:r,side:"bottom",view:a});return v?m?"bottom-right":"top-right":f?m?"bottom-left":"top-left":m?b?"top-center":"bottom-center":"top-center"}_callCurrentAlignment(e){return "function"==typeof e?e.call(this):e}_getCurrentAlignment(){const{alignment:e,dockEnabled:t}=this;return t||!this.viewModel.active?null:this._calculatePositionResult(this._calculateAutoAlignment(this._callCurrentAlignment(e)))}_setCurrentAlignment(){this._set("currentAlignment",this._getCurrentAlignment());}_setCurrentDockPosition(){this._set("currentDockPosition",this._getCurrentDockPosition());}_calculatePositionResult(e){const t=["left","right"];return d$h()&&t.reverse(),e.replace(/leading/gi,t[0]).replace(/trailing/gi,t[1])}_callDockPosition(e){return "function"==typeof e?e.call(this):e}_getDockPosition(){var e;return this._calculatePositionResult(this._calculateAutoDockPosition(this._callDockPosition(null==(e=this.dockOptions)?void 0:e.position)))}_getCurrentDockPosition(){return this.dockEnabled&&this.viewModel.active?this._getDockPosition():null}_wouldDockTo(){return this.dockEnabled?null:this._getDockPosition()}_calculateAutoDockPosition(e){var t;if("auto"!==e)return e;const i=null==(t=this.viewModel)?void 0:t.view,o=d$h()?"top-left":"top-right";if(!i)return o;const n=i.padding||{left:0,right:0,top:0,bottom:0},s=i.width-n.left-n.right,{breakpoints:r}=i;return r&&s<=r.xsmall?"bottom-center":o}_positionContainer(e=this._containerNode){if(e&&(this._containerNode=e),!e)return;const{screenLocation:t}=this.viewModel,{width:i}=e.getBoundingClientRect(),o=this._calculatePositionStyle(t,i);o&&(e.style.top=o.top,e.style.left=o.left,e.style.bottom=o.bottom,e.style.right=o.right);}_calculateFullWidth(e){const{currentAlignment:t,_pointerOffsetInPx:i}=this;return "top-left"===t||"bottom-left"===t||"top-right"===t||"bottom-right"===t?e+i:e}_calculateAlignmentPosition(e,t,i,o){const{currentAlignment:n,_pointerOffsetInPx:s}=this,r=o/2,a=i.height-t,l=i.width-e,{padding:u}=this.view;return "bottom-center"===n?{top:t+s-u.top,left:e-r-u.left}:"top-left"===n?{bottom:a+s-u.bottom,right:l+s-u.right}:"bottom-left"===n?{top:t+s-u.top,right:l+s-u.right}:"top-right"===n?{bottom:a+s-u.bottom,left:e+s-u.left}:"bottom-right"===n?{top:t+s-u.top,left:e+s-u.left}:"top-center"===n?{bottom:a+s-u.bottom,left:e-r-u.left}:void 0}_calculatePositionStyle(e,t){const{dockEnabled:i,view:o}=this;if(!o)return;if(i)return {left:"",top:"",right:"",bottom:""};if(t$f(e)||!t)return;const n=this._calculateFullWidth(t),r=this._calculateAlignmentPosition(e.x,e.y,o,n);return r?{top:void 0!==r.top?`${r.top}px`:"auto",left:void 0!==r.left?`${r.left}px`:"auto",bottom:void 0!==r.bottom?`${r.bottom}px`:"auto",right:void 0!==r.right?`${r.right}px`:"auto"}:void 0}_viewChange(e,t){e&&t&&(this.close(),this.clear());}_viewReadyChange(e,t){if(e){const e=this.get("viewModel.view");this._wireUpView(e);}else t&&(this.close(),this.clear());}_wireUpView(e){if(this._destroySpinner(),!e)return;const{spinnerEnabled:t}=this;t&&this._createSpinner(e),this._setDockEnabledForViewSize(this.dockOptions);}_dockingThresholdCrossed(e,t,i){const[o,n]=e,[s,r]=t,{width:a,height:l}=i;return o<=a&&s>a||o>a&&s<=a||n<=l&&r>l||n>l&&r<=l}_updateDockEnabledForViewSize(e,t){if(!e||!t)return;const i=this.get("viewModel.view.padding")||{left:0,right:0,top:0,bottom:0},o=i.left+i.right,n=i.top+i.bottom,s=[],r=[];s[0]=e[0]-o,s[1]=e[1]-n,r[0]=t[0]-o,r[1]=t[1]-n;const{dockOptions:a}=this,l=a.breakpoint;this._dockingThresholdCrossed(s,r,l)&&this._setDockEnabledForViewSize(a),this._setCurrentDockPosition();}_focusDockButtonNode(e){this._focusDockButton&&(this._focusDockButton=!1,e.focus());}_closeButtonNodeUpdated(e){return this._focusClose?(this._focusClose=!1,void e.focus()):this._blurClose?(this._blurClose=!1,void e.blur()):void 0}_mainContainerNodeUpdated(e){return this._mainContainerNode=e,this._focusContainer?(this._focusContainer=!1,void e.focus()):this._blurContainer?(this._blurContainer=!1,void e.blur()):void 0}_featureMenuNodeUpdated(e){if(this._featureMenuNode=e,!e||!this._focusFirstFeature)return;this._focusFirstFeature=!1;const t=e.querySelectorAll("li");if(t.length){t[0].focus();}}_actionsMenuNodeUpdated(e){if(this._actionsMenuNode=e,!e||!this._focusFirstAction)return;this._focusFirstAction=!1;const t=e.querySelectorAll("li");if(t.length){t[0].focus();}}_focusFeatureMenuButtonNode(e){this._focusFeatureMenuButton&&(this._focusFeatureMenuButton=!1,e.focus());}_focusActionsMenuButtonNode(e){this._focusActionsMenuButton&&(this._focusActionsMenuButton=!1,e.focus());}_featureMenuViewportScrollTop(){this._featureMenuViewportNode&&(this._featureMenuViewportNode.scrollTop=0);}_toggleScreenLocationEnabled(){const{dockEnabled:e,viewModel:t}=this;if(!t)return;const i=t.active&&!e;t.screenLocationEnabled=i;}_shouldDockAtCurrentViewSize(e){var t,i;const o=e.breakpoint,n=null==(t=this.viewModel)||null==(i=t.view)?void 0:i.ui;if(!n)return !1;const{width:s,height:r}=n;if(isNaN(s)||isNaN(r))return !1;const a=o.hasOwnProperty("width")&&s<=o.width,l=o.hasOwnProperty("height")&&r<=o.height;return a||l}_setDockEnabledForViewSize(e){e.breakpoint&&(this.dockEnabled=this._shouldDockAtCurrentViewSize(e));}_getPageText(e,t){return this.featureNavigationVisible?s$k(this.messages.pageText,{index:t+1,total:e}):null}_destroySpinner(){const{_spinner:e,view:t}=this;e&&(t&&t.ui&&t.ui.remove(this._spinner,B$2),e.destroy(),this._spinner=null);}_createSpinner(e){e&&(this._spinner=new m$9({view:e}),e.ui.add(this._spinner,{key:B$2,position:"manual"}));}_toggleCollapsed(){this.collapsed=!this.collapsed;}_close(){this.close(),this.view&&this.view.focus();}_toggleDockEnabled(){this.dockEnabled=!this.dockEnabled,this._focusDockButton=!0,this.scheduleRender();}_toggleFeatureMenu(){const e=!this.featureMenuOpen;this._featureMenuOpenChanged(e),this.actionsMenuOpen=!1,this.featureMenuOpen=e;}_toggleActionsMenu(){const e=!this.actionsMenuOpen;this._actionsMenuOpenChanged(e),this.featureMenuOpen=!1,this.actionsMenuOpen=e;}_triggerAction(e){const t=e.currentTarget["data-action-index"],i=this.viewModel.allActions.getItemAt(t);i&&"toggle"===i.type&&(i.value=!i.value),this.actionsMenuOpen=!1,this.viewModel.triggerAction(t);}_selectFeature(e){const t=e.currentTarget["data-feature-index"];isNaN(t)||(this.viewModel.selectedFeatureIndex=t),this.featureMenuOpen=!1,this._focusFeatureMenuButton=!0,this.scheduleRender();}_next(){this.next();}_previous(){this.previous();}};e$c([y$c({readOnly:!0})],R.prototype,"actionsMenuId",null),e$c([y$c({readOnly:!0})],R.prototype,"actionsMenuButtonId",null),e$c([y$c({readOnly:!0})],R.prototype,"featureMenuId",null),e$c([y$c({readOnly:!0})],R.prototype,"titleId",null),e$c([y$c({readOnly:!0})],R.prototype,"contentId",null),e$c([y$c({readOnly:!0})],R.prototype,"hasContent",null),e$c([y$c({readOnly:!0})],R.prototype,"featureNavigationVisible",null),e$c([y$c({readOnly:!0})],R.prototype,"collapsible",null),e$c([y$c({readOnly:!0})],R.prototype,"featureMenuVisible",null),e$c([y$c({readOnly:!0})],R.prototype,"contentCollapsed",null),e$c([y$c({readOnly:!0})],R.prototype,"dividedActions",null),e$c([o$g("viewModel.actions")],R.prototype,"actions",void 0),e$c([y$c()],R.prototype,"actionsMenuOpen",null),e$c([y$c()],R.prototype,"alignment",void 0),e$c([o$g("viewModel.autoCloseEnabled")],R.prototype,"autoCloseEnabled",void 0),e$c([o$g("viewModel.autoOpenEnabled")],R.prototype,"autoOpenEnabled",void 0),e$c([o$g("viewModel.defaultPopupTemplateEnabled")],R.prototype,"defaultPopupTemplateEnabled",void 0),e$c([o$g("viewModel.content")],R.prototype,"content",void 0),e$c([y$c()],R.prototype,"collapsed",void 0),e$c([y$c()],R.prototype,"collapseEnabled",void 0),e$c([y$c({readOnly:!0})],R.prototype,"currentAlignment",null),e$c([y$c({readOnly:!0})],R.prototype,"currentDockPosition",null),e$c([y$c()],R.prototype,"dockOptions",null),e$c([y$c()],R.prototype,"dockEnabled",void 0),e$c([o$g("viewModel.featureCount")],R.prototype,"featureCount",void 0),e$c([y$c()],R.prototype,"featureMenuOpen",void 0),e$c([o$g("viewModel.features")],R.prototype,"features",void 0),e$c([o$g("viewModel.goToOverride")],R.prototype,"goToOverride",void 0),e$c([y$c()],R.prototype,"headingLevel",void 0),e$c([o$g("viewModel.highlightEnabled")],R.prototype,"highlightEnabled",void 0),e$c([o$g("viewModel.location")],R.prototype,"location",void 0),e$c([y$c({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],R.prototype,"label",void 0),e$c([y$c()],R.prototype,"maxInlineActions",void 0),e$c([y$c(),e$d("esri/widgets/Popup/t9n/Popup")],R.prototype,"messages",void 0),e$c([y$c(),e$d("esri/t9n/common")],R.prototype,"messagesCommon",void 0),e$c([o$g("viewModel.promises")],R.prototype,"promises",void 0),e$c([o$g("viewModel.selectedFeature")],R.prototype,"selectedFeature",void 0),e$c([o$g("viewModel.selectedFeatureIndex")],R.prototype,"selectedFeatureIndex",void 0),e$c([y$c({readOnly:!0})],R.prototype,"selectedFeatureWidget",null),e$c([y$c()],R.prototype,"spinnerEnabled",void 0),e$c([o$g("viewModel.title")],R.prototype,"title",void 0),e$c([o$g("viewModel.updateLocationEnabled")],R.prototype,"updateLocationEnabled",void 0),e$c([o$g("viewModel.view")],R.prototype,"view",void 0),e$c([y$c({type:W$3}),t$c(["triggerAction","trigger-action"])],R.prototype,"viewModel",void 0),e$c([o$g("viewModel.visible")],R.prototype,"visible",void 0),e$c([y$c()],R.prototype,"visibleElements",void 0),e$c([c$u("visibleElements")],R.prototype,"castVisibleElements",null),e$c([t$d()],R.prototype,"_close",null),e$c([t$d()],R.prototype,"_toggleDockEnabled",null),e$c([t$d()],R.prototype,"_toggleFeatureMenu",null),e$c([t$d()],R.prototype,"_toggleActionsMenu",null),e$c([t$d()],R.prototype,"_triggerAction",null),e$c([t$d()],R.prototype,"_selectFeature",null),e$c([t$d()],R.prototype,"_next",null),e$c([t$d()],R.prototype,"_previous",null),R=e$c([n$s(L$1)],R);var U$2=R;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
const u$9=[0,0];function l$9(e){const t=(e.ownerDocument||window.document).defaultView,s=e.getBoundingClientRect();return u$9[0]=s.left+t.pageXOffset,u$9[1]=s.top+t.pageYOffset,u$9}function p$e(e){e&&(t$h(e),e.parentNode&&e.parentNode.removeChild(e));}function c$e(e){const t=document.createElement("div");return e.appendChild(t),t}const m$8=16,f$4=750,y$5=512,v$2=2,_$4=i=>{let u=class extends i{constructor(...e){super(...e),this._freqInfo={freq:m$8,time:f$4},this._overlayRenderTaskHandle=null,this.height=0,this.position=null,this.resizing=!1,this.root=null,this.surface=null,this.suspended=!0,this.ui=null,this.userContent=null,this.width=0,this.widthBreakpoint=null,this.handles.add([this.watch("cursor",(e=>{const t=this.surface;t&&t.setAttribute("data-cursor",e);})),this.watch("interacting",(e=>{const t=this.surface;t&&t.setAttribute("data-interacting",e.toString());}))]);}initialize(){this.handles.add(this.watch("ui",((e,t)=>this._handleUIChange(e,t)))),this._wireUI(this.ui),this.handles.add([this.on("focus",(()=>this.notifyChange("focused"))),this.on("blur",(()=>this.notifyChange("focused")))]);}destroy(){this.destroyed||(this.ui&&(this.ui.destroy(),this.ui=null),this.popup&&!this.popup.destroyed&&this.popup.destroy(),this.container=null);}set container(e){const t=this._get("container");if(t===e)return;const i="dom-size";if(this.handles.remove(i),this._stopMeasuring(),t&&(t.classList.remove("esri-view"),this._overlayRenderTaskHandle&&(this._overlayRenderTaskHandle.remove(),this._overlayRenderTaskHandle=null),this.overlay.destroy(),this._set("overlay",null),p$e(this.root),this._set("root",null),r$h(this.userContent,t),p$e(this.userContent),this._set("userContent",null)),e){e.classList.add("esri-view");const t=document.createElement("div");t.className="esri-view-user-storage",r$h(e,t),e.appendChild(t),this._set("userContent",t);const n=document.createElement("div");n.className="esri-view-root",e.insertBefore(n,e.firstChild),this._set("root",n);const h=document.createElement("div");h.className="esri-view-surface",h.setAttribute("role","application"),h.tabIndex=0,n.appendChild(h),this._set("surface",h);const d=new n$q;n.appendChild(d.surface),this._set("overlay",d),d.watch("needsRender",(e=>{e&&!this._overlayRenderTaskHandle?this._overlayRenderTaskHandle=A$5({render:()=>{this.overlay.render();}}):this._overlayRenderTaskHandle&&(this._overlayRenderTaskHandle.remove(),this._overlayRenderTaskHandle=null);})),this.forceDOMReadyCycle(),this.handles.add(d$f(this,"size",(e=>{const[t,s]=e,i="esri-view-surface--inset-outline";t>=document.body.clientWidth||s>=document.body.clientHeight?h.classList.add(i):h.classList.remove(i);})),i),this._set("container",e),this._startMeasuring();}else this._set("width",0),this._set("height",0),this._set("position",null),this._set("suspended",!0),this._set("surface",null),this._set("container",null);}get focused(){const e=document.activeElement===this.surface;return document.hasFocus()&&e}get popup(){return this._get("popup")||new U$2({view:this})}set popup(e){const t=this._get("popup");t&&t!==e&&t.destroy(),this._set("popup",e);}get size(){return [this.width,this.height]}blur(){this.surface&&this.surface.blur();}focus(){this.surface&&this.surface.focus();}pageToContainer(e,t,s){const i=this.position;return e-=i[0],t-=i[1],s?(s[0]=e,s[1]=t):s=[e,t],s}containerToPage(e,t,s){const i=this.position;return e+=i[0],t+=i[1],s?(s[0]=e,s[1]=t):s=[e,t],s}_handleUIChange(e,t){t&&(this.handles.remove("ui"),t.destroy()),e&&this._wireUI(e),this._set("ui",e);}_wireUI(e){this.handles.remove("ui"),e&&(e.view=this,this.handles.add([d$f(this,"root",(t=>{e.container=t?c$e(t):null;})),d$f(this,"popup",((t,s)=>{const i="popup",o="manual";s&&e.remove(s,i),t&&(t.view=e.view,e.add(t,{key:i,position:o}));}))],"ui"));}_stopMeasuring(){this.handles.remove("measuring"),this._get("resizing")&&this._set("resizing",!1);}_startMeasuring(){const e=this._freqInfo;e.freq=m$8,e.time=f$4,this.handles.add([(()=>{const t=()=>{e.freq=m$8,e.time=f$4;};return window.addEventListener("resize",t),{remove(){window.removeEventListener("resize",t);}}})(),A$5({prepare:e=>{const t=this._measure(),s=this._freqInfo;if(s.time+=e.deltaTime,t&&(s.freq=m$8,this._get("resizing")||this._set("resizing",!0)),s.time<s.freq)return;s.time=0;const i=this._position();s.freq=i||t?m$8:Math.min(f$4,s.freq*v$2),!t&&s.freq>=y$5&&this._get("resizing")&&this._set("resizing",!1);}})],"measuring"),this._measure(),this._position();}_measure(){const e=this.container,t=e?e.clientWidth:0,s=e?e.clientHeight:0;if(0===t||0===s)return this.suspended||this._set("suspended",!0),!1;const i=this.width,o=this.height;return t===i&&s===o?(this.suspended&&this._set("suspended",!1),!1):(this._set("width",t),this._set("height",s),this.suspended&&this._set("suspended",!1),this.emit("resize",{oldWidth:i,oldHeight:o,width:t,height:s}),!0)}_position(){const e=this.container,t=this.position,s=l$9(e);return (!t||s[0]!==t[0]||s[1]!==t[1])&&(this._set("position",[s[0],s[1]]),!0)}forceDOMReadyCycle(){}};return e$c([y$c({value:null,cast:e=>e$h(e)})],u.prototype,"container",null),e$c([y$c({readOnly:!0})],u.prototype,"focused",null),e$c([y$c({readOnly:!0})],u.prototype,"height",void 0),e$c([y$c({type:U$2})],u.prototype,"popup",null),e$c([y$c({type:n$q})],u.prototype,"overlay",void 0),e$c([y$c({readOnly:!0})],u.prototype,"position",void 0),e$c([y$c({readOnly:!0})],u.prototype,"resizing",void 0),e$c([y$c({readOnly:!0})],u.prototype,"root",void 0),e$c([y$c({value:null,readOnly:!0})],u.prototype,"size",null),e$c([y$c({readOnly:!0})],u.prototype,"surface",void 0),e$c([y$c({readOnly:!0})],u.prototype,"suspended",void 0),e$c([y$c()],u.prototype,"ui",void 0),e$c([y$c({readOnly:!0})],u.prototype,"userContent",void 0),e$c([y$c({readOnly:!0})],u.prototype,"width",void 0),e$c([y$c()],u.prototype,"widthBreakpoint",void 0),u=e$c([n$s("esri.views.DOMContainer")],u),u};function g$8(e){return e&&"focus"in e}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
function d$6(t){const n=t[0]*t[0]+t[4]*t[4]+t[8]*t[8],i=t[1]*t[1]+t[5]*t[5]+t[9]*t[9],o=t[2]*t[2]+t[6]*t[6]+t[10]*t[10];return Math.sqrt(Math.max(n,i,o))}function z$1(t,n){const o=Math.sqrt(n[0]*n[0]+n[4]*n[4]+n[8]*n[8]),s=Math.sqrt(n[1]*n[1]+n[5]*n[5]+n[9]*n[9]),r=Math.sqrt(n[2]*n[2]+n[6]*n[6]+n[10]*n[10]);return o$h(t,o,s,r),t}function b$2(t,n,r){r=r||t;const a=z$4(t,n);o$h(r,t[0]-a*n[0],t[1]-a*n[1],t[2]-a*n[2]),j$4(r,r);}function g$7(t,n,o){Math.abs(t[0])>Math.abs(t[1])?o$h(n,0,1,0):o$h(n,1,0,0),_$8(o,t,n),j$4(n,n),_$8(n,o,t),j$4(o,o);}function x(t,n,i,o,s,r){const a=t+(n-t)*s;return a+(i+(o-i)*s-a)*r}function q(t,n,i,s=n$w()){const r=s$m(t),u=s$m(n),m=z$4(t,n)/(r*u);if(m<.9999999999999999){const o=Math.acos(m),a=((1-i)*r+i*u)/Math.sin(o),e=a/r*Math.sin((1-i)*o),f=a/u*Math.sin(i*o);return d$j(A,t,e),d$j(B$1,n,f),u$k(s,A,B$1)}return y$d(s,t,n,i)}function j$1(t,n,i,r=n$w(),m=n$w()){const M=s$m(t),l=s$m(n),d=z$4(t,n)/(M*l);if(d<.9999999999999999){const o=Math.acos(d),s=Math.sin(o),a=Math.sin(i*o),e=Math.sin((1-i)*o),u=(1-i)*M+i*l;{const i=u/s,o=i/l*a;d$j(A,t,i/M*e),d$j(B$1,n,o),u$k(r,A,B$1);}{const r=1/M*(-Math.cos((1-i)*o)*o*u+e*(-M+l));d$j(A,t,r);const f=1/l*(Math.cos(i*o)*o*u+a*(-M+l));d$j(B$1,n,f),u$k(m,A,B$1),d$j(m,m,1/s);}return m}return y$d(r,t,n,i),c$A(m,n,t),j$4(m,m),m}function w(n,i,a){n=j$4(A,n),i=j$4(B$1,i);const c=x$3(z$4(n,i));if(a){const t=_$8(y$4,n,i);if(z$4(t,a)<0)return -c}return c}function I$1(t){const n=t.length;return function(i){if(i<=t[0][0])return t[0][1];if(i>=t[n-1][0])return t[n-1][1];let o=1;for(;i>t[o][0];)o++;const s=t[o-1][0],r=t[o][0],a=(r-i)/(r-s);return a*t[o-1][1]+(1-a)*t[o][1]}}class P$1{constructor(t,n){this.min=t,this.max=n,this.range=n-t;}ndiff(t,n=0){return Math.ceil((t-n)/this.range)*this.range+n}_normalize(t,n,i,o=0,s=!1){return (i-=o)<t?i+=this.ndiff(t-i):i>n&&(i-=this.ndiff(i-n)),s&&i===n&&(i=t),i+o}normalize(t,n=0,i=!1){return this._normalize(this.min,this.max,t,n,i)}clamp(t,i=0){return o$f(t-i,this.min,this.max)+i}monotonic(t,n,i){return t<n?n:n+this.ndiff(t-n,i)}minimalMonotonic(t,n,i){return this._normalize(t,t+this.range,n,i)}center(t,n,i){return n=this.monotonic(t,n,i),this.normalize((t+n)/2,i)}diff(t,n,i){return this.monotonic(t,n,i)-t}shortestSignedDiff(t,n){t=this.normalize(t);const i=(n=this.normalize(n))-t,o=n<t?this.minimalMonotonic(t,n)-t:n-this.minimalMonotonic(n,t);return Math.abs(i)<Math.abs(o)?i:o}contains(t,n,i){return n=this.minimalMonotonic(t,n),(i=this.minimalMonotonic(t,i))>t&&i<n}}function _$3(t,n,i,a){c$A(k,n,t),c$A(v$1,i,t),_$8(a,k,v$1),j$4(a,a),a[3]=-z$4(t,a);}const k=n$w(),v$1=n$w();function D$1(t){for(const n in t){const i=t[n];i instanceof Function&&(t[n]=i.bind(t));}return t}const F=D$1(new P$1(0,2*Math.PI)),S$2=D$1(new P$1(-Math.PI,Math.PI)),U$1=D$1(new P$1(0,360)),y$4=n$w(),A=n$w(),B$1=n$w();

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
var u$8;let m$7=u$8=class extends a$j{constructor(...o){super(...o),this.position=new b$b([0,0,0]),this.heading=0,this.tilt=0,this.fov=55;}normalizeCtorArgs(o,r,t,e){if(o&&"object"==typeof o&&("x"in o||Array.isArray(o))){const i={position:o};return null!=r&&(i.heading=r),null!=t&&(i.tilt=t),null!=e&&(i.fov=e),i}return o}writePosition(o,r,t,e){const i=o.clone();i.x=u$l(o.x||0),i.y=u$l(o.y||0),i.z=o.hasZ?u$l(o.z||0):o.z,r[t]=i.write(null,e);}readPosition(o,r){const t=new b$b;return t.read(o,r),t.x=u$l(t.x||0),t.y=u$l(t.y||0),t.z=t.hasZ?u$l(t.z||0):t.z,t}equals(o){return !!o&&(this.tilt===o.tilt&&this.heading===o.heading&&this.fov===o.fov&&this.position.equals(o.position))}clone(){return new u$8({position:this.position.clone(),heading:this.heading,tilt:this.tilt,fov:this.fov})}};e$c([y$c({type:b$b,json:{write:{isRequired:!0}}})],m$7.prototype,"position",void 0),e$c([o$i("position")],m$7.prototype,"writePosition",null),e$c([e$i("position")],m$7.prototype,"readPosition",null),e$c([y$c({type:Number,nonNullable:!0,json:{write:{isRequired:!0}}}),c$u((o=>U$1.normalize(u$l(o))))],m$7.prototype,"heading",void 0),e$c([y$c({type:Number,nonNullable:!0,json:{write:{isRequired:!0}}}),c$u((o=>o$f(u$l(o),-180,180)))],m$7.prototype,"tilt",void 0),e$c([y$c({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],m$7.prototype,"fov",void 0),m$7=u$8=e$c([n$s("esri.Camera")],m$7);var d$5=m$7;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
var m$6;let n$i=m$6=class extends a$j{constructor(r){super(r),this.rotation=0,this.scale=0,this.targetGeometry=null,this.camera=null;}castRotation(r){return (r%=360)<0&&(r+=360),r}clone(){return new m$6({rotation:this.rotation,scale:this.scale,targetGeometry:r$g(this.targetGeometry)?this.targetGeometry.clone():null,camera:r$g(this.camera)?this.camera.clone():null})}};function l$8(){return {enabled:!this.camera}}e$c([y$c({type:Number,json:{write:!0,origins:{"web-map":{default:0,write:!0},"web-scene":{write:{overridePolicy:l$8}}}}})],n$i.prototype,"rotation",void 0),e$c([c$u("rotation")],n$i.prototype,"castRotation",null),e$c([y$c({type:Number,json:{write:!0,origins:{"web-map":{default:0,write:!0},"web-scene":{write:{overridePolicy:l$8}}}}})],n$i.prototype,"scale",void 0),e$c([y$c({types:i$i,json:{read:p$s,write:!0,origins:{"web-scene":{read:p$s,write:{overridePolicy:l$8}}}}})],n$i.prototype,"targetGeometry",void 0),e$c([y$c({type:d$5,json:{write:!0}})],n$i.prototype,"camera",void 0),n$i=m$6=e$c([n$s("esri.Viewpoint")],n$i);var u$7=n$i;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
const a$9=a=>{let t=class extends a{async fetchPopupFeatures(e,s){await this.when();const{location:p,queryArea:a,layerViewsAndGraphics:t,clientOnlyGraphics:o}=await this._prepareFetchPopupFeatures(e,s),c=Promise.resolve(o),n=this._queryLayerPopupFeatures({queryArea:a,layerViewsAndGraphics:t,options:s}),l=n.map((e=>e.promise));return {location:p,clientOnlyGraphics:o,allGraphicsPromise:k$3([c,...l]).then(M$5),promisesPerLayerView:n}}_queryLayerPopupFeatures({queryArea:e,layerViewsAndGraphics:r,options:i}){return r.map((({layerView:r,graphics:p})=>{const a={clientGraphics:p,event:r$g(i)?i.event:null,signal:r$g(i)?i.signal:null,defaultPopupTemplateEnabled:!!r$g(i)&&!!i.defaultPopupTemplateEnabled},t=r.fetchPopupFeatures(e,a);return {layerView:r,promise:t}}))}_isValidPopupGraphic(e,r){return e&&!!e.getEffectivePopupTemplate(r$g(r)&&r.defaultPopupTemplateEnabled)}async _prepareFetchPopupFeatures(e,r){const{clientGraphics:s,queryArea:i,location:p}=await this._popupHitTestGraphics(e,r),a=this._getFetchPopupLayerViews(),{layerViewsAndGraphics:t,clientOnlyGraphics:o}=this._graphicsPerFetchPopupLayerView(s,a);return {clientOnlyGraphics:o,layerViewsAndGraphics:t,queryArea:i,location:p}}async _popupHitTestGraphics(e,r){const{results:s,mapPoint:i}=await this.popupHitTest(e),p=s.filter((e=>this._isValidPopupGraphic(e.graphic,r))),a=p.length?p[0].mapPoint:null;return {clientGraphics:p.map((e=>e.graphic)),queryArea:i,location:i||a}}_getFetchPopupLayerViews(){const e=[];return this.allLayerViews.forEach((r=>{this._isValidPopupLayerView(r)&&e.push(r);})),r$g(this.graphicsView)&&this._isValidPopupLayerView(this.graphicsView)&&e.push(this.graphicsView),e.reverse()}_isValidPopupLayerView(e){return r$g(e)&&(!("layer"in e)||!e.suspended)&&"fetchPopupFeatures"in e}_graphicsPerFetchPopupLayerView(e,r){const s=[],i=new Map,p=r.map((e=>{const r=[];return "layer"in e?i.set(e.layer,r):i.set(e.graphics,r),{layerView:e,graphics:r}}));for(const a of e){const e=i.get(a.layer)||i.get(a.sourceLayer)||null;e?e.push(a):s.push(a);}return {layerViewsAndGraphics:p,clientOnlyGraphics:s}}};return t=e$c([n$s("esri.views.PopupView")],t),t};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
let a$8=class extends p$q{constructor(e){super(e),this.view=null,this.baseLayerViews=new L$3,this.referenceLayerViews=new L$3,this._loadingHandle=d$f(this,"view.map.basemap",(e=>{e&&e.load().catch((()=>{}));}));}destroy(){this._set("view",null),this._loadingHandle&&(this._loadingHandle.remove(),this._loadingHandle=null);}get suspended(){return !this.view||this.view.suspended}get updating(){return (!this.view||!this.view.suspended)&&!(!(this.view&&this.view.map&&this.view.map.basemap)||this.view.map.basemap.loaded)}};e$c([y$c({constructOnly:!0})],a$8.prototype,"view",void 0),e$c([y$c({readOnly:!0})],a$8.prototype,"baseLayerViews",void 0),e$c([y$c({readOnly:!0})],a$8.prototype,"referenceLayerViews",void 0),e$c([y$c({readOnly:!0})],a$8.prototype,"suspended",null),e$c([y$c({type:Boolean,readOnly:!0})],a$8.prototype,"updating",null),a$8=e$c([n$s("esri.views.BasemapView")],a$8);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
function n$h(n,r){for(const[o,t]of n)if(r(t,o))return !0;return !1}function r$b(n,r){for(const[o,t]of n)if(r(t,o))return t;return null}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
const g$6=n$t.getLogger("esri.views.LayerViewManager");class V$1{constructor(e,r,t){this.layer=e,this.view=r,this.layerViewImporter=t,this._controller=h$g(),this._deferred=E$4(),this._started=!1,this.done=!1,v$9(this._controller.signal,(()=>{const r=new s$j("cancelled:layerview-create","layerview creation cancelled",{layer:e});this._deferred.reject(r);}));}get promise(){return this._deferred.promise}destroy(){this._controller.abort();const{layerView:e}=this;if(!e)return;const{layer:r,view:i}=this;r.emit("layerview-destroy",{view:i,layerView:e}),i.emit("layerview-destroy",{layer:r,layerView:e}),this.done=!0,this.layer=null,this.layerView=null,this.view=null,this.layerViewImporter=null;}async start(){if(this._started)return;this._started=!0;const{_controller:{signal:e},layer:r,view:t}=this;this._map=t.map;try{var a,s;let l,h;if(await r.load({signal:e}),"prefetchResources"in r&&await r.prefetchResources({signal:e}),r.createLayerView)l=await r.createLayerView(t,{signal:e});else {if(!this.layerViewImporter.hasLayerViewModule(r))throw new s$j("layer:view-not-supported","No layerview implementation was found");const a=await this.layerViewImporter.importLayerView(r);a$k(e),l="default"in a?new a.default({layer:r,view:t}):new a({layer:r,view:t});}const y=()=>{h=s$n(h),l.destroyed||l.destroy(),l.layer=null,l.parent=null,l.view=null,this.done=!0;};h=v$9(e,y),a$k(e);try{await l.when();}catch(o){throw y(),o}if(!(null==(a=this._map)||null==(s=a.allLayers)?void 0:s.includes(r)))return y(),void this._deferred.reject(new s$j("view:no-layerview-for-layer","The layer has been removed from the map",{layer:r}));this.layerView=l,r.emit("layerview-create",{view:t,layerView:l}),t.emit("layerview-create",{layer:r,layerView:l}),this.done=!0,this._deferred.resolve(l);}catch(o){r.emit("layerview-create-error",{view:t,error:o}),t.emit("layerview-create-error",{layer:r,error:o}),this.done=!0,this._deferred.reject(new s$j("layerview:create-error","layerview creation failed",{layer:r,error:o}));}}}let L=class extends d$g{constructor(e){super(e),this._layerLayerViewInfoMap=new Map,this._watchUpdatingTracking=new l$i,this.supportsGround=!0,this._preloadLayerViewModules=()=>{var e;const r=null==(e=this.view.map)?void 0:e.allLayers;if(r)for(const i of r)this.layerViewImporter.hasLayerViewModule(i)&&this.layerViewImporter.importLayerView(i);},this._reschedule=()=>(t$f(this._workPromise)&&(this._workPromise=E$4()),this.handles.remove("reschedule"),this.handles.add(v$8(this._doWork),"reschedule"),this._workPromise.promise),this._doWork=()=>{var e,i,t;const a=this.view.map;if(this._map!==a&&(this.clear(),this._map=a),t$f(this._workPromise))return void this.notifyChange("updating");this.handles.remove("reschedule"),this.handles.remove("collection-change");const s=new p$t({getCollections:()=>this._rootCollectionNames.map((e=>this.get(e))),getChildrenFunction:e=>e&&"layers"in e?e.layers:null});if(!s)return this._workPromise.resolve(),void(this._workPromise=null);for(const r of s)this._createLayerView(r);this._refreshCollections();for(const[r,o]of this._layerLayerViewInfoMap)s.includes(r)||(this._layerLayerViewInfoMap.delete(o.layer),o.destroy());const l=s.filter((e=>"group"===e.type)).map((e=>e.layers)),n=[null==a||null==(e=a.ground)?void 0:e.layers,null==a||null==(i=a.basemap)?void 0:i.baseLayers,null==a||null==(t=a.basemap)?void 0:t.referenceLayers,null==a?void 0:a.layers,...l].filter((e=>!!e));this.handles.add(n.map((e=>this._watchUpdatingTracking.addOnCollectionChange(e,this._reschedule))),"collection-change"),this._workPromise.resolve(),this._workPromise=null;};}initialize(){this.handles.add([C$4(this,"view.map.allLayers","change",this._preloadLayerViewModules,this._preloadLayerViewModules),d$f(this.view,["map.basemap","map.ground","map.layers","ready"],this._reschedule,!0)]),this._preloadLayerViewModules(),this._reschedule();}destroy(){this.clear(),this._watchUpdatingTracking.destroy(),this._map=null;}get _layersToLayerViews(){const e=[["view.map.basemap.baseLayers","view.basemapView.baseLayerViews"],["view.map.layers","view.layerViews"],["view.map.basemap.referenceLayers","view.basemapView.referenceLayerViews"]];return this.supportsGround&&e.push(["view.map.ground.layers","view.groundView.layerViews"]),new Map(e)}get _rootCollectionNames(){return Array.from(this._layersToLayerViews.keys())}get updating(){return r$g(this._workPromise)||this._watchUpdatingTracking.updating||n$h(this._layerLayerViewInfoMap,(e=>!e.done))}get updatingRemaining(){let e=0;for(const r of this._layerLayerViewInfoMap.values())r.done||++e;return e}clear(){if(!this.destroyed){for(const e of this._layerLayerViewInfoMap.values())e.destroy();this._layerLayerViewInfoMap.clear(),this._refreshCollections();}}async whenLayerView(e){if(await this._reschedule(),!this._layerLayerViewInfoMap.has(e))throw new s$j("view:no-layerview-for-layer","No layerview has been found for the layer",{layer:e});return this._layerLayerViewInfoMap.get(e).promise}_refreshCollections(){for(const[e,r]of this._layersToLayerViews)this._populateLayerViewsOwners(this.get(e),this.get(r),this.view);this.notifyChange("updating"),this.notifyChange("updatingRemaining");}_populateLayerViewsOwners(e,r,i){if(!e||!r)return void(r&&r.removeAll());let t=0;for(const a of e){const e=this._layerLayerViewInfoMap.get(a);if(!e||!e.layerView)continue;const s=e.layerView;s.layer=a,s.parent=i,r.getItemAt(t)!==s&&r.splice(t,0,s),a.layers&&this._populateLayerViewsOwners(a.layers,s.layerViews,s),t+=1;}t<r.length&&r.splice(t,r.length);}_createLayerView(e){if(this._layerLayerViewInfoMap.has(e))return this.view.ready&&this._layerLayerViewInfoMap.get(e).start(),this.notifyChange("updating"),void this.notifyChange("updatingRemaining");e.load().catch((()=>{})),this.layerViewImporter.hasLayerViewModule(e)&&this.layerViewImporter.importLayerView(e);const r=new V$1(e,this.view,this.layerViewImporter);r.promise.then((()=>this._refreshCollections()),(r=>{var i,t;r&&(g$h(r)||"cancelled:layerview-create"===r.name)||g$6.error(`Failed to create layerview for layer title:'${null!=(i=e.title)?i:"no title"}', id:'${null!=(t=e.id)?t:"no id"}' of type '${e.type}'.`,{layer:e,error:r});this._refreshCollections();})),this._layerLayerViewInfoMap.set(e,r),this.view.ready&&r.start(),this.notifyChange("updating"),this.notifyChange("updatingRemaining");}};e$c([y$c()],L.prototype,"_workPromise",void 0),e$c([y$c({readOnly:!0})],L.prototype,"_watchUpdatingTracking",void 0),e$c([y$c({readOnly:!0})],L.prototype,"_layersToLayerViews",null),e$c([y$c({readOnly:!0})],L.prototype,"_rootCollectionNames",null),e$c([y$c()],L.prototype,"layerViewImporter",void 0),e$c([y$c()],L.prototype,"supportsGround",void 0),e$c([y$c({readOnly:!0})],L.prototype,"updating",null),e$c([y$c({readOnly:!0})],L.prototype,"updatingRemaining",null),e$c([y$c({constructOnly:!0})],L.prototype,"view",void 0),L=e$c([n$s("esri.views.LayerViewManager")],L);var M=L;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
let i$9=class extends p$q{constructor(o){super(o),this.factor=1.5,this.offset=c$B(0,0),this.position=null,this.size=120,this.maskUrl=null,this.maskEnabled=!0,this.overlayUrl=null,this.overlayEnabled=!0,this.visible=!0;}get version(){return this.commitProperty("factor"),this.commitProperty("offset"),this.commitProperty("position"),this.commitProperty("visible"),this.commitProperty("size"),this.commitProperty("maskUrl"),this.commitProperty("maskEnabled"),this.commitProperty("overlayUrl"),this.commitProperty("overlayEnabled"),(this._get("version")||0)+1}};e$c([y$c({type:Number})],i$9.prototype,"factor",void 0),e$c([y$c({nonNullable:!0})],i$9.prototype,"offset",void 0),e$c([y$c()],i$9.prototype,"position",void 0),e$c([y$c({type:Number,range:{min:0}})],i$9.prototype,"size",void 0),e$c([y$c()],i$9.prototype,"maskUrl",void 0),e$c([y$c()],i$9.prototype,"maskEnabled",void 0),e$c([y$c()],i$9.prototype,"overlayUrl",void 0),e$c([y$c()],i$9.prototype,"overlayEnabled",void 0),e$c([y$c({readOnly:!0})],i$9.prototype,"version",null),e$c([y$c({type:Boolean})],i$9.prototype,"visible",void 0),i$9=e$c([n$s("esri.views.Magnifier")],i$9);var p$d=i$9;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
const p$c=p=>{let c=class extends p{constructor(){super(...arguments),this.refreshTimestamp=null,this.refreshDebounced=B$7((async(e,s)=>{let t;"number"==typeof e?t=e:(t=Date.now(),s=e),this._set("refreshTimestamp",t),this.doRefresh&&await this.doRefresh(s).catch((e=>{g$h(e)||n$t.getLogger(this.declaredClass).error(e);}));}),2e3);}refresh(e=Date.now()){this._set("refreshTimestamp",e),this.doRefresh&&this.doRefresh().catch((e=>{g$h(e)||n$t.getLogger(this.declaredClass).error(e);}));}};return e$c([y$c()],c.prototype,"layer",void 0),e$c([o$g("layer.refreshInterval")],c.prototype,"refreshInterval",void 0),e$c([y$c({readOnly:!0})],c.prototype,"refreshTimestamp",void 0),c=e$c([n$s("esri.layers.mixins.RefreshableLayerView")],c),c};function c$d(e){return "refresh"in e}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
const n$g=6e3;let h$7=class extends n$v.EventedAccessor{constructor(){super(...arguments),this._handles=new u$g,this._currentTick=0;}initialize(){this._handles.add([this.view.allLayerViews.on("after-changes",(()=>{this.notifyChange("tickInterval"),this._handles.remove("layerViewsUpdating"),this._handles.add(this._getLayerViewHandles(),"layerViewsUpdating");})),this.watch("tickInterval",(()=>this._restartTicking())),this.watch("view.ready",(()=>this._restartTicking()))]),this._restartTicking();}destroy(){this._handles&&(this._handles.destroy(),this._handles=null,this._intervalID&&clearInterval(this._intervalID),this._currentTick=0);}get tickInterval(){const e=this.view.allLayerViews.filter((e=>c$d(e)));return this._getCommonInterval(e)}_restartTicking(){this._currentTick=0,this._intervalID&&clearInterval(this._intervalID),this.get("view.ready")&&this.tickInterval&&(this._intervalID=setInterval((()=>{const e=Date.now();this._currentTick+=this.tickInterval,this.view.allLayerViews.forEach((r=>{if(c$d(r)){const t=Math.round(6e4*r.refreshInterval),s=this._currentTick%t==0,i=e-r.refreshTimestamp<.9*n$g;t&&s&&!i&&(r.refresh(e),this.emit("refresh",{layerView:r,timestamp:e,trigger:"interval"}));}}));}),this.tickInterval));}_getLayerViewHandles(){const e=[],r=()=>this.notifyChange("tickInterval");return this.view.allLayerViews.forEach((t=>{c$d(t)&&t.layer&&e.push(t.watch("refreshInterval",r),t.layer.on("refresh",(()=>{const e=Date.now();t.refresh(e),this.emit("refresh",{layerView:t,timestamp:e,trigger:"layer-refresh"});})));})),e}_getCommonInterval(e){const r=(e,t)=>isNaN(e)||isNaN(t)?0:t<=0?e:r(t,e%t);return e.toArray().reduce(((e,t)=>r(Math.round(6e4*t.refreshInterval),e)),0)}};e$c([y$c()],h$7.prototype,"view",void 0),e$c([y$c({readOnly:!0})],h$7.prototype,"tickInterval",null),h$7=e$c([n$s("esri.views.RefreshManager")],h$7);var o$7=h$7;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
const r$a=["click","double-click","immediate-click","immediate-double-click","hold","drag","key-down","key-up","pointer-down","pointer-move","pointer-up","pointer-drag","mouse-wheel","pointer-enter","pointer-leave","gamepad","focus","blur"],i$8={};function o$6(t){return !!i$8[t]}function s$a(t){for(const e of t)if(!o$6(e))return !1;return !0}r$a.forEach((t=>{i$8[t]=!0;}));class p$b{constructor(t){this.handlers=new Map,this.counter=0,this.handlerCounts=new Map,this.view=t,this.inputManager=null;}connect(t){t&&this.disconnect(),this.inputManager=t,this.handlers.forEach((({handler:t,priority:e},a)=>this.inputManager.installHandlers(a,[t],e)));}disconnect(){this.inputManager&&this.handlers.forEach(((t,e)=>this.inputManager.uninstallHandlers(e))),this.inputManager=null;}destroy(){this.disconnect(),this.handlers.clear(),this.view=null;}on(t,e,a,r){const i=Array.isArray(t)?t:t.split(",");if(!s$a(i))return i.some(o$6)&&console.error("Error: registering input events and other events on the view at the same time is not supported."),null;let p,l;Array.isArray(e)?l=e:(p=e,l=[]),"function"==typeof a?p=a:r=a,r=null!=r?r:u$b.DEFAULT;const u=this.createUniqueGroupName(),m=new c$c(this.view,i,l,p);this.handlers.set(u,{handler:m,priority:r});for(const n of i){const t=this.handlerCounts.get(n)||0;this.handlerCounts.set(n,t+1);}return this.inputManager&&this.inputManager.installHandlers(u,[m],r),{remove:()=>this.removeHandler(u,i)}}hasHandler(t){return !!this.handlerCounts.get(t)}removeHandler(t,e){if(this.handlers.has(t)){this.handlers.delete(t);for(const t of e){const e=this.handlerCounts.get(t);void 0===e?console.error("Trying to remove handler for event that has no handlers registered: ",t):1===e?this.handlerCounts.delete(t):this.handlerCounts.set(t,e-1);}}this.inputManager&&this.inputManager.uninstallHandlers(t);}createUniqueGroupName(){return this.counter+=1,`viewEvents_${this.counter}`}}class c$c extends i$b{constructor(t,e,a,n){super(!0),this.view=t;for(const r of e)switch(r){case"click":this.registerIncoming("click",a,(t=>n(this.wrapClick(t))));break;case"double-click":this.registerIncoming("double-click",a,(t=>n(this.wrapDoubleClick(t))));break;case"immediate-click":this.registerIncoming("immediate-click",a,(t=>n(this.wrapImmediateClick(t))));break;case"immediate-double-click":this.registerIncoming("immediate-double-click",a,(t=>n(this.wrapImmediateDoubleClick(t))));break;case"hold":this.registerIncoming("hold",a,(t=>n(this.wrapHold(t))));break;case"drag":this.registerIncoming("drag",a,(t=>{const e=this.wrapDrag(t);e&&n(e);}));break;case"key-down":this.registerIncoming("key-down",a,(t=>n(this.wrapKeyDown(t))));break;case"key-up":this.registerIncoming("key-up",a,(t=>n(this.wrapKeyUp(t))));break;case"pointer-down":this.registerIncoming("pointer-down",a,(t=>n(this.wrapPointer(t,"pointer-down"))));break;case"pointer-move":this.registerIncoming("pointer-move",a,(t=>n(this.wrapPointer(t,"pointer-move"))));break;case"pointer-up":this.registerIncoming("pointer-up",a,(t=>n(this.wrapPointer(t,"pointer-up"))));break;case"pointer-drag":this.registerIncoming("pointer-drag",a,(t=>n(this.wrapPointerDrag(t))));break;case"mouse-wheel":this.registerIncoming("mouse-wheel",a,(t=>n(this.wrapMouseWheel(t))));break;case"pointer-enter":this.registerIncoming("pointer-enter",a,(t=>n(this.wrapPointer(t,"pointer-enter"))));break;case"pointer-leave":this.registerIncoming("pointer-leave",a,(t=>n(this.wrapPointer(t,"pointer-leave"))));break;case"gamepad":this.registerIncoming("gamepad",a,(t=>{n(this.wrapGamepad(t));}));break;case"focus":this.registerIncoming("focus",a,(t=>{n(this.wrapFocus(t));}));break;case"blur":this.registerIncoming("blur",a,(t=>{n(this.wrapBlur(t));}));}}wrapFocus(t){return {type:"focus",timestamp:t.timestamp,native:t.data.native,cancelable:t.cancelable,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}wrapBlur(t){return {type:"blur",timestamp:t.timestamp,native:t.data.native,cancelable:t.cancelable,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}wrapClick(t){const{pointerType:a,button:n,buttons:r,x:i,y:o,native:s,eventId:p}=t.data,{cancelable:c,timestamp:l}=t;return {type:"click",pointerType:a,button:n,buttons:r,x:i,y:o,native:s,timestamp:l,screenPoint:c$B(i,o),mapPoint:this.getMapPoint(i,o),eventId:p,cancelable:c,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}wrapDoubleClick(t){const{pointerType:e,button:a,buttons:n,x:r,y:i,native:o,eventId:s}=t.data,{cancelable:p,timestamp:c}=t;return {type:"double-click",pointerType:e,button:a,buttons:n,x:r,y:i,native:o,timestamp:c,mapPoint:this.getMapPoint(r,i),eventId:s,cancelable:p,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}wrapImmediateClick(t){const{pointerType:e,button:a,buttons:n,x:r,y:i,native:o,eventId:s}=t.data,p=o.pointerId,{cancelable:c,timestamp:l}=t;return {type:"immediate-click",pointerId:p,pointerType:e,button:a,buttons:n,x:r,y:i,native:o,timestamp:l,mapPoint:this.getMapPoint(r,i),eventId:s,cancelable:c,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}wrapImmediateDoubleClick(t){const{pointerType:e,button:a,buttons:n,x:r,y:i,native:o,eventId:s}=t.data,p=o.pointerId,{cancelable:c,timestamp:l}=t;return {type:"immediate-double-click",pointerId:p,pointerType:e,button:a,buttons:n,x:r,y:i,native:o,timestamp:l,mapPoint:this.getMapPoint(r,i),eventId:s,cancelable:c,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}wrapHold(t){const{pointerType:e,button:a,buttons:n,x:r,y:i,native:o}=t.data,{cancelable:s,timestamp:p}=t;return {type:"hold",pointerType:e,button:a,buttons:n,x:r,y:i,native:o,timestamp:p,mapPoint:this.getMapPoint(r,i),cancelable:s,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}getMapPoint(t,a){return this.view.toMap(c$B(t,a),{exclude:[]})}wrapDrag(e){const a=e.data,{x:n,y:r}=a.center,{action:i,pointerType:o,button:s}=a;if("start"===i&&(this.latestDragStart=a),!this.latestDragStart)return;const p=a.pointer.native,c=a.buttons,{cancelable:l,timestamp:u}=e,m={x:this.latestDragStart.center.x,y:this.latestDragStart.center.y};return "end"===i&&(this.latestDragStart=void 0),{type:"drag",action:i,x:n,y:r,origin:m,pointerType:o,button:s,buttons:c,radius:a.radius,angle:N$3(a.angle),native:p,timestamp:u,cancelable:l,stopPropagation:()=>e.stopPropagation(),async:t=>e.async(t),preventDefault:()=>e.preventDefault()}}wrapKeyDown(t){const{key:e,repeat:a,native:n}=t.data,{cancelable:r,timestamp:i}=t;return {type:"key-down",key:e,repeat:a,native:n,timestamp:i,cancelable:r,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}wrapKeyUp(t){const{key:e,native:a}=t.data,{cancelable:n,timestamp:r}=t;return {type:"key-up",key:e,native:a,timestamp:r,cancelable:n,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}wrapPointer(t,e){const{x:a,y:n,button:r,buttons:i,native:o,eventId:s}=t.data,p=o.pointerId,c=o.pointerType,{cancelable:l,timestamp:u}=t;return {type:e,x:a,y:n,pointerId:p,pointerType:c,button:r,buttons:i,native:o,timestamp:u,eventId:s,cancelable:l,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}wrapPointerDrag(t){const{x:e,y:a,buttons:n,native:r,eventId:i}=t.data.currentEvent,{button:o}=t.data.startEvent,s=t.data.startEvent.native.pointerId,p=t.data.startEvent.native.pointerType,c=t.data.action,l={x:t.data.startEvent.x,y:t.data.startEvent.y},{cancelable:u,timestamp:m}=t;return {type:"pointer-drag",x:e,y:a,pointerId:s,pointerType:p,button:o,buttons:n,action:c,origin:l,native:r,timestamp:m,eventId:i,cancelable:u,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}wrapMouseWheel(t){const{cancelable:e,data:a,timestamp:n}=t,{x:r,y:i,deltaY:o,native:s}=a;return {type:"mouse-wheel",x:r,y:i,deltaY:o,native:s,timestamp:n,cancelable:e,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}wrapGamepad(t){const{action:e,state:a,device:n}=t.data,{cancelable:r,timestamp:i}=t,{buttons:o,axes:s}=a;return {type:"gamepad",device:n,timestamp:i,action:e,buttons:o,axes:s,cancelable:r,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
function i$7(t,e){const o=t.view;o&&(e&&o.ready&&o.activeTool!==t?(o.activeTool=t,g$8(o)&&o.focus()):e||o.activeTool!==t||(o.activeTool=null));}function n$f(t,o,a){const i=t.activeTool;o!==i&&(r$g(i)&&i.deactivate&&i.deactivate(),a(o),r$g(o)&&o.activate&&o.activate());}function c$b(){const e=new L$3;return e.on("after-add",(t=>{const e=t.item;e.view&&e.view.ready&&e.attach();})),e.on("after-remove",(t=>{const e=t.item;i$7(e,!1),e.destroyed||e.detach();})),e}function r$9(t){return !1!==t.visible&&!1!==t.editable&&(null==t.hasEditableFlag||t.hasEditableFlag(1))}function l$7(t){return t$f(t)?{}:"function"==typeof t?t():t}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
function c$a(c){return c$B(c.x,c.y)}function t$6(c,t){const n=(c instanceof HTMLElement?c:c.surface).getBoundingClientRect();return c$B(t.clientX-n.left,t.clientY-n.top)}function n$e(e,n){return n instanceof Event?t$6(e,n):c$a(n)}function i$6(e){if(e instanceof Event)return !0;if("object"==typeof e&&"type"in e){switch(e.type){case"click":case"double-click":case"pointer-down":case"pointer-drag":case"pointer-enter":case"pointer-leave":case"pointer-up":case"pointer-move":case"immediate-click":case"immediate-double-click":case"hold":case"drag":case"mouse-wheel":return !0;case"key-down":case"key-up":case"gamepad":case"focus":case"blur":default:return !1}}return !1}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
class p$a{constructor(){this._pointerLocations=new Map,this._hoveredManipulators=new Map,this._grabbedManipulators=new Map,this._draggedManipulators=new Map,this._stopDrag=!1,this._revertToActiveTool=null,this._cursor=null;}get cursor(){return this._cursor}handleInputEvent(t,a){const s=()=>t.stopPropagation();switch(t.type){case"pointer-move":c$9(t.pointerType)&&this._pointerLocations.set(t.pointerId,{x:t.x,y:t.y,pointerType:t.pointerType});break;case"drag":this._grabbedManipulators.size>0&&(this._stopDrag=!0),this._stopDrag&&(s(),"end"===t.action&&(this._stopDrag=!1));break;case"pointer-down":{if(!u$6(t))break;const e=c$a(t),n=this._intersect(e,t.pointerType,a.forEachTool);if(t$f(n))break;const p=this._findToolAndManipulatorByKey(n,a.forEachTool,h$6),c=o$j(p,(t=>t.manipulator)),d=o$j(p,(t=>t.tool));!(r$g(c)&&r$g(d)&&c.interactive)||c.grabbable&&c.grabbableForEvent(t)||!c.grabbing||c.dragging||this._ungrabManipulatorBeforeDragging(c,d,t),r$g(c)&&c.interactive&&c.grabbable&&c.grabbableForEvent(t)&&!c.grabbing&&(this._grabbedManipulators.set(t.pointerId,{key:n,start:e}),1===this._grabbedManipulators.size&&(this._revertToActiveTool=a.activeTool,a.setActiveTool(n.tool)),c.grabbing=!0,c.events.emit("grab-changed",{action:"start",screenPoint:e}),s());break}case"pointer-up":this._handlePointerEnd(t,a);break;case"pointer-drag":{if(!u$6(t))break;const o=this._grabbedManipulators.get(t.pointerId),p=this._draggedManipulators.get(t.pointerId),c=o$j(o||p,(({key:t})=>t)),d=this._findManipulatorByKey(c,a.forEachTool);if(t$f(d))break;const h=c$a(t);h.x=o$f(h.x,0,a.view.width),h.y=o$f(h.y,0,a.view.height);const g=e$f(o||p).start;switch(t.action){case"start":case"update":"update"!==t.action&&1!==this._grabbedManipulators.size||(d.dragging=!0,p?d.events.emit("drag",{action:"update",start:g,screenPoint:h}):d.events.emit("drag",{action:"start",start:g,screenPoint:h,pointerType:t.pointerType}),this._draggedManipulators.set(t.pointerId,{key:e$f(c),start:g}));break;case"end":d.dragging=!1,p&&d.events.emit("drag",{action:"end",start:g,screenPoint:h}),this._draggedManipulators.delete(t.pointerId),this._handlePointerEnd(t,a);}s();break}case"immediate-click":{const e=c$a(t),r=this._intersect(e,t.pointerType,a.forEachTool),n=this._findToolAndManipulatorByKey(r,a.forEachTool,h$6);if(d$4(t)||a.forEachTool((t=>{if((!r$g(n)||n.tool!==t||!t.selectionManagementDisabled)&&t.manipulators){let e=!1;t.manipulators.forEach((({manipulator:t})=>{t.selected&&(t.selected=!1,e=!0);})),e&&t.manipulatorSelectionChanged&&t.manipulatorSelectionChanged();}})),t$f(n))break;const{manipulator:p,tool:c}=n;if(!p.interactive)break;p.selectable&&!c.selectionManagementDisabled&&(p.selected=!p.selected,c.manipulatorSelectionChanged&&c.manipulatorSelectionChanged());const u=t.native.shiftKey;p.events.emit("immediate-click",{screenPoint:e,button:t.button,pointerType:t.pointerType,shiftKey:u,stopPropagation:s});break}case"click":{const e=c$a(t),o=this._intersect(e,t.pointerType,a.forEachTool),r=this._findManipulatorByKey(o,a.forEachTool);if(t$f(r)||!r.interactive)break;const n=t.native.shiftKey;r.events.emit(t.type,{screenPoint:e,button:t.button,pointerType:t.pointerType,shiftKey:n}),s();break}case"double-click":{const e=c$a(t),o=this._intersect(e,t.pointerType,a.forEachTool),r=this._findManipulatorByKey(o,a.forEachTool);if(t$f(r)||!r.interactive)break;const n=t.native.shiftKey;r.events.emit("double-click",{screenPoint:e,button:t.button,pointerType:t.pointerType,shiftKey:n,stopPropagation:s});break}case"immediate-double-click":{const e=c$a(t),o=this._intersect(e,t.pointerType,a.forEachTool),r=this._findManipulatorByKey(o,a.forEachTool);if(t$f(r)||!r.interactive)break;const n=t.native.shiftKey;r.events.emit("immediate-double-click",{screenPoint:e,button:t.button,pointerType:t.pointerType,shiftKey:n,stopPropagation:s});break}}this._updateCursor(a.forEachTool);}_ungrabManipulatorBeforeDragging(t,e,i){t.grabbing=!1,t.events.emit("grab-changed",{action:"end",screenPoint:c$a(i)}),this._grabbedManipulators.forEach((({key:i},o)=>{i.tool===e&&e.manipulators.findById(i.manipulatorId)===t&&this._grabbedManipulators.delete(o);}));}_handlePointerEnd(t,e){const i=o$j(this._grabbedManipulators.get(t.pointerId),(({key:t})=>t)),a=this._findManipulatorByKey(i,e.forEachTool);if(r$g(a)&&!a.dragging){const r=r$g(e.creatingTool)&&e.creatingTool===e$f(i).tool;1!==this._grabbedManipulators.size||0!==this._draggedManipulators.size||r||(e.setActiveTool(this._revertToActiveTool),this._revertToActiveTool=null),a.grabbing&&(a.grabbing=!1,a.events.emit("grab-changed",{action:"end",screenPoint:c$a(t)})),this._grabbedManipulators.delete(t.pointerId);}}_cursorFromMap(e,i){let r=null;return n$h(e,(({key:t})=>{const e=this._findManipulatorByKey(t,i);return !!(r$g(e)&&e.interactive&&"cursor"in e&&e.cursor)&&(r=e.cursor,!0)})),r}_updateCursor(t){this._grabbedManipulators.size>0?this._cursor=this._cursorFromMap(this._grabbedManipulators,t)||"grabbing":this._hoveredManipulators.size>0?this._cursor=this._cursorFromMap(this._hoveredManipulators,t)||"pointer":this._cursor=null;}clearPointers(t,e,r=!0,n){const a=e=>e.tool===t&&(t$f(n)||e.manipulatorId===n);this._grabbedManipulators.forEach((({key:t},i)=>{if(a(t)){this._grabbedManipulators.delete(i);const r=this._findManipulatorByKey(t,e);r$g(r)&&(r.grabbing=!1,r.events.emit("grab-changed",{action:"end",screenPoint:null}));}})),this._draggedManipulators.forEach((({key:t},i)=>{if(a(t)){this._draggedManipulators.delete(i);const r=this._findManipulatorByKey(t,e);r$g(r)&&(r.dragging=!1,r.events.emit("drag",{action:"cancel"}));}})),r&&this._hoveredManipulators.forEach((({key:t},i)=>{if(a(t)){this._hoveredManipulators.delete(i);const r=this._findManipulatorByKey(t,e);r$g(r)&&(r.hovering=!1);}})),this._updateCursor(e);}_intersect(t,e,o){let r=null;return o((o=>{if(null==o.manipulators||!r$9(o))return !1;const n=o.manipulators.intersect(t,e);return !t$f(n)&&(r={manipulatorId:n.id,tool:o},!0)})),r}updateHoveredStateFromKnownPointers(t){this._pointerLocations.forEach(((e,i)=>{this._updateHoveredStateForPointerAtScreenPosition(c$B(e.x,e.y),i,e.pointerType,t);}));}handleHoverEvent(t,e){"pointer-up"!==t.type&&"immediate-click"!==t.type&&"pointer-move"!==t.type||!c$9(t.pointerType)||this._updateHoveredStateForPointerAtScreenPosition(c$a(t),t.pointerId,t.pointerType,e);}_updateHoveredStateForPointerAtScreenPosition(t,e,i,a){const s=this._intersect(t,i,a);let l=this._findManipulatorByKey(s,a);const p=o$j(this._hoveredManipulators.get(e),(({key:t})=>t)),c=this._findManipulatorByKey(p,a);r$g(l)&&!l.interactive&&(l=null),c!==l&&(r$g(c)&&(c.hovering=!1),r$g(l)?(l.hovering=!0,this._hoveredManipulators.set(e,{key:e$f(s)})):this._hoveredManipulators.delete(e),this._updateCursor(a));}_findManipulatorByKey(t,e){return this._findToolAndManipulatorByKey(t,e,h$6)?h$6.manipulator:null}_findToolAndManipulatorByKey(t,e,r){return t$f(t)?null:(r.tool=null,r.manipulator=null,e((e=>{if(e!==t.tool||null==e.manipulators||!r$9(e))return !1;const i=e.manipulators.findById(t.manipulatorId);return !!r$g(i)&&(r.manipulator=i,r.tool=e,!0)})),r.manipulator?r:null)}}function c$9(t){return "mouse"===t}function u$6(t){return "mouse"!==t.pointerType||0===t.button}function d$4(t){return !!t.native.shiftKey}const h$6={manipulator:null,tool:null};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
const y$3=n$t.getLogger("esri.views.ToolViewManager"),j="manipulators",b$1="tools";let C$2=class extends d$g{constructor(t){super(t),this._creatingTool=null,this._manipulatorState=new p$a,this.tools=c$b(),this.cursor=null,this._forEachTool=t=>{if(!r$g(this._creatingTool)||!t(this._creatingTool))for(const o of this.tools.items)if(t(o))return};}initialize(){this.handles.add([this.view.on(r$a,(t=>{this._handleInputEvent(t);}),u$b.TOOL),this.tools.on("before-add",(t=>{const o=t.item;null==o||this.tools.includes(o)?t.preventDefault():null==o.created||o.created||(y$3.error("tools","Tool can not be added to view before it has been created"),t.preventDefault());})),this.tools.on("before-remove",(({item:t})=>{this._manipulatorState.clearPointers(t,this._forEachTool);})),this.tools.on("change",(()=>{this._refreshToolWatchers();}))]);}destroy(){this._forEachTool((t=>t.destroy()));}set activeTool(t){!r$g(t)||this.view.ready?(n$f(this,t,(o=>{this._set("activeTool",o),this._removeIncompleteTools(t),this._forEachTool((t=>{const o=t$f(this.activeTool)||t===this.activeTool;t.setEditableFlag&&t.setEditableFlag(1,o);const e=r$9(t);!t$f(this.activeTool)&&e||this._manipulatorState.clearPointers(t,this._forEachTool,!e);})),this._updateCursor();})),this._creatingTool!==t&&this._rejectCreatingTool()):y$3.error("#activeTool=","cannot set active tool while view is not ready");}get updating(){return this.updatingHandles.updating||this.tools.some((t=>t.updating))}async createTool(t,e,i){const a="Tool creation was interrupted by another tool being created",{abortHandle:s,tool:h}=await this.updatingHandles.addPromise((async()=>{await this.view.whenReady(),a$k(i,a);const o=v$9(i,(()=>this.activeTool=null)),r=l$7(e),s=new t({...r,view:this.view});return await s.whenCreationStarted(),a$k(i,a),{abortHandle:o,tool:s}})());return this._rejectCreatingTool(a),this._creatingTool=h,h.attach(),this._refreshToolWatchers(),i$7(h,!0),await h.when(),r$g(s)&&s.remove(),this._creatingTool=null,a$k(i,a),this.tools.add(h),h instanceof p$q&&null!=h.completed&&j$5(h,"completed").then((()=>{i$7(h,!1);})),h}attach(){this._forEachTool((t=>t.attach())),"3d"===this.view.type?this.handles.add([this.view.state.watch("camera",(()=>{this.forEachManipulator((t=>{null!=t.onViewChange&&t.onViewChange();}));})),this.view.elevationProvider.on("elevation-change",(t=>{this.forEachManipulator((o=>{null!=o.onElevationChange&&o.onElevationChange(t);}));}))],j):this.handles.add(this.view.watch("extent",(()=>{this.forEachManipulator((t=>{null!=t.onViewChange&&t.onViewChange();}));})));}detach(){this.activeTool=null,this._forEachTool((t=>{t.detach(),t.destroy();})),this.tools.removeAll(),this.handles.remove(j);}forEachManipulator(t){this._forEachTool((o=>{o.manipulators&&o.manipulators.forEach((({manipulator:e})=>t(e,o)));}));}_handleInputEvent(t){let o=!1;const e={...t,stopPropagation:()=>{o=!0,t.stopPropagation();}};r$g(this.activeTool)?this.activeTool.handleInputEvent&&this.activeTool.handleInputEvent(e):this._forEachTool((t=>{!o&&!1!==t.visible&&t.handleInputEvent&&t.handleInputEvent(e);})),!o&&"key-down"===t.type&&"Escape"===t.key&&this.activeTool&&(t.stopPropagation(),this.activeTool=null),this._manipulatorState.handleInputEvent(e,{forEachTool:this._forEachTool,activeTool:this.activeTool,setActiveTool:t=>{this.activeTool=t;},creatingTool:this._creatingTool,view:this.view}),!o&&r$g(this.activeTool)&&this.activeTool.handleInputEventAfter&&this.activeTool.handleInputEventAfter(e),this._manipulatorState.handleHoverEvent(e,this._forEachTool),this._updateCursor();}_refreshToolWatchers(){this.handles.remove(b$1),this._forEachTool((t=>{if(t instanceof p$q){const o=h$h(t,["cursor","visible","editable"],(()=>{r$9(t)||this._manipulatorState.clearPointers(t,this._forEachTool),this._updateCursor();}));this.handles.add(o,b$1);}t.manipulators&&this.handles.add(t.manipulators.on("change",(o=>{o.removed.forEach((({id:o})=>{this._manipulatorState.clearPointers(t,this._forEachTool,!0,o);})),this._manipulatorState.updateHoveredStateFromKnownPointers(this._forEachTool),this._updateCursor();})),b$1);})),this._manipulatorState.updateHoveredStateFromKnownPointers(this._forEachTool),this._updateCursor();}_updateCursor(){let t=null;this._forEachTool((o=>null!=o.cursor&&!1!==o.visible&&(t=o.cursor,!0))),t||(t=this._manipulatorState.cursor),this._get("cursor")!==t&&this._set("cursor",t);}_rejectCreatingTool(t){const o=this._creatingTool;t$f(o)||(this._manipulatorState.clearPointers(o,this._forEachTool),o.rejectCreation&&o.rejectCreation(m$g(t)),i$7(o,!1),"destroyed"!==o.toolState&&o.destroy(),this._creatingTool=null,this._refreshToolWatchers());}_removeIncompleteTools(t){this.tools.filter((o=>(t$f(t)||o!==t)&&null!=o.completed&&!o.completed)).forEach((t=>{this.tools.remove(t);}));}};e$c([y$c({constructOnly:!0,nonNullable:!0})],C$2.prototype,"view",void 0),e$c([y$c({value:null})],C$2.prototype,"activeTool",null),e$c([y$c({readOnly:!0,type:L$3})],C$2.prototype,"tools",void 0),e$c([y$c({readOnly:!0})],C$2.prototype,"cursor",void 0),e$c([y$c({readOnly:!0})],C$2.prototype,"updating",null),C$2=e$c([n$s("esri.views.ToolViewManager")],C$2);var S$1=C$2;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
let o$5=class extends p$q{constructor(e){super(),this.nativeIndex=null,this._detectedDeviceType="unknown","standard"===e.mapping?this._detectedDeviceType="standard":n$d.test(e.id)?this._detectedDeviceType="spacemouse":this._detectedDeviceType="unknown",this.nativeIndex=e.index;}get native(){return (navigator.getGamepads?navigator.getGamepads():[])[this.nativeIndex]}get deviceType(){return this._detectedDeviceType}get axisThreshold(){return p$9[this.deviceType]}};e$c([y$c({nonNullable:!0,readOnly:!0})],o$5.prototype,"nativeIndex",void 0),e$c([y$c({type:String,readOnly:!0})],o$5.prototype,"deviceType",null),e$c([y$c({type:Number,readOnly:!0})],o$5.prototype,"axisThreshold",null),o$5=e$c([n$s("esri.views.input.gamepad.GamepadInputDevice")],o$5);const n$d=new RegExp("^(3dconnexion|space(mouse|navigator|pilot|explorer))","i"),p$9={standard:.15,spacemouse:.025,unknown:0};var i$5=o$5;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
let c$8=class extends p$q{constructor(...e){super(...e),this.devices=new L$3,this.enabledFocusMode="document";}};e$c([y$c({type:L$3.ofType(i$5),readOnly:!0})],c$8.prototype,"devices",void 0),e$c([y$c({type:["document","view","none"]})],c$8.prototype,"enabledFocusMode",void 0),c$8=e$c([n$s("esri.views.input.gamepad.GamepadSettings")],c$8);var i$4=c$8;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
let p$8=class extends p$q{constructor(){super(...arguments),this.gamepad=new i$4;}};e$c([y$c({readOnly:!0})],p$8.prototype,"gamepad",void 0),p$8=e$c([n$s("esri.views.input.Input")],p$8);var c$7=p$8;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
let s$9=class extends p$q{constructor(o){super(o),this.enabled=!0,this.device=null,this.mode="pan",this.tiltDirection="forward-down",this.velocityFactor=1;}};e$c([y$c({type:Boolean,nonNullable:!0})],s$9.prototype,"enabled",void 0),e$c([y$c({type:i$5})],s$9.prototype,"device",void 0),e$c([y$c({type:["pan","zoom"],nonNullable:!0})],s$9.prototype,"mode",void 0),e$c([y$c({type:["forward-down","forward-up"],nonNullable:!0})],s$9.prototype,"tiltDirection",void 0),e$c([y$c({type:Number,nonNullable:!0})],s$9.prototype,"velocityFactor",void 0),s$9=e$c([n$s("esri.views.navigation.gamepad.GamepadSettings")],s$9);var i$3=s$9;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
let a$7=class extends p$q{constructor(o){super(o),this.browserTouchPanEnabled=!0,this.gamepad=new i$3,this.momentumEnabled=!0,this.mouseWheelZoomEnabled=!0;}};e$c([y$c({type:Boolean})],a$7.prototype,"browserTouchPanEnabled",void 0),e$c([y$c({type:i$3,nonNullable:!0})],a$7.prototype,"gamepad",void 0),e$c([y$c({type:Boolean})],a$7.prototype,"momentumEnabled",void 0),e$c([y$c({type:Boolean})],a$7.prototype,"mouseWheelZoomEnabled",void 0),a$7=e$c([n$s("esri.views.navigation.Navigation")],a$7);var p$7=a$7;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
function r$8(t,i,a){const r=l$6(t),c=i,h=s$8(r,c,a);{let i=null;if(r){const s=v$a.deriveUnitFromSR(r,t.spatialReference).heightUnit;a||s===r.heightUnit||(i=new s$j("layerview:unmatched-height-unit",`The vertical units of the layer must match the horizontal units (${s})`,{horizontalUnit:s}));}if(!o$4(t)||4===h||i)return new s$j("layerview:unsupported-height-model-info","The vertical coordinate system of the layer is not supported",{heightModelInfo:r,error:i})}{let t=null;switch(h){case 1:{const n=r.heightUnit||"unknown",i=c.heightUnit||"unknown";t=new s$j("layerview:incompatible-height-unit",`The vertical units of the layer (${n}) must match the vertical units of the scene (${i})`,{layerUnit:n,sceneUnit:i});break}case 2:{const n=r.heightModel||"unknown",i=c.heightModel||"unknown";t=new s$j("layerview:incompatible-height-model",`The height model of the layer (${n}) must match the height model of the scene (${i})`,{layerHeightModel:n,sceneHeightModel:i});break}case 3:{const n=r.vertCRS||"unknown",i=c.vertCRS||"unknown";t=new s$j("layerview:incompatible-vertical-datum",`The vertical datum of the layer (${n}) must match the vertical datum of the scene (${i})`,{layerDatum:n,sceneDatum:i});break}}if(t)return new s$j("layerview:incompatible-height-model-info","The vertical coordinate system of the layer is incompatible with the scene",{layerHeightModelInfo:r,sceneHeightModelInfo:c,error:t})}return null}function s$8(e,t,n){if(!c$6(e)||!c$6(t))return 4;if(null==e||null==t)return 0;if(!n&&e.heightUnit!==t.heightUnit)return 1;if(e.heightModel!==t.heightModel)return 2;switch(e.heightModel){case"gravity-related-height":return 0;case"ellipsoidal":return e.vertCRS===t.vertCRS?0:3;default:return 4}}function c$6(e){return null==e||null!=e.heightModel&&null!=e.heightUnit}function o$4(e){return "heightModelInfo"in e&&null!=e.heightModelInfo||null!=e.spatialReference||!m$5(e)}function l$6(e){const a=e.url&&d$k(e.url);return !(null==(e.spatialReference&&e.spatialReference.vcsWkid)&&r$g(a)&&"ImageServer"===a.serverType)&&h$5(e)&&e.heightModelInfo?e.heightModelInfo:m$5(e)?v$a.deriveUnitFromSR(p$6,e.spatialReference):null}function h$5(e){return "heightModelInfo"in e}function u$5(e){if("unknown"===e.type||!("capabilities"in e))return !1;switch(e.type){case"csv":case"feature":case"geojson":case"subtype-group":case"ogc-feature":case"wfs":return !0;case"imagery":case"map-image":case"map-notes":case"tile":case"vector-tile":case"scene":case null:default:return !1}}function m$5(e){return u$5(e)?!!(e.capabilities&&e.capabilities.data&&e.capabilities.data.supportsZ):g$5(e)}function f$3(e){return null!=e.layers||g$5(e)||u$5(e)||h$5(e)}function g$5(e){switch(e.type){case"building-scene":case"elevation":case"integrated-mesh":case"point-cloud":case"scene":case"voxel":case"slice":return !0;case"base-dynamic":case"base-elevation":case"base-tile":case"bing-maps":case"csv":case"direct-line-measurement":case"area-measurement":case"geojson":case"feature":case"subtype-group":case"geo-rss":case"graphics":case"group":case"imagery":case"imagery-tile":case"kml":case"line-of-sight":case"map-image":case"map-notes":case"ogc-feature":case"open-street-map":case"route":case"stream":case"tile":case"unknown":case"unsupported":case"vector-tile":case"wcs":case"web-tile":case"wfs":case"wms":case"wmts":case null:return !1}return !1}const p$6=new v$a({heightModel:"gravity-related-height"});

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
var f$2;const g$4=n$t.getLogger("esri.views.support.DefaultsFromMap"),_$2=10;let m$4=f$2=class extends p$q{constructor(){super(...arguments),this._handles=new u$g,this._waitTask=null,this._extentProjectController=null,this._spatialReferenceCandidates=null,this._extentCandidates=null,this.logDebugInformation=!1,this.isSpatialReferenceDone=!1,this.isTileInfoDone=!1,this.isHeightModelInfoSearching=!1,this.spatialReference=null,this.extent=null,this.heightModelInfo=null,this.vcsWkid=null,this.latestVcsWkid=null,this.mapCollectionPaths=f$2.DefaultMapCollectionPaths.slice(),this.tileInfo=null;}initialize(){this.watch("mapCollectionPaths",(()=>{this._running&&(this.reset(),this.start());}));}destroy(){this._set("view",null),this._handles&&(this._handles.destroy(),this._handles=null),this._cancelLoading();}get _running(){return !!(this._handles&&this._handles.size>0)}reset(){this._handles.removeAll(),this._set("isSpatialReferenceDone",!1),this._set("isTileInfoDone",!1),this._set("isHeightModelInfoSearching",!1),this._set("spatialReference",null),this._set("extent",null),this._set("heightModelInfo",null),this._set("vcsWkid",null),this._set("latestVcsWkid",null),this._set("tileInfo",null),this._spatialReferenceCandidates=null,this._extentCandidates=null;}start(){this._handles.removeAll();const e=this._updateLayerChange.bind(this);for(const t of this.mapCollectionPaths)this._handles.add(C$4(this.view,`map.${t}`,"change",e,e,e,!0));this._handles.add(y$e(this,"isSpatialReferenceDone",(()=>this._updateTileInfo()),!0));}_ownerNameFromCollectionName(e){const t=e.lastIndexOf(".");return -1===t?"view":"view."+e.slice(0,t)}_ensureLoadedOwnersFromCollectionName(e){const t=this._ownerNameFromCollectionName(e).split(".");let i;for(let s=0;s<t.length&&(i=this.get(t.slice(0,s+1).join(".")),i);s++)if(i.load&&!i.isFulfilled())return {collectionName:e,owner:null,loading:i.load().catch((()=>{}))};return {collectionName:e,owner:i}}_cancelLoading(){this._waitTask=null,this._extentProjectController&&(this._extentProjectController.abort(),this._extentProjectController=null);}_updateWhen(e){let t=!0,i=!1;const s=e.catch((()=>{})).then((()=>{t?i=!0:s===this._waitTask&&this._update();}));return t=!1,i||(this._waitTask=s),i}_updateLayerChange(){this.isSpatialReferenceDone&&!this.spatialReference&&this._set("isSpatialReferenceDone",!1),this._update();}_update(){if(this._cancelLoading(),this.view){if(!this.isSpatialReferenceDone){this._debugLog("Starting search for spatial reference...");const e=this._processMapCollections((e=>this._processSpatialReferenceSource(e)));if(this._debugLog(`Search ended with status '${y$2(e)}'`),0!==e){let e=null,t=this._spatialReferenceCandidates;if(!t||t.length<1?(e=this.defaultSpatialReference,this._debugLog(`No spatial reference found, locking to default (${S(e)})`)):(this.defaultSpatialReference&&t.length>1&&t.findIndex((e=>e.equals(this.defaultSpatialReference)))>-1&&(t=[this.defaultSpatialReference]),e=t[0],this._debugLog(`Locking to ${S(e)}`)),this._set("spatialReference",e),e)if(this.extent)this._set("isSpatialReferenceDone",!0);else {const t=this.logDebugInformation;this.logDebugInformation=!1,this._processMapCollections((t=>this._findExtent(t,e))),this.logDebugInformation=t,this._projectExtentCandidate().catch((()=>{})).then((()=>this._set("isSpatialReferenceDone",!0)));}else this._set("isSpatialReferenceDone",!0);}}if(null==this.heightModelInfo&&this.view.isHeightModelInfoRequired){this._debugLog("Starting search for height model info...");const e=this._processMapCollections((e=>this._processHeightModelInfoSource(e)),(e=>f$3(e)));this._debugLog(`Search ended with status ${y$2(e)}`),this._set("isHeightModelInfoSearching",0===e);}this._updateTileInfo();}}_processMapCollections(e,t){this._preloadMapCollections(t);let i=2;return this._forAllMapCollectionSources((e=>{if(2!==i)return !1;const{collectionName:t}=e;return this._debugLog(`Processing collection ${t}...`),!(e.loading&&!this._updateWhen(e.loading))||(this._debugLog(`Collection ${e.collectionName} owner is loading -> wait`),i=0,!1)}),(s=>{if(2!==i)return !1;return null!=t&&!t(s)?(this._debugLog(`Source ${s.id} is skipped due to predicate`),!1):!s.load||s.isFulfilled()||this._updateWhen(s.load())?!((!s.load||s.isResolved())&&e(s))||(i=1,!1):(this._debugLog(`Source ${s.id} is loading -> wait`),i=0,!1)})),i}_preloadMapCollections(e){let t=_$2;const i=this.logDebugInformation;this.logDebugInformation=!1,this._forAllMapCollectionSources((()=>!0),(s=>{if(0===t)return !1;return !(null!=e&&!e(s))&&(s.load&&!s.isFulfilled()&&(this.logDebugInformation=i,this._debugLog(`Pre-loading source ${s.id}`),this.logDebugInformation=!1,s.load().catch((()=>{})),t--),!0)})),this.logDebugInformation=i;}_forAllMapCollectionSources(e,t){for(const i of this.mapCollectionPaths){const s=`map.${i}`,o=this._ensureLoadedOwnersFromCollectionName(s);if(!1===e(o))continue;const n=o.owner;if(!n||n.isRejected&&n.isRejected()){this._debugLog(`Collection ${s} owner is invalid or rejected -> skip`);continue}const a=this.view.get(s);a?this._forEachSource(a,t):this._debugLog(`Collection ${s} does not exist -> skip`);}}_forEachSource(e,t){for(const i of e.items)!1!==t(i)&&"layers"in i&&i.layers&&this._forEachSource(i.layers,t);}_processSpatialReferenceSource(e){let t=this._getSupportedSpatialReferences(e);return 0!==t.length&&(this._spatialReferenceCandidates?(t=s$o(t,this._spatialReferenceCandidates,((e,t)=>e.equals(t))),t.length>0?this._spatialReferenceCandidates=t:this._debugLog(`Layer ${e.id} is ignored because its supported spatial\n          references are not compatible with the previous candidates`)):this._spatialReferenceCandidates=t,1===this._spatialReferenceCandidates.length)}_findExtent(e,t){const i="fullExtents"in e&&e.fullExtents||(e.fullExtent?[e.fullExtent]:[]),s=i.find((e=>e.spatialReference.equals(t)));if(s)return this._set("extent",s),!0;if(this._getSupportedSpatialReferences(e).length>0){const t=i.map((t=>({extent:t,layer:e}))),s=this._extentCandidates||[];this._extentCandidates=s.concat(t);}return !1}async _projectExtentCandidate(){if(!this._extentCandidates||!this._extentCandidates.length)return;const e=this.spatialReference,t=this._extentCandidates.find((t=>x$4(t.extent.spatialReference,e)));if(t)this._set("extent",g$i(t.extent,e));else {const t=this._extentCandidates[0];this._extentProjectController=h$g();const i=await import('./geometryServiceUtils-83e1d118.js');try{const s=await i.projectGeometry(t.extent,e,t.layer.portalItem,this._extentProjectController.signal);this._set("extent",s);}catch{}this._extentProjectController=null;}}_getSupportedSpatialReferences(e){const t="supportedSpatialReferences"in e&&e.supportedSpatialReferences||(e.spatialReference?[e.spatialReference]:[]);if(0===t.length)return this._debugLog(`Layer ${e.id} is ignored because it does not have any spatial references`),[];const i=t.filter((t=>this.view.isSpatialReferenceSupported(t,e,(e=>this._debugLog(e)))));return 0===i.length?this._debugLog(`Layer ${e.id} has spatial references but none of them are supported (or layer doesn't require locking)`):this._debugLog(`Layer ${e.id} has spatial references. Resulting candidate set: ${i.map(S).join(", ")}`),i}_processHeightModelInfoSource(e){const t=l$6(e);return !!t&&(this._set("heightModelInfo",t),this._set("isHeightModelInfoSearching",!1),e.spatialReference&&(this._set("vcsWkid",e.spatialReference.vcsWkid),this._set("latestVcsWkid",e.spatialReference.latestVcsWkid)),!0)}_updateTileInfo(){if(null!=this.tileInfo)return;if(!this.view.isTileInfoRequired())return void this._set("isTileInfoDone",!0);if(!this.isSpatialReferenceDone)return;const e=this.get("view.map");if(!e)return void this._debugLog("updateTileInfo: no map");const t=e.basemap,i=e.get("layers.0");let s=null;if(t&&"failed"!==t.loadStatus){if(!t.loaded)return this._updateWhen(t.load()),void this._debugLog("updateTileInfo: basemap still loading");const e=t&&t.get("baseLayers.0");if(e&&"failed"!==e.loadStatus){if(!e.loaded)return this._updateWhen(e.load()),void this._debugLog("updateTileInfo: first basemap layer still loading");s="tileInfo"in e&&e.tileInfo;}else {if(!i||"failed"===i.loadStatus)return this._debugLog("updateTileInfo: no tileInfo"),void this._set("isTileInfoDone",!0);if(!i.loaded)return this._updateWhen(i.load()),void this._debugLog("updateTileInfo: first operational layer still loading");s="tileInfo"in i&&i.tileInfo;}}else if(i&&"failed"!==i.loadStatus){if(!i.loaded)return this._updateWhen(i.load()),void this._debugLog("updateTileInfo: first operational layer still loading");s="tileInfo"in i&&i.tileInfo;}s&&!s.spatialReference.equals(this.spatialReference)&&(s=null),this._debugLog(`updateTileInfo: setting ${s}`),this._set("tileInfo",s),this._set("isTileInfoDone",!0);}_debugLog(e){this.logDebugInformation&&g$4.info(e);}};function S(e){return e?JSON.stringify(e.toJSON()):"undefined"}function y$2(e){switch(e){case 0:return "Waiting";case 1:return "Found";case 2:return "Exhausted"}}m$4.DefaultMapCollectionPaths=["basemap.baseLayers","layers","ground.layers","basemap.referenceLayers"],e$c([y$c()],m$4.prototype,"logDebugInformation",void 0),e$c([y$c({readOnly:!0})],m$4.prototype,"isSpatialReferenceDone",void 0),e$c([y$c({readOnly:!0})],m$4.prototype,"isTileInfoDone",void 0),e$c([y$c({readOnly:!0})],m$4.prototype,"isHeightModelInfoSearching",void 0),e$c([y$c({constructOnly:!0})],m$4.prototype,"view",void 0),e$c([y$c({readOnly:!0})],m$4.prototype,"spatialReference",void 0),e$c([y$c({readOnly:!0})],m$4.prototype,"extent",void 0),e$c([y$c({readOnly:!0})],m$4.prototype,"heightModelInfo",void 0),e$c([y$c({readOnly:!0})],m$4.prototype,"vcsWkid",void 0),e$c([y$c({readOnly:!0})],m$4.prototype,"latestVcsWkid",void 0),e$c([y$c()],m$4.prototype,"mapCollectionPaths",void 0),e$c([y$c()],m$4.prototype,"defaultSpatialReference",void 0),e$c([y$c({readOnly:!0})],m$4.prototype,"tileInfo",void 0),m$4=f$2=e$c([n$s("esri.views.support.DefaultsFromMap")],m$4);var I=m$4;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
var z;const H$1=n$t.getLogger("esri.views.View");let W$2=z=class extends(a$h(n$v.EventedMixin(n$x(p$q)))){constructor(e){super(e),this._userSpatialReference=null,this._cursor=null,this.allLayerViews=new p$t({getCollections:()=>{var e,t,i;return [null==(e=this.basemapView)?void 0:e.baseLayerViews,null==(t=this.groundView)?void 0:t.layerViews,this.layerViews,null==(i=this.basemapView)?void 0:i.referenceLayerViews]},getChildrenFunction:e=>e.layerViews}),this.groundView=null,this.animation=null,this.basemapView=null,this.defaultsFromMap=new I({view:this}),this.fatalError=null,this.extent=null,this.graphics=new u$m,this.navigating=!1,this.layerViews=new L$3,this.magnifier=new p$d,this.padding={left:0,top:0,right:0,bottom:0},this.ready=!1,this.spatialReferenceWarningDelay=1e3,this.supportsGround=!0,this.timeExtent=null,this.type=null,this.scale=null,this.updating=!1,this.initialExtentRequired=!0,this.renderContext=null,this.input=new c$7,this.navigation=new p$7,this.layerViewManager=null,this.refreshManager=null,this.isHeightModelInfoRequired=!1,this.width=null,this.height=null,this.resizing=!1,this.suspended=!1,this.viewEvents=new p$b(this),this.persistableViewModels=new L$3,this._isValid=!1,this._readyCycleForced=!1,this.handles.add(this.watch("preconditionsReady",(e=>{e?(this._currentSpatialReference=this.spatialReference,z.views.add(this)):(this._currentSpatialReference=null,z.views.remove(this)),this.notifyChange("spatialReference"),!e&&this.ready?(this.layerViewManager.clear(),this.toolViewManager.detach(),this._teardown()):e&&!this.ready&&(this._startup(),this.toolViewManager.attach());}),!0));}initialize(){let e;this.addResolvingPromise(this.validate().then((()=>(this._isValid=!0,j$5(this,"ready"))))),this.basemapView=new a$8({view:this}),this.layerViewManager=new M({view:this,layerViewImporter:{importLayerView:e=>this.importLayerView(e),hasLayerViewModule:e=>this.hasLayerViewModule(e)},supportsGround:this.supportsGround}),this.refreshManager=new o$7({view:this}),this.toolViewManager=new S$1({view:this}),this._resetInitialViewPropertiesFromContent(),d$f(this.defaultsFromMap,"isSpatialReferenceDone",(t=>{const i=!!(this.map&&this.map.allLayers.length>0);if(t&&!this.spatialReference&&i||!e){if(t&&!this.spatialReference&&i&&!e){const t=e=C$5(this.spatialReferenceWarningDelay);e.then((()=>{t===e&&H$1.warn("#spatialReference","no spatial reference could be derived from the currently added map layers");})).catch((()=>{}));}}else e=null;}),!0);}destroy(){if(this.destroyed)return;this.viewEvents.destroy(),this.allLayerViews.destroy(),this.navigation&&(this.navigation.destroy(),this._set("navigation",null)),this.graphics.destroy(),this.graphics=null,this.handles.remove("defaultsFromMap"),this.defaultsFromMap.destroy(),this._set("defaultsFromMap",null),this.toolViewManager.destroy(),this.toolViewManager=null,this.refreshManager.destroy(),this.refreshManager=null,this.layerViewManager.destroy(),this.layerViewManager=null,this.basemapView.destroy(),this.basemapView=null,this.invalidate(),this._emitter.clear(),this.handles.removeAll();const e=this.map;this.map=null,null==e||e.destroy();}_startup(){this._set("ready",!0);}_teardown(){this._set("ready",!1);}whenReady(){return Promise.resolve(this)}toMap(){return H$1.error("#toMap()","Not implemented on this instance of View"),null}get heightModelInfo(){return this.getDefaultHeightModelInfo()}get interacting(){return this.navigating}get preconditionsReady(){return !!(!this.fatalError&&this._isValid&&!this._readyCycleForced&&this.map&&(!f$d.isLoadable(this.map)||this.map.loaded)&&0!==this.width&&0!==this.height&&this.spatialReference&&this.isSpatialReferenceSupported(this.spatialReference)&&(this._currentSpatialReference||!this.initialExtentRequired||this.initialExtent||this.defaultsFromMap&&this.defaultsFromMap.isSpatialReferenceDone)&&this.defaultsFromMap&&this.defaultsFromMap.isTileInfoDone)}set map(e){var t;e!==this._get("map")&&(null!=(t=e)&&t.destroyed&&(H$1.warn("#map","The provided map is already destroyed",{map:e}),e=null),f$d.isLoadable(e)&&e.load().catch((()=>{})),this.initialized&&(this.forceReadyCycle(),this._resetInitialViewPropertiesFromContent()),this._set("map",e));}get spatialReference(){let e=this._userSpatialReference||this._currentSpatialReference||this.getDefaultSpatialReference()||null;return e&&this.isHeightModelInfoRequired&&this.defaultsFromMap&&(e=e.clone(),e.vcsWkid=this.defaultsFromMap.vcsWkid,e.latestVcsWkid=this.defaultsFromMap.latestVcsWkid),e}set spatialReference(e){this._userSpatialReference=e,this._set("spatialReference",e);}get stationary(){return !this.animation&&!this.navigating&&!this.resizing}get initialExtent(){return this.defaultsFromMap&&this.defaultsFromMap.extent}get cursor(){const e=this.toolViewManager?this.toolViewManager.cursor:null;return r$g(e)?e:this._cursor||"default"}set cursor(e){this._cursor=e,this.notifyChange("cursor");}get size(){return [this.width,this.height]}whenLayerView(e){return this.layerViewManager.whenLayerView(e)}getDefaultSpatialReference(){return this.get("defaultsFromMap.spatialReference")}getDefaultHeightModelInfo(){return this.get("map.supportsHeightModelInfo")&&this.get("map.heightModelInfo")||this.get("defaultsFromMap.heightModelInfo")||null}importLayerView(e){throw new s$j("importLayerView() not implemented")}hasLayerViewModule(e){return !1}async validate(){}invalidate(){this._isValid=!1;}isSpatialReferenceSupported(e,t,i){return !0}isTileInfoRequired(){return !1}when(e,t){return this.isResolved()&&!this.ready&&H$1.warn("#when()",'Calling view.when() while the view is no longer ready but was already resolved once will resolve immediately. Use watchUtils.whenOnce(view, "ready").then(...) instead.'),super.when(e,t)}forceReadyCycle(){this.ready&&(this._readyCycleForced=!0,$$3(this,"preconditionsReady",(()=>this._readyCycleForced=!1)));}createTool(e,t,i){return this.toolViewManager.createTool(e,t,i)}tryFatalErrorRecovery(){this.fatalError=null;}_resetInitialViewPropertiesFromContent(){if(!this.defaultsFromMap)return;const e=()=>this.defaultsFromMap&&this.defaultsFromMap.start();this.defaultsFromMap.reset(),this._currentSpatialReference=null,this.notifyChange("spatialReference"),this.handles.remove("defaultsFromMap"),this.handles.add([h$h(this,"spatialReference",((t,i)=>{d$l(t,i)||e();})),h$h(this,"initialExtentRequired",e),v$8(e)],"defaultsFromMap");}};W$2.views=new L$3,e$c([o$g("toolViewManager.activeTool")],W$2.prototype,"activeTool",void 0),e$c([y$c({readOnly:!0})],W$2.prototype,"allLayerViews",void 0),e$c([y$c()],W$2.prototype,"groundView",void 0),e$c([y$c()],W$2.prototype,"animation",void 0),e$c([y$c()],W$2.prototype,"basemapView",void 0),e$c([y$c()],W$2.prototype,"defaultsFromMap",void 0),e$c([y$c()],W$2.prototype,"fatalError",void 0),e$c([y$c({type:M$6})],W$2.prototype,"extent",void 0),e$c([y$c(m$h())],W$2.prototype,"graphics",void 0),e$c([y$c({readOnly:!0,type:v$a,dependsOn:["map.heightModelInfo?","defaultsFromMap.heightModelInfo"]})],W$2.prototype,"heightModelInfo",null),e$c([y$c({readOnly:!0})],W$2.prototype,"interacting",null),e$c([y$c({readOnly:!0})],W$2.prototype,"navigating",void 0),e$c([y$c({readOnly:!0,dependsOn:["fatalError","_isValid","_readyCycleForced","map","map.loaded?","width","height","spatialReference","_currentSpatialReference","initialExtentRequired","initialExtent","defaultsFromMap.isSpatialReferenceDone","defaultsFromMap.isTileInfoDone"]})],W$2.prototype,"preconditionsReady",null),e$c([y$c({type:L$3,readOnly:!0})],W$2.prototype,"layerViews",void 0),e$c([y$c({type:p$d})],W$2.prototype,"magnifier",void 0),e$c([y$c({value:null,type:j$6})],W$2.prototype,"map",null),e$c([y$c()],W$2.prototype,"padding",void 0),e$c([y$c({readOnly:!0})],W$2.prototype,"ready",void 0),e$c([y$c({type:k$4})],W$2.prototype,"spatialReference",null),e$c([y$c()],W$2.prototype,"spatialReferenceWarningDelay",void 0),e$c([y$c()],W$2.prototype,"stationary",null),e$c([y$c({readOnly:!0})],W$2.prototype,"supportsGround",void 0),e$c([y$c({type:y$f})],W$2.prototype,"timeExtent",void 0),e$c([o$g("toolViewManager.tools")],W$2.prototype,"tools",void 0),e$c([y$c()],W$2.prototype,"toolViewManager",void 0),e$c([y$c({readOnly:!0})],W$2.prototype,"type",void 0),e$c([y$c({type:Number})],W$2.prototype,"scale",void 0),e$c([y$c({readOnly:!0})],W$2.prototype,"updating",void 0),e$c([y$c({readOnly:!0})],W$2.prototype,"initialExtentRequired",void 0),e$c([y$c({readOnly:!0,type:M$6})],W$2.prototype,"initialExtent",null),e$c([y$c()],W$2.prototype,"cursor",null),e$c([y$c()],W$2.prototype,"renderContext",void 0),e$c([y$c({readOnly:!0})],W$2.prototype,"input",void 0),e$c([y$c({type:p$7,nonNullable:!0})],W$2.prototype,"navigation",void 0),e$c([y$c()],W$2.prototype,"layerViewManager",void 0),e$c([y$c()],W$2.prototype,"width",void 0),e$c([y$c()],W$2.prototype,"height",void 0),e$c([y$c({readOnly:!0})],W$2.prototype,"resizing",void 0),e$c([y$c({value:null,readOnly:!0})],W$2.prototype,"size",null),e$c([y$c({readOnly:!0})],W$2.prototype,"suspended",void 0),e$c([y$c({readOnly:!0})],W$2.prototype,"viewEvents",void 0),e$c([y$c({readOnly:!0})],W$2.prototype,"persistableViewModels",void 0),e$c([y$c()],W$2.prototype,"_isValid",void 0),e$c([y$c()],W$2.prototype,"_readyCycleForced",void 0),e$c([y$c()],W$2.prototype,"_currentSpatialReference",void 0),W$2=z=e$c([n$s("esri.views.View")],W$2);var P=W$2;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
let p$5=class extends m$i{constructor(t){super(t),this.state="running",this.target=null;}initialize(){this.addResolvingPromise(new Promise(((t,e)=>this._dfd={resolve:t,reject:e})));}get done(){return "finished"===this.state||"stopped"===this.state}stop(){"stopped"!==this.state&&"finished"!==this.state&&(this._set("state","stopped"),this._dfd.reject(new s$j("ViewAnimation stopped")));}finish(){"stopped"!==this.state&&"finished"!==this.state&&(this._set("state","finished"),this._dfd.resolve());}update(t,e){e||(e=U$5(t)?"waiting-for-target":"running"),this._set("target",t),this._set("state",e);}};e$c([y$c({readOnly:!0})],p$5.prototype,"done",null),e$c([y$c({readOnly:!0,type:String})],p$5.prototype,"state",void 0),e$c([y$c()],p$5.prototype,"target",void 0),p$5=e$c([n$s("esri.views.ViewAnimation")],p$5),function(t){t.State={RUNNING:"running",STOPPED:"stopped",FINISHED:"finished",WAITING_FOR_TARGET:"waiting-for-target"};}(p$5||(p$5={}));var n$c=p$5;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
function e$4(){return [1,0,0,1,0,0]}function r$7(e){return [e[0],e[1],e[2],e[3],e[4],e[5]]}function n$b(e,r,n,t,a,o){return [e,r,n,t,a,o]}function t$5(e,r){return new Float64Array(e,r,6)}Object.freeze({__proto__:null,create:e$4,clone:r$7,fromValues:n$b,createView:t$5});

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
const W$1=39.37,C$1=180/Math.PI;function U(t,e,n){const r=s$q(e[0]/s$p.radius);return r$i(t,n?r:r-360*Math.floor((r+180)/360),s$q(.5*Math.PI-2*Math.atan(Math.exp(-1*e[1]/s$p.radius))))}function Q(t,e){let n=e[1];return n>89.99999?n=89.99999:n<-89.99999&&(n=-89.99999),n=Math.sin(r$j(n)),r$i(t,r$j(e[0])*s$p.radius,.5*s$p.radius*Math.log((1+n)/(1-n)))}function B(t,e,n,r){return r&&n&&!r.equals(n)&&x$4(r,n)&&r.isWebMercator?r.isWebMercator?Q(t,e):U(t,e):a$l(t,e)}function D(t){return t.wkid?t:t.spatialReference||k$4.WGS84}function T(t,e){return e.type?r$i(t,e.x,e.y):a$l(t,e)}function H(t){return G$3(t)}function J(t,e){return Math.max(t.width/e[0],t.height/e[1])*ct(t.spatialReference)}async function K(t,a,i,s){let c,u;if(!t)return null;if(Array.isArray(t)&&!t.length)return null;if(L$3.isCollection(t)&&(t=t.toArray()),Array.isArray(t)&&t.length&&"object"==typeof t[0]){const e=t.every((t=>"attributes"in t)),r=t.some((t=>!t.geometry));let o=t;if(e&&r&&a&&a.allLayerViews){const e=new Map;for(const n of t){const t=n.layer,r=e.get(t)||[],o=n.attributes[t.objectIdField];null!=o&&r.push(o),e.set(t,r);}const r=[];e.forEach(((t,e)=>{const n=a.allLayerViews.find((t=>t.layer.id===e.id));if("queryFeatures"in n){const o=e.createQuery();o.objectIds=t,o.returnGeometry=!0,r.push(n.queryFeatures(o));}}));const i=await Promise.all(r),s=[];for(const t of i)if(t&&t.features&&t.features.length)for(const e of t.features)r$g(e.geometry)&&s.push(e.geometry);o=s;}for(const t of o)s=await K(t,a,i,s);return s}if(Array.isArray(t)&&2===t.length&&"number"==typeof t[0]&&"number"==typeof t[1])c=new b$b(t);else if(t instanceof p$v)c=t;else if("geometry"in t)if(t.geometry)c=t.geometry;else if(t.layer){const e=t.layer,n=a.allLayerViews.find((t=>t.layer.id===e.id));if("queryFeatures"in n){const o=e.createQuery();o.objectIds=[t.attributes[e.objectIdField]],o.returnGeometry=!0;const a=await n.queryFeatures(o);c=g$j(a,"features",0,"geometry");}}if(t$f(c))return null;if(u="point"===c.type?new M$6({xmin:c.x,ymin:c.y,xmax:c.x,ymax:c.y,spatialReference:c.spatialReference}):c.extent,!u)return null;const f=x$4(u,i);if(!u.spatialReference.equals(i)&&f)u=g$i(u,i);else if(!f)return null;return s=s?s.union(u):u.clone()}function X(t){if(t&&(!Array.isArray(t)||"number"!=typeof t[0])&&("object"==typeof t||Array.isArray(t)&&"object"==typeof t[0])){if("layer"in t&&t.layer&&t.layer.minScale&&t.layer.maxScale){const e=t.layer;return {min:e.minScale,max:e.maxScale}}if(Array.isArray(t)&&t.length&&t.every((t=>"layer"in t))){let e=0,n=0;for(const r of t){const t=r.layer;t&&t.minScale&&t.maxScale&&(e=t.minScale<e?t.minScale:e,n=t.maxScale>n?t.maxScale:n);}return e&&n?{min:e,max:n}:null}}}async function Y(e,r){if(!e||!r)return new u$7({targetGeometry:new b$b,scale:0,rotation:0});let o=r.spatialReference;const{constraints:a,padding:i,viewpoint:s,size:c}=r,u=[i?c[0]-i.left-i.right:c[0],i?c[1]-i.top-i.bottom:c[1]];let f=null;e instanceof u$7?f=e:e.viewpoint?f=e.viewpoint:e.target&&"esri.Viewpoint"===e.target.declaredClass&&(f=e.target);let l=null;f&&f.targetGeometry?l=f.targetGeometry:e instanceof M$6?l=e:(e||e&&("center"in e||"extent"in e||"target"in e))&&(l=await K(e.center,r,o)||await K(e.extent,r,o)||await K(e.target,r,o)||await K(e,r,o)),!l&&s&&s.targetGeometry?l=s.targetGeometry:!l&&r.extent&&(l=r.extent);const m=D(l);if(o||(o=D(r.spatialReference||r.extent||l)),!x$4(l,o)&&m&&!m.equals(o))return null;const y=T(n$y(),l.center?l.center:l),p=new b$b(B(y,y,m,o),o);let g=null;g=f&&r$g(f.targetGeometry)&&"point"===f.targetGeometry.type?f.scale:e.hasOwnProperty("scale")&&e.scale?e.scale:e.hasOwnProperty("zoom")&&-1!==e.zoom&&a&&a.effectiveLODs?a.zoomToScale(e.zoom):Array.isArray(l)||"point"===l.type||"extent"===l.type&&0===l.width&&0===l.height?r.extent&&x$4(r.extent,o)?J(g$i(r.extent,o),u):r.extent?J(r.extent,u):s.scale:x$4(l.extent,o)?J(g$i(l.extent,o),u):J(l.extent,u);const h=X(e);h&&(h.min&&h.min>g?g=h.min:h.max&&h.max<g&&(g=h.max));let x=0;f?x=f.rotation:e.hasOwnProperty("rotation")?x=e.rotation:s&&(x=s.rotation);let b=new u$7({targetGeometry:p,scale:g,rotation:x});return a&&(b=a.fit(b),a.constrainByGeometry(b),a.rotationEnabled||(b.rotation=x)),b}function Z(t,e){const n=t.targetGeometry,r=e.targetGeometry;return n.x=r.x,n.y=r.y,n.spatialReference=r.spatialReference,t.scale=e.scale,t.rotation=e.rotation,t}function $(t,e,n){return n?r$i(t,.5*(e[0]-n.right+n.left),.5*(e[1]-n.bottom+n.top)):l$n(t,e,.5)}const _$1=function(){const t=n$y();return function(e,n,r){const o=n.targetGeometry;T(t,o);const a=.5*at(n);return e.xmin=t[0]-a*r[0],e.ymin=t[1]-a*r[1],e.xmax=t[0]+a*r[0],e.ymax=t[1]+a*r[1],e.spatialReference=o.spatialReference,e}}();function tt(t,e,n,r,o){return wt(t,e,n.center),t.scale=J(n,r),o&&o.constraints&&o.constraints.constrain(t),t}function et(t,e,n,r){return mt(t,e,n,r),r$k(t,t)}const rt=function(){const t=n$y();return function(e,n,r){return C$6(e,ut(e,n),$(t,n,r))}}(),ot=function(){const t=e$4(),e=n$y();return function(n,r,o,a){const i=at(r),s=st(r);return r$i(e,i,i),M$7(t,e),c$C(t,t,s),i$j(t,t,rt(e,o,a)),i$j(t,t,[0,a.top-a.bottom]),r$i(n,t[4],t[5])}}();function at(t){return t.scale*it(t.targetGeometry)}function it(t){return r$g(t)&&s$r(t.spatialReference)?1/(H(t.spatialReference)*W$1*ft()):1}function st(t){return r$j(t.rotation)||0}function ct(t){return s$r(t)?H(t)*W$1*ft():1}function ut(t,e){return l$n(t,e,.5)}function ft(){return 96}const lt=function(){const t=n$y(),e=n$y(),n=n$y();return function(r,o,a,i,s,c){return p$u(t,o),l$n(e,a,.5*c),r$i(n,1/i*c,-1/i*c),n$z(r),i$j(r,r,e),s&&c$C(r,r,s),e$j(r,r,n),i$j(r,r,t),r}}(),mt=function(){const t=n$y();return function(e,n,r,o){const a=at(n),i=st(n);return T(t,n.targetGeometry),lt(e,t,r,a,i,o)}}(),yt=function(){const t=n$y();return function(e,n,r,o){const a=at(n);return T(t,n.targetGeometry),lt(e,t,r,a,0,o)}}();function pt(t){if(t.isWrappable){const e=S$a(t);return e.valid[1]-e.valid[0]}return 0}function gt(t,e){return Math.round(pt(t)/e)}function ht(t,e){return Y(t,e)}const xt=function(){const t=n$y(),e=n$y(),n=[0,0,0];return function(r,o,a){o$k(t,r,o),g$k(t,t),o$k(e,r,a),g$k(e,e),j$7(n,t,e);let i=Math.acos(_$9(t,e)/(b$c(t)*b$c(e)))*C$1;return n[2]<0&&(i=-i),isNaN(i)&&(i=0),i}}(),bt=function(){const t=n$y();return function(e,n,r,o){const a=e.targetGeometry;return Z(e,n),ot(t,n,r,o),a.x+=t[0],a.y+=t[1],e}}(),wt=function(){const t=n$y();return function(e,n,r){Z(e,n);const o=e.targetGeometry,a=D(r),i=D(o);return T(t,r),B(t,t,a,i),o.x=t[0],o.y=t[1],e}}();const Gt=function(){const t=n$y();return function(e,n,r,o,a){a||(a="center"),C$6(t,r,o),l$n(t,t,.5);const i=t[0],s=t[1];switch(a){case"center":r$i(t,0,0);break;case"left":r$i(t,-i,0);break;case"top":r$i(t,0,s);break;case"right":r$i(t,i,0);break;case"bottom":r$i(t,0,-s);break;case"top-left":r$i(t,-i,s);break;case"bottom-left":r$i(t,-i,-s);break;case"top-right":r$i(t,i,s);break;case"bottom-right":r$i(t,i,-s);}return Ft(e,n,t),e}}();function Mt(t,e,n){return Z(t,e),t.rotation+=n,t}function At(t,e,n){return Z(t,e),t.rotation=n,t}const Rt=function(){const t=n$y();return function(e,n,r,o,a){return Z(e,n),isNaN(r)||0===r||(qt(t,o,n,a),e.scale=n.scale*r,Pt(t,t,e,a),Ft(e,e,r$i(t,t[0]-o[0],o[1]-t[1]))),e}}();function kt(t,e,n){return Z(t,e),t.scale=n,t}const St=function(){const t=n$y();return function(e,n,r,o,a,i){return Z(e,n),isNaN(r)||0===r||(qt(t,a,n,i),e.scale=n.scale*r,e.rotation+=o,Pt(t,t,e,i),Ft(e,e,r$i(t,t[0]-a[0],a[1]-t[1]))),e}}(),vt=function(){const t=n$y(),e=n$y();return function(n,r,o,a,i,s,c){return rt(e,s,c),s$s(t,i,e),a?St(n,r,o,a,t,s):Rt(n,r,o,t,s)}}(),qt=function(){const t=e$4();return function(e,n,r,o){return D$5(e,n,et(t,r,o,1))}}(),Pt=function(){const t=e$4();return function(e,n,r,o){return D$5(e,n,mt(t,r,o,1))}}(),Ft=function(){const t=n$y(),e=e$4();return function(n,r,o){Z(n,r);const a=at(r),i=n.targetGeometry;return h$i(e,st(r)),e$j(e,e,t$i(a,a)),D$5(t,o,e),i.x+=t[0],i.y+=t[1],n}}();

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
function r$6(){const r=new Float32Array(9);return r[0]=1,r[4]=1,r[8]=1,r}function n$a(r){const n=new Float32Array(9);return n[0]=r[0],n[1]=r[1],n[2]=r[2],n[3]=r[3],n[4]=r[4],n[5]=r[5],n[6]=r[6],n[7]=r[7],n[8]=r[8],n}function e$3(r,n,e,t,a,o,c,u,s){const l=new Float32Array(9);return l[0]=r,l[1]=n,l[2]=e,l[3]=t,l[4]=a,l[5]=o,l[6]=c,l[7]=u,l[8]=s,l}function t$4(r,n){return new Float32Array(r,n,9)}Object.freeze({__proto__:null,create:r$6,clone:n$a,fromValues:e$3,createView:t$4});

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
function n$9(n){return n instanceof Float32Array&&n.length>=2}function r$5(n){return Array.isArray(n)&&n.length>=2}function t$3(t){return n$9(t)||r$5(t)}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
var V;const G=[0,0];let O=V=class extends a$j{constructor(t){super(t),this._viewpoint2D={center:n$y(),rotation:0,scale:0,spatialReference:null},this.center=[0,0],this.extent=new M$6,this.id=0,this.inverseTransform=e$4(),this.resolution=0,this.rotation=0,this.scale=0,this.transform=e$4(),this.transformNoRotation=e$4(),this.displayMat3=r$6(),this.displayViewMat3=r$6(),this.viewMat3=r$6(),this.viewMat2d=n$A(),this.worldScreenWidth=0,this.size=[0,0];}set pixelRatio(t){this._set("pixelRatio",t),this._update();}set size(t){this._set("size",t),this._update();}set viewpoint(t){if(t){const s=this._viewpoint2D,i=t.targetGeometry;s.center[0]=i.x,s.center[1]=i.y,s.rotation=t.rotation,s.scale=t.scale,s.spatialReference=i.spatialReference;}this._update();}copy(t){const s=this.size,i=this.viewpoint;return i&&s?(this.viewpoint=Z(i,t.viewpoint),this._set("size",a$l(s,t.size))):(this.viewpoint=t.viewpoint.clone(),this._set("size",[t.size[0],t.size[1]])),this._set("pixelRatio",t.pixelRatio),this}clone(){return new V({size:this.size,viewpoint:this.viewpoint.clone(),pixelRatio:this.pixelRatio})}toMap(t,s,i){return t$3(s)?D$5(t,s,this.inverseTransform):(G[0]=s,G[1]=i,D$5(t,G,this.inverseTransform))}toScreen(t,s,i){return t$3(s)?D$5(t,s,this.transform):(G[0]=s,G[1]=i,D$5(t,G,this.transform))}toScreenNoRotation(t,s,i){return t$3(s)?D$5(t,s,this.transformNoRotation):(G[0]=s,G[1]=i,D$5(t,G,this.transformNoRotation))}getScreenTransform(t,s){const{center:i}=this._viewpoint2D,e=this._get("pixelRatio")||1,o=this._get("size");return lt(t,i,o,s,0,e),t}_update(){const{center:t,spatialReference:i,scale:e,rotation:o}=this._viewpoint2D,c=this._get("pixelRatio")||1,m=this._get("size"),d=new u$7({targetGeometry:new b$b(t[0],t[1],i),scale:e,rotation:o});if(this._set("viewpoint",d),!m||!i||!e)return;this.resolution=at(d),this.rotation=o,this.scale=e,this.spatialReference=i,a$l(this.center,t);const y=0!==m[0]?2/m[0]:0,_=0!==m[1]?-2/m[1]:0;s$t(this.displayMat3,y,0,0,0,_,0,-1,1,1);const x=r$l(this.viewMat3),z=t$j(m[0]/2,m[1]/2),g=t$j(-m[0]/2,-m[1]/2),b=r$j(o);M$8(x,x,z),h$j(x,x,b),M$8(x,x,g),i$k(this.displayViewMat3,this.displayMat3,x);const V=n$z(this.viewMat2d);return i$j(V,V,z),c$C(V,V,b),i$j(V,V,g),_$1(this.extent,d,m),mt(this.transform,d,m,c),r$k(this.inverseTransform,this.transform),yt(this.transformNoRotation,d,m,c),this.worldScreenWidth=gt(this.spatialReference,this.resolution),this._set("id",this.id+1),this}};e$c([y$c({readOnly:!0})],O.prototype,"id",void 0),e$c([y$c({value:1,json:{write:!0}})],O.prototype,"pixelRatio",null),e$c([y$c({json:{write:!0}})],O.prototype,"size",null),e$c([y$c({type:u$7,json:{write:!0}})],O.prototype,"viewpoint",null),O=V=e$c([n$s("esri.views.2d.ViewState")],O);var W=O;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
function t$2(t,r){switch(r){case"primary":return "touch"===t.pointerType||0===t.button;case"secondary":return "touch"!==t.pointerType&&2===t.button;case"tertiary":return "touch"!==t.pointerType&&1===t.button}}function r$4(t,r){if("touch"===t.pointerType)return !1;switch(r){case"primary":return 0===t.button;case"secondary":return 2===t.button;case"tertiary":return 1===t.button}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
class t$1{constructor(t){this.callbacks=t,this.currentCount=0,this.callbacks.condition||(this.callbacks.condition=()=>!0);}handle(t){const s=t.data,i=s.pointers.size;switch(s.action){case"start":this.currentCount=i,this.emitStart(t);break;case"added":this.emitEnd(this.previousEvent),this.currentCount=i,this.emitStart(t);break;case"update":this.emitUpdate(t);break;case"removed":this.startEvent&&this.emitEnd(this.previousEvent),this.currentCount=i,this.emitStart(t);break;case"end":this.emitEnd(t),this.currentCount=0;}this.previousEvent=t;}emitStart(t){this.startEvent=t,this.callbacks.condition(this.currentCount,t)&&this.callbacks.start(this.currentCount,t,this.startEvent);}emitUpdate(t){this.callbacks.condition(this.currentCount,t)&&this.callbacks.update(this.currentCount,t,this.startEvent);}emitEnd(t){this.callbacks.condition(this.currentCount,t)&&this.callbacks.end(this.currentCount,t,this.startEvent),this.startEvent=null;}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
function n$8(t){let n=t*t;return t<0&&(n*=-1),n}function a$6(t){return t.translation[0]=0,t.translation[1]=0,t.translation[2]=0,t.heading=0,t.tilt=0,t}function i$2(a,i,o){const s=o,e=a.state,r=a.device,l="forward-down"===i.tiltDirection?1:-1,c=1;return "standard"===r.deviceType?(s.translation[0]=n$8(e.axes[0]),s.translation[1]=n$8(e.axes[1]),s.translation[2]=n$8(e.buttons[7])-n$8(e.buttons[6]),s.heading=n$8(e.axes[2]),s.tilt=n$8(e.axes[3])):"spacemouse"===r.deviceType&&(s.translation[0]=1.2*n$8(e.axes[0]),s.translation[1]=1.2*n$8(e.axes[1]),s.translation[2]=2*-n$8(e.axes[2]),s.heading=1.2*n$8(e.axes[5]),s.tilt=1.2*n$8(e.axes[3])),s.tilt*=l,d$j(s.translation,s.translation,c),s}function o$3(t,n){const a=n;return a.translation[0]=t[1]-t[0],a.translation[1]=t[3]-t[2],a.translation[2]=t[4]-t[5],a.heading=t[7]-t[6],a.tilt=t[8]-t[9],a.zoom=t[10]-t[11],a}function s$7(t){return 0===t.translation[0]&&0===t.translation[1]&&0===t.translation[2]&&0===t.heading&&0===t.tilt&&0===t.zoom}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
function e$2(t){const e=t.native;return e?{buttons:e.buttons.map((t=>t.pressed?t.value?t.value:1:0)),axes:e.axes.map((e=>s$6(e,t.axisThreshold)))}:{buttons:[],axes:[]}}function n$7(t,e){if(t.axes.length!==e.axes.length)return !1;if(t.buttons.length!==e.buttons.length)return !1;for(let n=0;n<t.axes.length;n++)if(t.axes[n]!==e.axes[n])return !1;for(let n=0;n<t.buttons.length;n++)if(t.buttons[n]!==e.buttons[n])return !1;return !0}function r$3(t){for(let e=0;e<t.axes.length;e++)if(0!==t.axes[e])return !1;for(let e=0;e<t.buttons.length;e++)if(0!==t.buttons[e])return !1;return !0}function s$6(e,n){const r=Math.abs(e);return r<n?0:s$u(e)*(r-n)/(1-n)}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
class a$5{constructor(e,t){this.element=e,this.input=t,this._hasEventListeners=!1,this.onConnectGamepad=e=>{this.connectGamepad(e.gamepad);},this.onDisconnectGamepad=e=>{const t=e.gamepad,i=t.index,n=this.inputDevices[i];n&&(this.emitGamepadEvent(t,e$2(n),!1),this.inputDevices.splice(i,1),this.latestUpdate.splice(i,1),this.input.gamepad.devices.remove(n),this.ensurePollingState());},this.frameTask=null,this.latestUpdate=new Array,this.inputDevices=new Array,this.callback=null;const i="getGamepads"in window.navigator,n=window.isSecureContext;this.supported=i&&n,this.supported&&(this.forEachGamepad(this.connectGamepad),window.addEventListener("gamepadconnected",this.onConnectGamepad),window.addEventListener("gamepaddisconnected",this.onDisconnectGamepad),this.ensurePollingState());}destroy(){this.hasEventListeners=!1,this.supported&&(window.removeEventListener("gamepadconnected",this.onConnectGamepad),window.removeEventListener("gamepaddisconnected",this.onDisconnectGamepad));}set hasEventListeners(e){this._hasEventListeners!==e&&(this._hasEventListeners=e,this.ensurePollingState());}get eventsEnabled(){return this.supported&&this.inputDevices.length>0&&this._hasEventListeners}set onEvent(e){this.callback=e;}connectGamepad(e){const s=new i$5(e);"unknown"!==s.deviceType&&(this.inputDevices[e.index]=s,this.input.gamepad.devices.add(s)),this.ensurePollingState();}ensurePollingState(){this.eventsEnabled?this.startPolling():this.stopPolling();}startPolling(){null==this.frameTask&&(this.frameTask=A$5({update:()=>this.readGamepadState()}));}stopPolling(){null!=this.frameTask&&(this.frameTask.remove(),this.frameTask=null,this.latestUpdate=new Array);}readGamepadState(){const e=document.hasFocus(),t=this.element.contains(document.activeElement),a="document"===this.input.gamepad.enabledFocusMode&&!e||"view"===this.input.gamepad.enabledFocusMode&&!t;this.forEachGamepad((e=>{const t=this.inputDevices[e.index];if(!t)return;const d=this.latestUpdate[e.index],o=e$2(t),r=a||r$3(o);if(d){if(d.timestamp===e.timestamp)return;if(!d.active&&r)return;if(n$7(d.state,o))return}this.emitGamepadEvent(e,o,!r);}));}forEachGamepad(e){const t=window.navigator.getGamepads();for(let s=0;s<t.length;s++){const i=t[s];this.validate(i)&&e(i);}}emitGamepadEvent(e,t,s){const i=this.latestUpdate[e.index],n=i&&i.active;if(!n&&!s)return;const a=!n&&s?"start":n&&s?"update":"end";this.latestUpdate[e.index]={timestamp:e.timestamp,state:t,active:s},this.callback&&this.callback({device:this.inputDevices[e.index],state:t,action:a});}validate(e){if(!e)return !1;if(!e.connected)return !1;for(let t=0;t<e.axes.length;t++)if(isNaN(e.axes[t]))return !1;return !0}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
const o$2=s$l("trident"),a$4=s$l("edge"),s$5=s$l("chrome"),r$2=s$l("ff"),h$4=s$l("safari"),l$5={touchNone:"esri-view-surface--touch-none",touchPan:"esri-view-surface--touch-pan"};class u$4{constructor(e,t){this.input=t,this._active={},this._activePointerCaptures=new Set,this._keyDownState=new Set,this._eventId=1,this._browserTouchPanningEnabled=!1,this._element=e,e.getAttribute("tabindex")||e.setAttribute("tabindex","0"),this._eventHandlers={"key-down":this._handleKey,"key-up":this._handleKey,"pointer-down":this._handlePointer,"pointer-move":this._handlePointerPreventDefault,"pointer-up":this._handlePointerPreventDefault,"pointer-enter":this._handlePointer,"pointer-leave":this._handlePointer,"pointer-cancel":this._handlePointer,"mouse-wheel":this._handleMouseWheel,"pointer-capture-lost":this._handlePointerCaptureLost},this._updateTouchAction(),this._element.addEventListener("keydown",this._preventAltKeyDefault),this._gamepadSource=new a$5(e,this.input),this._gamepadSource.onEvent=e=>this._callback("gamepad",e);}destroy(){this._callback=null,this.activeEvents=null,this._activePointerCaptures.forEach((e=>{this._releasePointerCaptureSafe(e);})),this._gamepadSource&&(this._gamepadSource.destroy(),this._gamepadSource=null),this._activePointerCaptures=null,this._removeTouchAction(),this._element.removeEventListener("keydown",this._preventAltKeyDefault);}get browserTouchPanningEnabled(){return this._browserTouchPanningEnabled}set browserTouchPanningEnabled(e){this._browserTouchPanningEnabled=e,this._updateTouchAction(),this._updateTouchEventHandling();}set onEventReceived(e){this._callback=e;}set activeEvents(e){for(const t in this._active)if(!e||!e.has(t)){const e=this._active[t];this._element.removeEventListener(c$5[t],e),delete this._active[t];}e&&e.forEach((e=>{if(!this._active[e]&&c$5[e]){const t=(this._eventHandlers[e]||this._handleDefault).bind(this,e);this._element.addEventListener(c$5[e],t),this._active[e]=t;}})),this._gamepadSource.hasEventListeners=e&&e.has("gamepad");}setPointerCapture(e,t){t?(this._element.setPointerCapture(e.pointerId),this._activePointerCaptures.add(e.pointerId)):(this._releasePointerCaptureSafe(e.pointerId),this._activePointerCaptures.delete(e.pointerId));}_updateTouchAction(){this._element.classList.remove(this._browserTouchPanningEnabled?l$5.touchNone:l$5.touchPan),this._element.classList.add(this._browserTouchPanningEnabled?l$5.touchPan:l$5.touchNone);}_updateTouchEventHandling(){this._browserTouchPanningEnabled?this._element.addEventListener("touchmove",this._preventMultiTouchPanning):this._element.removeEventListener("touchmove",this._preventMultiTouchPanning);}_removeTouchAction(){this._element.classList.remove(l$5.touchNone),this._element.classList.remove(l$5.touchPan),this._element.removeEventListener("touchmove",this._preventMultiTouchPanning);}_releasePointerCaptureSafe(e){try{if(this._element.hasPointerCapture&&!this._element.hasPointerCapture(e))return;this._element.releasePointerCapture(e);}catch(t){}}_updateNormalizedPointerLikeEvent(e,t){const n=t$6(this._element,e);return u$4.test.disableSubpixelCoordinates&&(n.x=Math.round(n.x),n.y=Math.round(n.y)),t.x=n.x,t.y=n.y,t}_handleKey(e,n){const i=a$c(n);i&&"key-up"===e&&this._keyDownState.delete(i);const o={native:n,key:i,repeat:i&&this._keyDownState.has(i)};i&&"key-down"===e&&this._keyDownState.add(o.key),this._callback(e,o);}_handlePointer(e,t){const n=this._updateNormalizedPointerLikeEvent(t,{native:t,x:0,y:0,pointerType:t.pointerType,button:t.button,buttons:t.buttons,eventId:this._eventId++});this._callback(e,n);}_handlePointerPreventDefault(e,t){const n=this._updateNormalizedPointerLikeEvent(t,{native:t,x:0,y:0,pointerType:t.pointerType,button:t.button,buttons:t.buttons,eventId:this._eventId++});t.preventDefault(),this._callback(e,n);}_handleMouseWheel(e,t){let n=t.deltaY;switch(t.deltaMode){case 0:(o$2||a$4)&&(n=n/document.documentElement.clientHeight*600);break;case 1:n*=30;break;case 2:n*=900;}o$2||a$4?n*=.7:s$5||h$4?n*=.6:r$2&&(n*=1.375);const i=100,l=Math.abs(n);if(l>i){const e=.02;n=n/l*200/(1+Math.exp(-e*(l-i)));}const u=this._updateNormalizedPointerLikeEvent(t,{native:t,x:0,y:0,deltaY:n});this._callback(e,u);}_handlePointerCaptureLost(e,t){this._activePointerCaptures.delete(t.pointerId),this._handleDefault(e,t);}_handleDefault(e,t){const n={native:t};t.preventDefault(),this._callback(e,n);}_preventAltKeyDefault(e){"Alt"===e.key&&e.preventDefault();}_preventMultiTouchPanning(e){e.touches.length>1&&e.preventDefault();}}u$4.test={disableSubpixelCoordinates:!1};const c$5={"key-down":"keydown","key-up":"keyup","pointer-down":"pointerdown","pointer-up":"pointerup","pointer-move":"pointermove","mouse-wheel":"wheel","pointer-capture-got":"gotpointercapture","pointer-capture-lost":"lostpointercapture","context-menu":"contextmenu","pointer-enter":"pointerenter","pointer-leave":"pointerleave","pointer-cancel":"pointercancel",focus:"focus",blur:"blur"};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
class e$1 extends i$b{constructor(){super(!0),this.registerIncoming("context-menu",(t=>{t.data.native.preventDefault();}));}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
function e(t,e){return Math.abs(e.x-t.x)+Math.abs(e.y-t.y)}function n$6(t,e){const n=e.x-t.x,r=e.y-t.y;return Math.sqrt(n*n+r*r)}function r$1(e,n){if(n?(n.radius=0,n.center.x=0,n.center.y=0):n={radius:0,center:c$B()},0===e.length)return n;if(1===e.length)return n.center.x=e[0].x,n.center.y=e[0].y,n;if(2===e.length){const[t,r]=e,[c,s]=[r.x-t.x,r.y-t.y];return n.radius=Math.sqrt(c*c+s*s)/2,n.center.x=(t.x+r.x)/2,n.center.y=(t.y+r.y)/2,n}let r=0,c=0;for(let t=0;t<e.length;t++)r+=e[t].x,c+=e[t].y;r/=e.length,c/=e.length;const s=e.map((t=>t.x-r)),x=e.map((t=>t.y-c));let o=0,y=0,a=0,h=0,l=0,u=0,i=0;for(let t=0;t<s.length;t++){const e=s[t],n=x[t],r=e*e,c=n*n;o+=r,y+=c,a+=e*n,h+=r*e,l+=c*n,u+=e*c,i+=n*r;}const f=.5*(h+u),g=.5*(l+i),M=o*y-a*a,d=(f*y-g*a)/M,m=(o*g-a*f)/M,p=c$B(d+r,m+c);return {radius:Math.sqrt(d*d+m*m+(o+y)/e.length),center:p}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
const l$4={maximumDoubleClickDelay:250,maximumDoubleClickDistance:10,maximumDoubleTouchDelay:350,maximumDoubleTouchDistance:35};class s$4 extends i$b{constructor(t=l$4.maximumDoubleClickDelay,i=l$4.maximumDoubleClickDistance,o=l$4.maximumDoubleTouchDelay,s=l$4.maximumDoubleTouchDistance,u=o$l){super(!1),this.maximumDoubleClickDelay=t,this.maximumDoubleClickDistance=i,this.maximumDoubleTouchDelay=o,this.maximumDoubleTouchDistance=s,this._clock=u,this._pointerState=new Map,this._click=this.registerOutgoing("click"),this._doubleClick=this.registerOutgoing("double-click"),this.registerIncoming("immediate-click",this._handleImmediateClick.bind(this)),this.registerIncoming("pointer-drag",this._handlePointerDrag.bind(this)),this.registerIncoming("drag",this._handleDrag.bind(this));}onUninstall(){this._pointerState.forEach((e=>{null!=e.doubleClickTimeout&&(e.doubleClickTimeout.remove(),e.doubleClickTimeout=null);}));}get hasPendingInputs(){return n$h(this._pointerState,(e=>null!=e.doubleClickTimeout))}_pointerId(e){const t=e.native;return "mouse"===t.pointerType?`${t.pointerId}:${t.button}`:`${t.pointerType}`}_handleImmediateClick(e$1){const t=e$1.data,i=this._pointerId(t),l=this._pointerState.get(i);if(l){const s="touch"===t.native.pointerType?this.maximumDoubleTouchDistance:this.maximumDoubleClickDistance;e(l.event.data,t)>s?(this._clearDoubleClickTimeout(i,!0),this._startClick(e$1)):(this._clearDoubleClickTimeout(i,!1),this._doubleClick.emit(l.event.data,void 0,l.event.modifiers));}else this._startClick(e$1);}_startClick(e){const t=this._pointerId(e.data),i="touch"===e.data.native.pointerType?this.maximumDoubleTouchDelay:this.maximumDoubleClickDelay;this._pointerState.set(t,{event:e,doubleClickTimeout:this._clock.setTimeout((()=>this._doubleClickTimeoutExceeded(t)),i)}),this.refreshHasPendingInputs();}_handlePointerDrag(e){const t=this._pointerId(e.data.currentEvent);this._clearDoubleClickTimeout(t,!0);}_handleDrag(e){const t=this._pointerId(e.data.pointer);this._clearDoubleClickTimeout(t,!0);}_clearDoubleClickTimeout(e,t){const i=this._pointerState.get(e);i&&(i.doubleClickTimeout.remove(),i.doubleClickTimeout=null,t&&this._doubleClickTimeoutExceeded(e),this._pointerState.delete(e),this.refreshHasPendingInputs());}_doubleClickTimeoutExceeded(e){const t=this._pointerState.get(e);this._click.emit(t.event.data,void 0,t.event.modifiers),t.doubleClickTimeout=null,this._pointerState.delete(e),this.refreshHasPendingInputs();}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
class s$3 extends i$b{constructor(t){super(!1),this.navigationTouch=t,this.startStateModifiers=new Set,this.activePointerMap=new Map,this.isDragging=!1,this.isCurrentDragSuppressed=!1,this.drag=this.registerOutgoing("drag"),this.registerIncoming("pointer-drag",this.handlePointerDrag.bind(this)),this.registerIncoming("pointer-up",this.handlePointerUpAndPointerLost.bind(this)),this.registerIncoming("pointer-capture-lost",this.handlePointerUpAndPointerLost.bind(this)),this.registerIncoming("pointer-cancel",this.handlePointerUpAndPointerLost.bind(this));}createPayload(t,e,i,n){return {action:t,pointerType:this.pointerType,button:this.mouseButton,buttons:e.buttons,timestamp:n,pointers:o$1(this.activePointerMap),pointer:e,angle:i.angle,radius:i.radius,center:i.center}}addPointer(t){const e=t.native.pointerId,i=a$3(this.activePointerMap).angle,n={event:t,initialAngle:0,lastAngle:0};this.activePointerMap.set(e,n);const s=h$3(n,r(this.activePointerMap));n.initialAngle=s,n.lastAngle=s,this.updatePointerAngles(i);}updatePointer(t){if(t&&null==t.x&&null==t.y)return;const e=t.native.pointerId,i=this.activePointerMap.get(e);i?i.event=t:this.addPointer(t);}removePointer(t){const e=a$3(this.activePointerMap).angle;this.activePointerMap.delete(t),this.updatePointerAngles(e);}updatePointerAngles(t){const e=a$3(this.activePointerMap);this.activePointerMap.forEach((i=>{i.initialAngle=h$3(i,e)-t,i.lastAngle=h$3(i,e)-t;}));}emitEvent(t,e,i){const n=a$3(this.activePointerMap);this.drag.emit(this.createPayload(t,e,n,i),void 0,this.startStateModifiers);}handlePointerUpAndPointerLost(t){const i=t.data.native.pointerId,n=n$B(t.timestamp);this.activePointerMap.get(i)&&(1===this.activePointerMap.size?(this.updatePointer(t.data),!this.isCurrentDragSuppressed&&this.emitEvent("end",t.data,n),this.isDragging=!1,this.isCurrentDragSuppressed=!1,this.removePointer(i)):(this.removePointer(i),this.emitEvent("removed",t.data,n$B(t.timestamp))));}handlePointerDrag(t){const i=t.data,n=i.currentEvent,s=n$B(t.timestamp);switch(i.action){case"start":case"update":this.isDragging?this.activePointerMap.has(n.native.pointerId)?(this.updatePointer(n),!this.isCurrentDragSuppressed&&this.emitEvent("update",n,s)):(this.addPointer(n),this.emitEvent("added",n,s),this.isCurrentDragSuppressed=this.isSuppressed):(this.updatePointer(n),this.pointerType=t.data.startEvent.pointerType,this.mouseButton=t.data.startEvent.button,this.startStateModifiers=t.modifiers,this.isDragging=!0,this.isCurrentDragSuppressed=this.isSuppressed,!this.isCurrentDragSuppressed&&this.emitEvent("start",n,s));}}get isSuppressed(){return this.navigationTouch&&!this.navigationTouch.browserTouchPanEnabled&&"touch"===this.pointerType&&1===this.activePointerMap.size}}function r(e){const i=[];return e.forEach((e=>{i.push(c$B(e.event.x,e.event.y));})),r$1(i)}function a$3(t){const e=r(t);let i=0;return t.forEach((t=>{let n=h$3(t,e),s=n-t.lastAngle;for(;s>Math.PI;)s-=2*Math.PI;for(;s<-Math.PI;)s+=2*Math.PI;n=t.lastAngle+s,t.lastAngle=n;const r=n-t.initialAngle;i+=r;})),i/=t.size||1,{angle:i,radius:e.radius,center:e.center}}function o$1(t){const e=new Map;return t.forEach(((t,i)=>e.set(i,t.event))),e}function h$3(t,e){const i=t.event,n=i.x-e.center.x,s=i.y-e.center.y;return Math.atan2(s,n)}var p$4;!function(t){t[t.Left=0]="Left",t[t.Middle=1]="Middle",t[t.Right=2]="Right",t[t.Back=3]="Back",t[t.Forward=4]="Forward",t[t.Undefined=-1]="Undefined";}(p$4||(p$4={}));

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
class n$5 extends i$b{constructor(e=l$4.maximumDoubleClickDelay,o=l$4.maximumDoubleClickDistance,n=l$4.maximumDoubleTouchDelay,a=l$4.maximumDoubleTouchDistance,s=o$l){super(!1),this.maximumDoubleClickDelay=e,this.maximumDoubleClickDistance=o,this.maximumDoubleTouchDelay=n,this.maximumDoubleTouchDistance=a,this._clock=s,this._pointerState=new Map,this._immediateDoubleClick=this.registerOutgoing("immediate-double-click"),this.registerIncoming("pointer-down",this._handlePointerDown.bind(this)),this.registerIncoming("pointer-up",(t=>{this._handlePointerLoss(t,"pointer-up");})),this.registerIncoming("pointer-capture-lost",(t=>{this._handlePointerLoss(t,"pointer-capture-lost");})),this.registerIncoming("pointer-cancel",(t=>{this._handlePointerLoss(t,"pointer-cancel");}));}onUninstall(){this._pointerState.forEach((t=>{t.immediateDoubleClick&&t.immediateDoubleClick.timeoutHandle.remove();})),super.onUninstall();}_handlePointerDown(t){const e=t.data,i=this._pointerId(e);if(!this._pointerState.has(i)){const t={downButton:e.native.button,immediateDoubleClick:null};this._pointerState.set(i,t),this.startCapturingPointer(e.native);}}_handlePointerLoss(t,e$1){const i=t.data,n=this._pointerId(i),a=this._pointerState.get(n);if(a&&"pointer-up"===e$1&&a.downButton===i.native.button){const e$1=a.immediateDoubleClick;if(e$1){e$1.timeoutHandle.remove();const n="touch"===t.data.native.pointerType?this.maximumDoubleTouchDistance:this.maximumDoubleClickDistance;e(e$1,t.data)>n?this._startImmediateDoubleClick(t,a):(this._immediateDoubleClick.emit(t.data,void 0,e$1.modifiers),this._removeState(i));}else this._startImmediateDoubleClick(t,a);}}_startImmediateDoubleClick(t,e){const i="touch"===t.data.native.pointerType?this.maximumDoubleTouchDelay:this.maximumDoubleClickDelay;e.immediateDoubleClick={x:t.data.x,y:t.data.y,modifiers:t.modifiers,timeoutHandle:this._clock.setTimeout((()=>this._removeState(t.data)),i)};}_pointerId(t){const e=t.native;return "mouse"===e.pointerType?`${e.pointerId}:${e.button}`:`${e.pointerType}`}_removeState(t){const e=this._pointerId(t);this._pointerState.delete(e),this.stopCapturingPointer(t.native),this.refreshHasPendingInputs();}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
const n$4={maximumClickDelay:300,movementUntilMouseDrag:1.5,movementUntilPenDrag:6,movementUntilTouchDrag:6,holdDelay:500};class o extends i$b{constructor(e=n$4.maximumClickDelay,i=n$4.movementUntilMouseDrag,o=n$4.movementUntilPenDrag,r=n$4.movementUntilTouchDrag,s=n$4.holdDelay,a=o$l){super(!1),this.maximumClickDelay=e,this.movementUntilMouseDrag=i,this.movementUntilPenDrag=o,this.movementUntilTouchDrag=r,this.holdDelay=s,this._clock=a,this._pointerState=new Map,this._pointerDrag=this.registerOutgoing("pointer-drag"),this._immediateClick=this.registerOutgoing("immediate-click"),this._pointerHold=this.registerOutgoing("hold"),this.registerIncoming("pointer-down",this._handlePointerDown.bind(this)),this.registerIncoming("pointer-up",(t=>{this._handlePointerLoss(t,"pointer-up");})),this.registerIncoming("pointer-capture-lost",(t=>{this._handlePointerLoss(t,"pointer-capture-lost");})),this.registerIncoming("pointer-cancel",(t=>{this._handlePointerLoss(t,"pointer-cancel");})),this._moveHandle=this.registerIncoming("pointer-move",this._handlePointerMove.bind(this)),this._moveHandle.pause();}onUninstall(){this._pointerState.forEach((t=>{null!=t.holdTimeout&&(t.holdTimeout.remove(),t.holdTimeout=null);})),super.onUninstall();}_handlePointerDown(t){const e=t.data,i=e.native.pointerId;let n=null;0===this._pointerState.size&&(n=this._clock.setTimeout((()=>{const e=this._pointerState.get(i);if(e){if(!e.isDragging){const i=e.previousEvent;this._pointerHold.emit(i,void 0,t.modifiers),e.holdEmitted=!0;}e.holdTimeout=null;}}),this.holdDelay));const o={startEvent:e,previousEvent:e,startTimestamp:t.timestamp,isDragging:!1,downButton:e.native.button,holdTimeout:n,modifiers:new Set};this._pointerState.set(i,o),this.startCapturingPointer(e.native),this._moveHandle.resume(),this._pointerState.size>1&&this.startDragging(t);}_createPointerDragData(t,e,i){return {action:t,startEvent:e.startEvent,previousEvent:e.previousEvent,currentEvent:i}}_handlePointerMove(t){const e=t.data,n=e.native.pointerId,o=this._pointerState.get(n);if(o){if(o.isDragging)this._pointerDrag.emit(this._createPointerDragData("update",o,e),void 0,o.modifiers);else {n$6(e,o.startEvent)>this._getDragThreshold(e.native.pointerType)&&this.startDragging(t);}o.previousEvent=e;}}_getDragThreshold(t){switch(t){case"touch":return this.movementUntilTouchDrag;case"pen":return this.movementUntilPenDrag;case"mouse":default:return this.movementUntilMouseDrag}}startDragging(t){const e=t.data,i=e.native.pointerId;this._pointerState.forEach((n=>{null!=n.holdTimeout&&(n.holdTimeout.remove(),n.holdTimeout=null),n.isDragging||(n.modifiers=t.modifiers,n.isDragging=!0,i===n.startEvent.native.pointerId?this._pointerDrag.emit(this._createPointerDragData("start",n,e)):this._pointerDrag.emit(this._createPointerDragData("start",n,n.previousEvent),t.timestamp));}));}_handlePointerLoss(t,e){const i=t.data,n=i.native.pointerId,o=this._pointerState.get(n);if(o){if(null!=o.holdTimeout&&(o.holdTimeout.remove(),o.holdTimeout=null),o.isDragging)this._pointerDrag.emit(this._createPointerDragData("end",o,"pointer-up"===e?i:o.previousEvent),void 0,o.modifiers);else if("pointer-up"===e&&o.downButton===i.native.button){t.timestamp-o.startTimestamp<=this.maximumClickDelay&&!o.holdEmitted&&this._immediateClick.emit(i);}this._pointerState.delete(n),this.stopCapturingPointer(i.native),0===this._pointerState.size&&this._moveHandle.pause();}}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
const t={checkMajorWebPerformanceCaveat:!0};function s$2(s){s={...t,...s};const o=r$m();return o.available?s.checkMajorWebPerformanceCaveat&&o.majorPerformanceCaveat?new s$j("webgl:major-performance-caveat-detected","Your WebGL implementation doesn't seem to support hardware accelerated rendering. Check your browser settings or if your GPU is in a blocklist."):o.supportsHighPrecisionFragment?o.supportsVertexShaderSamplers?o.supportsElementIndexUint?o.supportsStandardDerivatives?o.supportsInstancedArrays?null:new s$j("webgl:instanced-arrays-required","WebGL support for instanced rendering is required but not supported."):new s$j("webgl:standard-derivatives-required","WebGL support for standard derivatives is required but not supported."):new s$j("webgl:element-index-uint-required","WebGL support for uint vertex indices is required but not supported."):new s$j("webgl:vertex-shader-samplers-required","WebGL support for vertex shader samplers is required but not supported."):new s$j("webgl:high-precision-fragment-required","WebGL support for high precision fragment shaders is required but not supported."):new s$j("webgl:required","WebGL is required but not supported.")}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
function i$1(e){return e&&"nodeType"in e}function d$3(e){return e&&"function"==typeof e.render}const c$4={component:"esri-component"};let p$3=class extends p$q{constructor(){super(...arguments),this.widget=null;}destroy(){this.widget&&this.widget.destroy(),this.node=null;}get id(){return this.get("widget.id")||this.get("node.id")}set node(e){const o=this._get("node");e!==o&&(e&&e.classList.add(c$4.component),o&&o.classList.remove(c$4.component),this._set("node",e));}castNode(e){return e?"string"==typeof e||i$1(e)?(this._set("widget",null),e$h(e)):(d$3(e)&&!e.domNode&&(e.domNode=document.createElement("div")),this._set("widget",e),e.domNode):(this._set("widget",null),null)}};e$c([y$c({dependsOn:[]})],p$3.prototype,"id",null),e$c([y$c()],p$3.prototype,"node",null),e$c([c$u("node")],p$3.prototype,"castNode",null),e$c([y$c({readOnly:!0})],p$3.prototype,"widget",void 0),p$3=e$c([n$s("esri.views.ui.Component")],p$3);var l$3=p$3;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
const h$2={left:0,top:0,bottom:0,right:0},m$3={bottom:30,top:15,right:15,left:15},u$3="manual",f$1={ui:"esri-ui",corner:"esri-ui-corner",innerContainer:"esri-ui-inner-container",manualContainer:"esri-ui-manual-container",cornerContainer:"esri-ui-corner-container",topLeft:"esri-ui-top-left",topRight:"esri-ui-top-right",bottomLeft:"esri-ui-bottom-left",bottomRight:"esri-ui-bottom-right"};function _(t){return t&&!t._started&&"function"==typeof t.postMixInProperties&&"function"==typeof t.buildRendering&&"function"==typeof t.postCreate&&"function"==typeof t.startup}function g$3(t){return "object"==typeof t&&!(t instanceof l$3)&&!("declaredClass"in t)&&("component"in t||"index"in t||"position"in t)?t:null}function y$1(t,{top:i,bottom:o,left:e,right:n}){t.style.top=i,t.style.bottom=o,t.style.left=e,t.style.right=n;}let C=class extends n$v.EventedAccessor{constructor(t){super(t),this._cornerNameToContainerLookup={},this._positionNameToContainerLookup={},this._components=new Array,this._componentToKey=new Map,this._handles=new u$g,this.view=null,this._initContainers();}initialize(){this._handles.add([d$f(this,"view.padding, container",this._applyViewPadding.bind(this)),d$f(this,"padding",this._applyUIPadding.bind(this))]);}destroy(){this.container=null;for(const t of this._components)t.destroy();this._components.length=0,this._handles.destroy(),this._componentToKey.clear();}set container(t){const o=this._get("container");t!==o&&(t&&(t.classList.add(f$1.ui),t.classList.add(E$5()),this._attachContainers(t)),o&&(o.classList.remove(f$1.ui),y$1(o,{top:"",bottom:"",left:"",right:""}),t$h(o)),this._set("container",t));}get height(){const t=this.get("view.height")||0;if(0===t)return t;const i=this._getViewPadding(),o=i.top+i.bottom;return Math.max(t-o,0)}get padding(){return this._get("padding")}set padding(t){t?this._override("padding",t):this._clearOverride("padding");}castPadding(t){return "number"==typeof t?{bottom:t,top:t,right:t,left:t}:{...m$3,...t}}get width(){const t=this.get("view.width")||0;if(0===t)return t;const i=this._getViewPadding(),o=i.left+i.right;return Math.max(t-o,0)}add(t,i){let o,e;if(Array.isArray(t))return void t.forEach((t=>this.add(t,i)));const n=g$3(t);n&&({index:o,position:i,component:t,key:e}=n),i&&"object"==typeof i&&({index:o,key:e,position:i}=i),!t||i&&!this._isValidPosition(i)||this._add(t,i,o,e);}remove(t,i){if(!t)return;if(Array.isArray(t))return t.map((t=>this.remove(t,i)));const o=this._find(t);if(o){const e=this._componentToKey;if(e.has(t)&&e.get(t)!==i)return;const n=this._components.indexOf(o);return o.node.parentNode&&o.node.parentNode.removeChild(o.node),this._componentToKey.delete(t),this._components.splice(n,1)[0]}}empty(t){if(Array.isArray(t))return t.map((t=>this.empty(t))).reduce(((t,i)=>t.concat(i)));if((t=t||u$3)===u$3){return Array.prototype.slice.call(this._manualContainer.children).filter((t=>!t.classList.contains(f$1.corner))).map((t=>this.remove(t)))}return this._isValidPosition(t)?Array.prototype.slice.call(this._cornerNameToContainerLookup[t].children).map(this.remove,this):null}move(t,i){if(Array.isArray(t)&&t.forEach((t=>this.move(t,i))),!t)return;let o;const e=g$3(t)||g$3(i);if(e&&(o=e.index,i=e.position,t=e.component||t),i&&!this._isValidPosition(i))return;const n=this.remove(t);n&&this.add(n,{position:i,index:o});}find(t){if(!t)return null;const i=this._findById(t);return i&&(i.widget||i.node)}getPosition(t){for(const i in this._positionNameToContainerLookup){if(this._positionNameToContainerLookup[i].contains(t))return i}return null}_add(t,i,o,e){t instanceof l$3||(t=new l$3({node:t})),this._place({component:t,position:i,index:o}),this._components.push(t),e&&this._componentToKey.set(t,e);}_find(t){return t?t instanceof l$3?this._findByComponent(t):"string"==typeof t?this._findById(t):this._findByNode(t.domNode||t):null}_getViewPadding(){return this.get("view.padding")||h$2}_attachContainers(t){t.appendChild(this._innerContainer),t.appendChild(this._manualContainer);}_initContainers(){const t=document.createElement("div");t.classList.add(f$1.innerContainer),t.classList.add(f$1.cornerContainer);const i=document.createElement("div");i.classList.add(f$1.innerContainer),i.classList.add(f$1.manualContainer);const o=document.createElement("div");o.classList.add(f$1.topLeft),o.classList.add(f$1.corner),t.appendChild(o);const e=document.createElement("div");e.classList.add(f$1.topRight),e.classList.add(f$1.corner),t.appendChild(e);const n=document.createElement("div");n.classList.add(f$1.bottomLeft),n.classList.add(f$1.corner),t.appendChild(n);const r=document.createElement("div");r.classList.add(f$1.bottomRight),r.classList.add(f$1.corner),t.appendChild(r),this._innerContainer=t,this._manualContainer=i;const s=d$h();this._cornerNameToContainerLookup={"top-left":o,"top-right":e,"bottom-left":n,"bottom-right":r,"top-leading":s?e:o,"top-trailing":s?o:e,"bottom-leading":s?r:n,"bottom-trailing":s?n:r},this._positionNameToContainerLookup={manual:i,...this._cornerNameToContainerLookup};}_isValidPosition(t){return !!this._positionNameToContainerLookup[t]}_place(t){const i=t.component,e=t.position||u$3,n=t.index,r=this._positionNameToContainerLookup[e],s=n>-1;if(_(i.widget)&&i.widget.startup(),!s)return void r.appendChild(i.node);const a=Array.prototype.slice.call(r.children);if(0===n)return void(r.firstChild?o$m(i.node,r.firstChild):r.appendChild(i.node));n>=a.length?r.appendChild(i.node):o$m(i.node,a[n]);}_applyViewPadding(){const t=this.container;t&&y$1(t,this._toPxPosition(this._getViewPadding()));}_applyUIPadding(){const t=this._innerContainer;t&&y$1(t,this._toPxPosition(this.padding));}_toPxPosition(t){return {top:this._toPxUnit(t.top),left:this._toPxUnit(t.left),right:this._toPxUnit(t.right),bottom:this._toPxUnit(t.bottom)}}_toPxUnit(t){return 0===t?"0":t+"px"}_findByComponent(t){let i,o=null;return this._components.some((e=>(i=e===t,i&&(o=e),i))),o}_findById(t){let i,o=null;return this._components.some((e=>(i=e.id===t,i&&(o=e),i))),o}_findByNode(t){let i,o=null;return this._components.some((e=>(i=e.node===t,i&&(o=e),i))),o}};e$c([y$c()],C.prototype,"container",null),e$c([y$c()],C.prototype,"height",null),e$c([y$c({value:m$3})],C.prototype,"padding",null),e$c([c$u("padding")],C.prototype,"castPadding",null),e$c([y$c()],C.prototype,"view",void 0),e$c([y$c()],C.prototype,"width",null),C=e$c([n$s("esri.views.ui.UI")],C);var v=C;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
function p$2(t,e){return t&&"copyright"in t&&(!e||"function"==typeof t.originOf&&"user"===t.originOf("copyright"))}function d$2(t,e){return t.length!==e.length||t.some(((t,i)=>t.text!==e[i].text))}function m$2(t,e,i){if(!i||!e)return;t.find((t=>t.layerView===e&&t.text===i))||t.push({text:i,layerView:e});}function f(t){return "bing-maps"===t.type}const b=[];let y=class extends d$g{constructor(t){super(t),this.clear=()=>{this._fetchedAttributionData.clear(),this._pendingAttributions.clear(),this.handles.remove("suspension"),this.notifyChange("state");},this._pendingAttributions=new Set,this._fetchedAttributionData=new Map,this.items=new L$3,this.view=null,this._allLayerViewsChange=t=>{this.handles.remove("suspension");const e=this.get("view.allLayerViews");e&&this.handles.add(e.map((t=>t.watch(["suspended","attributionVisible"],this._updateAttributionItems))),"suspension"),t&&t.removed&&t.removed.forEach((t=>{this._pendingAttributions.delete(t),this._fetchedAttributionData.delete(t);})),this._updateAttributionItems();},this._updateAttributionItems=()=>{const t=this.get("view.allLayerViews");b.length=0,t?(t.forEach((t=>{if(t.suspended||!t.get("layer.attributionVisible"))return;const e=t.layer;if(p$2(e,"user"))return void m$2(b,t,e.copyright);if(e.hasAttributionData){if(this._fetchedAttributionData.has(t)){const i=this._fetchedAttributionData.get(t);return void(i?m$2(b,t,this._getDynamicAttribution(i,this.view,e)):p$2(e)&&m$2(b,t,e.copyright))}return void this._fetchAttributionData(t)}const i=e.get("portalItem.accessInformation");m$2(b,t,i||e.copyright);})),d$2(this.items,b)&&(this.items.removeAll(),this.items.addMany(b)),b.length=0,this.notifyChange("state")):this.clear();},this.handles.add([C$4(this,"view.allLayerViews","change",this._allLayerViewsChange,this._allLayerViewsChange,this.clear),w$7(this,"view.stationary",(()=>this._updateAttributionItems()))]);}destroy(){this.view=null,this._fetchedAttributionData.clear(),this._pendingAttributions.clear(),this.items.removeAll();}get state(){return this.get("view.ready")?this._pendingAttributions.size>0?"loading":"ready":"disabled"}async _fetchAttributionData(t){if(this._pendingAttributions.has(t))return;this._pendingAttributions.add(t);const i=await a$m(t.layer.fetchAttributionData());if(this._pendingAttributions.has(t)){const e=i.ok?this._createContributionIndex(i.value,f(t.layer)):null;this._pendingAttributions.delete(t),this._fetchedAttributionData.set(t,e);}this._updateAttributionItems();}_createContributionIndex(t,e){const i=t.contributors,r={};if(!i)return r;for(let o=0;o<i.length;o++){const t=i[o],s=t.coverageAreas;if(!s)return;for(const i of s){const s=i.bbox,n=i.zoomMin-(e&&i.zoomMin?1:0),a=i.zoomMax-(e&&i.zoomMax?1:0),c={xmin:s[1],ymin:s[0],xmax:s[3],ymax:s[2],spatialReference:k$4.WGS84},u={extent:d$i(c),attribution:t.attribution||"",score:null!=i.score?i.score:100,id:o};for(let t=n;t<=a;t++)r[t]=r[t]||[],r[t].push(u);}}return r.maxKey=Math.max.apply(null,Object.keys(r)),r}_getDynamicAttribution(t,e,i){const{extent:r,scale:o}=e;let s=i.tileInfo.scaleToZoom(o);if(s=Math.min(t.maxKey,Math.round(s)),!r||null==s||s<=-1)return "";const n=t[s],a=g$i(r.center.clone().normalize(),e.spatialReference),h={};return n?n.filter((t=>{const e=!h[t.id]&&a&&t$k(t.extent,a);return e&&(h[t.id]=!0),e})).sort(((t,e)=>e.score-t.score||t.objectId-e.objectId)).map((t=>t.attribution)).join(", "):""}};e$c([y$c({readOnly:!0,type:L$3})],y.prototype,"items",void 0),e$c([y$c({readOnly:!0})],y.prototype,"state",null),e$c([y$c()],y.prototype,"view",void 0),y=e$c([n$s("esri.widgets.Attribution.AttributionViewModel")],y);var g$2=y;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
const p$1={base:"esri-attribution esri-widget",anchor:"esri-widget__anchor",poweredBy:"esri-attribution__powered-by",sources:"esri-attribution__sources",open:"esri-attribution--open",sourcesOpen:"esri-attribution__sources--open",link:"esri-attribution__link",widgetIcon:"esri-icon-description",interactive:"esri-interactive"};let l$2=class extends x$2{constructor(e,t){super(e,t),this._isOpen=!1,this._attributionTextOverflowed=!1,this._prevSourceNodeHeight=0,this.iconClass=p$1.widgetIcon,this.itemDelimiter=" | ",this.label=void 0,this.messages=null,this.view=null,this.viewModel=new g$2;}initialize(){this.own(C$4(this,"viewModel.items","change",(()=>this.scheduleRender())));}get attributionText(){return this.viewModel.items.reduce(((e,t)=>(-1===e.indexOf(t.text)&&e.push(t.text),e)),[]).join(this.itemDelimiter)}render(){const e={[p$1.open]:this._isOpen};return n$u("div",{bind:this,class:this.classes(p$1.base,e),onclick:this._toggleState,onkeydown:this._toggleState},this.renderSourcesNode(),this.renderPoweredBy())}renderPoweredBy(){return n$u("div",{class:p$1.poweredBy},"Powered by"," ",n$u("a",{class:this.classes(p$1.link,p$1.anchor),href:"http://www.esri.com/",target:"_blank",rel:"noreferrer"},"Esri"))}renderSourcesNode(){const e=this._isOpen,t=this._isInteractive(),i=t?0:-1,{attributionText:r}=this,s=t?"button":void 0,o={[p$1.sourcesOpen]:e,[p$1.interactive]:t};return n$u("div",{afterCreate:this._afterSourcesNodeCreate,afterUpdate:this._afterSourcesNodeUpdate,bind:this,class:this.classes(p$1.sources,o),innerHTML:r,role:s,tabIndex:i})}_afterSourcesNodeCreate(e){this._prevSourceNodeHeight=e.clientWidth;}_afterSourcesNodeUpdate(e){let t=!1;const{clientHeight:i,clientWidth:r,scrollWidth:s}=e,o=s>=r,n=this._attributionTextOverflowed!==o;if(this._attributionTextOverflowed=o,n&&(t=!0),this._isOpen){const e=i<this._prevSourceNodeHeight;this._prevSourceNodeHeight=i,e&&(this._isOpen=!1,t=!0);}t&&this.scheduleRender();}_toggleState(){this._isInteractive()&&(this._isOpen=!this._isOpen);}_isInteractive(){return this._isOpen||this._attributionTextOverflowed}};e$c([y$c({readOnly:!0,dependsOn:["viewModel.items.length","itemDelimiter"]})],l$2.prototype,"attributionText",null),e$c([y$c()],l$2.prototype,"iconClass",void 0),e$c([y$c()],l$2.prototype,"itemDelimiter",void 0),e$c([y$c({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],l$2.prototype,"label",void 0),e$c([y$c(),e$d("esri/widgets/Attribution/t9n/Attribution")],l$2.prototype,"messages",void 0),e$c([o$g("viewModel.view")],l$2.prototype,"view",void 0),e$c([y$c({type:g$2})],l$2.prototype,"viewModel",void 0),e$c([t$d()],l$2.prototype,"_toggleState",null),l$2=e$c([n$s("esri.widgets.Attribution")],l$2);var u$2=l$2;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
const n$3="esri.widgets.CompassViewModel";let h$1=class extends(s$b(p$q)){constructor(t){super(t),this._handles=new u$g,this.orientation={x:0,y:0,z:0},this.view=null,this._updateForCamera=this._updateForCamera.bind(this),this._updateForRotation=this._updateForRotation.bind(this),this._updateRotationWatcher=this._updateRotationWatcher.bind(this);}initialize(){this._handles.add(d$f(this,"view",this._updateRotationWatcher));}destroy(){this._handles.destroy(),this._handles=null,this.view=null;}get canShowNorth(){const t=this.get("view.spatialReference");return !(!t||!t.isWebMercator&&!t.isGeographic)}get state(){return this.get("view.ready")?this.canShowNorth?"compass":"rotation":"disabled"}reset(){if(!this.get("view.ready"))return;const t={};"2d"===this.view.type?t.rotation=0:t.heading=0,this.callGoTo({target:t});}_updateForRotation(t){null!=t&&(this.orientation={z:t});}_updateForCamera(t){if(!t)return;const e=-t.heading;this.orientation={x:0,y:0,z:e};}_updateRotationWatcher(t){this._handles.removeAll(),t&&("2d"===t.type?this._handles.add(d$f(this,"view.rotation",this._updateForRotation)):this._handles.add(d$f(this,"view.camera",this._updateForCamera)));}};e$c([y$c({readOnly:!0})],h$1.prototype,"canShowNorth",null),e$c([y$c()],h$1.prototype,"orientation",void 0),e$c([y$c({readOnly:!0})],h$1.prototype,"state",null),e$c([y$c()],h$1.prototype,"view",void 0),h$1=e$c([n$s(n$3)],h$1);var d$1=h$1;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
const n$2={base:"esri-compass esri-widget--button esri-widget",text:"esri-icon-font-fallback-text",icon:"esri-compass__icon",rotationIcon:"esri-icon-dial",northIcon:"esri-icon-compass",widgetIcon:"esri-icon-locate-circled",interactive:"esri-interactive",disabled:"esri-disabled"};let d=class extends x$2{constructor(e,s){super(e,s),this.goToOverride=null,this.iconClass=n$2.widgetIcon,this.label=void 0,this.messages=null,this.view=null,this.viewModel=new d$1;}reset(){return this.viewModel.reset()}render(){const{orientation:e,state:s}=this.viewModel,o="disabled"===s,t="compass"===("rotation"===s?"rotation":"compass"),r=o?-1:0,i={[n$2.disabled]:o,[n$2.interactive]:!o},a={[n$2.northIcon]:t,[n$2.rotationIcon]:!t},{messages:c}=this;return n$u("div",{bind:this,class:this.classes(n$2.base,i),onclick:this._reset,onkeydown:this._reset,role:"button",tabIndex:r,"aria-label":c.reset,title:c.reset},n$u("span",{"aria-hidden":"true",class:this.classes(n$2.icon,a),styles:this._toRotationTransform(e)}),n$u("span",{class:n$2.text},c.reset))}_reset(){this.viewModel.reset();}_toRotationTransform(e){return {transform:`rotateZ(${e.z}deg)`}}};e$c([o$g("viewModel.goToOverride")],d.prototype,"goToOverride",void 0),e$c([y$c()],d.prototype,"iconClass",void 0),e$c([y$c({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],d.prototype,"label",void 0),e$c([y$c(),e$d("esri/widgets/Compass/t9n/Compass")],d.prototype,"messages",void 0),e$c([o$g("viewModel.view")],d.prototype,"view",void 0),e$c([y$c({type:d$1})],d.prototype,"viewModel",void 0),e$c([t$d()],d.prototype,"_reset",null),d=e$c([n$s("esri.widgets.Compass")],d);var l$1=d;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
let a$2=class extends p$q{constructor(t){super(t),this._handles=new u$g,this.navigationMode="pan",this.view=null;}initialize(){this._handles.add(y$e(this,"view.inputManager",this._setNavigationMode.bind(this)));}destroy(){this._handles.destroy(),this._handles=null,this.view=null;}get state(){return this.get("view.ready")&&"3d"===this.view.type?"ready":"disabled"}toggle(){"disabled"!==this.state&&(this.navigationMode="pan"!==this.navigationMode?"pan":"rotate",this._setNavigationMode());}_setNavigationMode(){this.get("view.inputManager").primaryDragAction="pan"===this.navigationMode?"pan":"rotate";}};e$c([y$c({readOnly:!0})],a$2.prototype,"state",null),e$c([y$c()],a$2.prototype,"navigationMode",void 0),e$c([y$c()],a$2.prototype,"view",void 0),a$2=e$c([n$s("esri.widgets.NavigationToggleViewModel")],a$2);var n$1=a$2;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
const g$1={base:"esri-navigation-toggle esri-widget",button:"esri-navigation-toggle__button esri-widget--button",activeButton:"esri-navigation-toggle__button--active",panButton:"esri-navigation-toggle__button--pan",rotateButton:"esri-navigation-toggle__button--rotate",isLayoutHorizontal:"esri-navigation-toggle--horizontal",rotationIcon:"esri-icon-rotate",panIcon:"esri-icon-pan",widgetIcon:"esri-icon-pan2",disabled:"esri-disabled"};let p=class extends x$2{constructor(t,o){super(t,o),this.iconClass=g$1.widgetIcon,this.label=void 0,this.messages=null,this.view=null,this.viewModel=new n$1;}set layout(t){"horizontal"!==t&&(t="vertical"),this._set("layout",t);}toggle(){return this.viewModel.toggle()}render(){const t="disabled"===this.get("viewModel.state"),o="pan"===this.get("viewModel.navigationMode"),e={[g$1.disabled]:t,[g$1.isLayoutHorizontal]:"horizontal"===this.layout},s={[g$1.activeButton]:o},i={[g$1.activeButton]:!o},a=t?-1:0,r=this.messages.toggle;return n$u("div",{bind:this,class:this.classes(g$1.base,e),onclick:this._toggle,onkeydown:this._toggle,tabIndex:a,"aria-label":r,title:r},n$u("div",{class:this.classes(g$1.button,g$1.panButton,s)},n$u("span",{class:g$1.panIcon})),n$u("div",{class:this.classes(g$1.button,g$1.rotateButton,i)},n$u("span",{class:g$1.rotationIcon})))}_toggle(){this.toggle();}};e$c([y$c()],p.prototype,"iconClass",void 0),e$c([y$c({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],p.prototype,"label",void 0),e$c([y$c({value:"vertical"})],p.prototype,"layout",null),e$c([y$c(),e$d("esri/widgets/NavigationToggle/t9n/NavigationToggle")],p.prototype,"messages",void 0),e$c([o$g("viewModel.view")],p.prototype,"view",void 0),e$c([y$c({type:n$1})],p.prototype,"viewModel",void 0),e$c([t$d()],p.prototype,"_toggle",null),p=e$c([n$s("esri.widgets.NavigationToggle")],p);var c$3=p;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
const c$2={button:"esri-widget--button esri-widget",disabled:"esri-disabled",interactive:"esri-interactive",iconText:"esri-icon-font-fallback-text",icon:"esri-icon"};let n=class extends x$2{constructor(){super(...arguments),this.enabled=!0,this.iconClass="",this.title="";}render(){const t=this.enabled?0:-1,s={[c$2.disabled]:!this.enabled,[c$2.interactive]:this.enabled},e={[this.iconClass]:!!this.iconClass};return n$u("div",{bind:this,class:this.classes(c$2.button,s),onclick:this._triggerAction,onkeydown:this._triggerAction,role:"button",tabIndex:t,title:this.title},n$u("span",{"aria-hidden":"true",role:"presentation",class:this.classes(c$2.icon,e)}),n$u("span",{class:c$2.iconText},this.title))}_triggerAction(){this.action.call(this);}};e$c([y$c()],n.prototype,"action",void 0),e$c([y$c()],n.prototype,"enabled",void 0),e$c([y$c()],n.prototype,"iconClass",void 0),e$c([y$c()],n.prototype,"title",void 0),e$c([t$d()],n.prototype,"_triggerAction",null),n=e$c([n$s("esri.widgets.IconButton")],n);var a$1=n;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
let s$1=class extends p$q{get canZoomIn(){if(!this.get("view.ready"))return !1;const e=this.get("view.animation.target.scale")||this.get("view.scale"),t=this.get("view.constraints.effectiveMaxScale");return 0===t||e>t}get canZoomOut(){if(!this.get("view.ready"))return !1;const e=this.get("view.animation.target.scale")||this.get("view.scale"),t=this.get("view.constraints.effectiveMinScale");return 0===t||e<t}};e$c([y$c({readOnly:!0})],s$1.prototype,"canZoomIn",null),e$c([y$c({readOnly:!0})],s$1.prototype,"canZoomOut",null),e$c([y$c()],s$1.prototype,"view",void 0),s$1=e$c([n$s("esri.widgets.Zoom.ZoomConditions2D")],s$1);var i=s$1;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
let s=class extends p$q{get canZoomIn(){return !!this.get("view.ready")}get canZoomOut(){return !!this.get("view.ready")}};e$c([y$c({readOnly:!0})],s.prototype,"canZoomIn",null),e$c([y$c({readOnly:!0})],s.prototype,"canZoomOut",null),e$c([y$c()],s.prototype,"view",void 0),s=e$c([n$s("esri.widgets.Zoom.ZoomConditions3D")],s);var c$1=s;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
let m$1=class extends p$q{constructor(o){super(o),this.canZoomIn=!1,this.canZoomOut=!1;}destroy(){this.view=null;}get state(){return this.get("view.ready")?"ready":"disabled"}set view(o){o?"2d"===o.type?this._zoomConditions=new i({view:o}):"3d"===o.type&&(this._zoomConditions=new c$1({view:o})):this._zoomConditions=null,this._set("view",o);}zoomIn(){if(!this.canZoomIn)return;const o=this.view;"2d"===o.type?o.mapViewNavigation.zoomIn():y$g(o.goTo({zoomFactor:2}));}zoomOut(){if(!this.canZoomOut)return;const o=this.view;"2d"===o.type?o.mapViewNavigation.zoomOut():y$g(o.goTo({zoomFactor:.5}));}};e$c([y$c()],m$1.prototype,"_zoomConditions",void 0),e$c([y$c({aliasOf:"_zoomConditions.canZoomIn",readOnly:!0})],m$1.prototype,"canZoomIn",void 0),e$c([y$c({aliasOf:"_zoomConditions.canZoomOut",readOnly:!0})],m$1.prototype,"canZoomOut",void 0),e$c([y$c({readOnly:!0})],m$1.prototype,"state",null),e$c([y$c()],m$1.prototype,"view",null),m$1=e$c([n$s("esri.widgets.Zoom.ZoomViewModel")],m$1);var a=m$1;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
const u$1={base:"esri-zoom esri-widget",horizontalLayout:"esri-zoom--horizontal",zoomInIcon:"esri-icon-plus",zoomOutIcon:"esri-icon-minus",widgetIcon:"esri-icon-zoom-in-magnifying-glass"};let l=class extends x$2{constructor(o,t){super(o,t),this.iconClass=u$1.widgetIcon,this.label=void 0,this.messages=null,this.view=null,this.viewModel=new a;}initialize(){this._zoomInButton=new a$1({action:this.zoomIn.bind(this),iconClass:u$1.zoomInIcon}),this._zoomOutButton=new a$1({action:this.zoomOut.bind(this),iconClass:u$1.zoomOutIcon});}destroy(){this._zoomInButton.destroy(),this._zoomOutButton.destroy(),this._zoomInButton=null,this._zoomOutButton=null;}set layout(o){"horizontal"!==o&&(o="vertical"),this._set("layout",o);}render(){const o=this.viewModel,t={[u$1.horizontalLayout]:"horizontal"===this.layout};return this._zoomInButton.enabled="ready"===o.state&&o.canZoomIn,this._zoomOutButton.enabled="ready"===o.state&&o.canZoomOut,this._zoomInButton.title=this.messages.zoomIn,this._zoomOutButton.title=this.messages.zoomOut,n$u("div",{class:this.classes(u$1.base,t)},this._zoomInButton.render(),this._zoomOutButton.render())}zoomIn(){return this.viewModel.zoomIn()}zoomOut(){return this.viewModel.zoomOut()}};e$c([y$c()],l.prototype,"iconClass",void 0),e$c([y$c({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],l.prototype,"label",void 0),e$c([y$c({value:"vertical"})],l.prototype,"layout",null),e$c([y$c(),e$d("esri/widgets/Zoom/t9n/Zoom")],l.prototype,"messages",void 0),e$c([o$g("viewModel.view")],l.prototype,"view",void 0),e$c([y$c({type:a})],l.prototype,"viewModel",void 0),l=e$c([n$s("esri.widgets.Zoom")],l);var c=l;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
const m="esri.views.ui.DefaultUI";function h(t){return t&&void 0!==t.view}n$t.getLogger(m);let g=class extends v{constructor(t){super(t),this._defaultPositionLookup={attribution:"manual",compass:"top-leading","navigation-toggle":"top-leading",zoom:"top-leading"},this.components=[];}initialize(){this._handles.add([d$f(this,"components",this._componentsWatcher.bind(this)),d$f(this,"view",this._updateViewAwareWidgets.bind(this))]);}_add(t,o,e,i){if("string"==typeof t&&this._defaultPositionLookup[t]){if(this._find(t))return;t=this._createComponent(t);}super._add(t,o,e,i);}_removeComponents(t){t.forEach((t=>{const o=this._find(t);o&&(this.remove(o),o.destroy());}));}_updateViewAwareWidgets(t){this.components.forEach((o=>{const e=this._find(o),i=e&&e.widget;h(i)&&(i.view=t);}));}_componentsWatcher(t,o){this._removeComponents(o),this._addComponents(t),this._adjustPadding(t);}_adjustPadding(t){if(-1===t.indexOf("attribution")&&!this._isOverridden("padding")){const{top:t}=this.padding;this.padding=t;}}_addComponents(t){this.initialized&&t.forEach((t=>this.add(this._createComponent(t),this._defaultPositionLookup[t])));}_createComponent(t){const o=this._createWidget(t);if(o)return new l$3({id:t,node:o})}_createWidget(t){return "attribution"===t?this._createAttribution():"compass"===t?this._createCompass():"navigation-toggle"===t?this._createNavigationToggle():"zoom"===t?this._createZoom():void 0}_createAttribution(){return new u$2({view:this.view})}_createCompass(){return new l$1({view:this.view})}_createNavigationToggle(){return new c$3({view:this.view})}_createZoom(){return new c({view:this.view})}};e$c([y$c()],g.prototype,"components",void 0),g=e$c([n$s(m)],g);var u=g;

export { x as $, At as A, m$d as B, i$6 as C, n$e as D, s$2 as E, Ft as F, Gt as G, d$6 as H, I$1 as I, J, w as K, q as L, S$2 as M, r$4 as N, F as O, P, P$1 as Q, d$5 as R, St as S, o$3 as T, z$1 as U, U$1 as V, W, f$3 as X, r$8 as Y, Z, _$4 as _, a$9 as a, r$6 as a0, n$a as a1, t$8 as a2, e$4 as a3, e$b as a4, rt as a5, $ as a6, Mt as a7, xt as a8, vt as a9, p$c as aa, pt as ab, r$b as ac, c$g as ad, o$9 as ae, f$c as af, d$e as ag, g$f as ah, F$3 as ai, b$7 as aj, l$g as ak, j$1 as al, _$3 as am, b$2 as an, g$7 as ao, e$3 as ap, bt as b, t$2 as c, t$1 as d, a$6 as e, i$2 as f, n$h as g, ht as h, i$b as i, e as j, kt as k, l$4 as l, u$4 as m, n$c as n, n$5 as o, o as p, s$4 as q, s$3 as r, s$7 as s, tt as t, u$7 as u, d$8 as v, wt as w, e$1 as x, u$b as y, u as z };

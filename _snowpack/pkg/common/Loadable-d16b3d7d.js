import { w as k$1, n as n$5, x as r$3, y as y$2, z as t$4 } from './subclass-fe5fcf78.js';
import { M as M$2, u as u$2, m as m$3, j as j$2 } from './Polyline-ccd8fb47.js';
import { p as p$2, b as b$1 } from './Point-ee7951c3.js';
import './SpatialReference-843b1520.js';
import { s as s$1 } from './jsonMap-e142bd84.js';
import { n as n$4, d as s$2, m as m$4, r as r$2, t as t$3, c as s$4, y as y$1, e, f as e$1 } from './Message-70b34921.js';
import { s as s$3, b as b$2, h as h$3, v as v$1, g as g$1, m as m$5, E as E$1, P as P$2 } from './promiseUtils-2ff2b194.js';
import { e as e$2, p as p$3 } from './JSONSupport-9346590f.js';

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
const i$3=s$1()({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon"}),t$2=s$1()({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryEnvelope:"extent",mesh:"mesh"});

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
const i$2={base:p$2,key:"type",typeMap:{extent:M$2,multipoint:u$2,point:b$1,polyline:m$3,polygon:j$2}};k$1(i$2);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
const u$1=n$4.getLogger("esri.core.urlUtils"),l=s$2.request,c$1="esri/config: esriConfig.request.proxyUrl is not set.",f$1=/^\s*[a-z][a-z0-9-+.]*:(?![0-9])/i,a=/^\s*http:/i,h$2=/^\s*https:/i,p$1=/^\s*file:/i,d$1=/:\d+$/,g=/^https?:\/\/[^/]+\.arcgis.com\/sharing(\/|$)/i,m$2=new RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?$"),y=new RegExp("^((([^\\[:]+):)?([^@]+)@)?(\\[([^\\]]+)\\]|([^\\[:]*))(:([0-9]+))?$");class $$1{constructor(t=""){this.uri=t,this.scheme=null,this.authority=null,this.path=null,this.query=null,this.fragment=null,this.user=null,this.password=null,this.host=null,this.port=null;let e=m$4(this.uri.match(m$2));this.scheme=e[2]||(e[1]?"":null),this.authority=e[4]||(e[3]?"":null),this.path=e[5],this.query=e[7]||(e[6]?"":null),this.fragment=e[9]||(e[8]?"":null),null!=this.authority&&(e=m$4(this.authority.match(y)),this.user=e[3]||null,this.password=e[4]||null,this.host=e[6]||e[7],this.port=e[9]||null);}toString(){return this.uri}}const x=new $$1(s$2.applicationUrl),O={},w=(()=>{const t=m$4(x.path),e=t.substring(0,t.lastIndexOf(t.split("/")[t.split("/").length-1]));return `${`${x.scheme}://${x.host}${null!=x.port?`:${x.port}`:""}`}${e}`})();function U$1(t){const e={path:null,query:null},n=new $$1(t),r=t.indexOf("?");return null===n.query?e.path=t:(e.path=t.substring(0,r),e.query=b(n.query)),n.fragment&&(e.hash=n.fragment,null===n.query&&(e.path=e.path.substring(0,e.path.length-(n.fragment.length+1)))),e}function b(t){const e=t.split("&"),n={};for(const r of e){if(!r)continue;const t=r.indexOf("=");let e,o;t<0?(e=decodeURIComponent(r),o=""):(e=decodeURIComponent(r.slice(0,t)),o=decodeURIComponent(r.slice(t+1)));let i=n[e];"string"==typeof i&&(i=n[e]=[i]),Array.isArray(i)?i.push(o):n[e]=o;}return n}function R$1(t){return t&&"object"==typeof t&&"toJSON"in t&&"function"==typeof t.toJSON}function C(t,e){return t?e&&"function"==typeof e?Object.keys(t).map((n=>encodeURIComponent(n)+"="+encodeURIComponent(e(n,t[n])))).join("&"):Object.keys(t).map((n=>{const r=t[n];if(null==r)return "";const o=encodeURIComponent(n)+"=",i=e&&e[n];return i?o+encodeURIComponent(i(r)):Array.isArray(r)?r.map((t=>R$1(t)?o+encodeURIComponent(JSON.stringify(t)):o+encodeURIComponent(t))).join("&"):R$1(r)?o+encodeURIComponent(JSON.stringify(r)):o+encodeURIComponent(r)})).filter((t=>t)).join("&"):""}function q(t=!1){let n,r=l.proxyUrl;if("string"==typeof t){n=rt(t);const e=A$1(t);e&&(r=e.proxyUrl);}else n=!!t;if(!r)throw u$1.warn(c$1),new s$3("urlutils:proxy-not-set",c$1);n&&ct()&&(r=ut(r));return U$1(r)}function j$1(t){const e=A$1(t);let n,r;if(e){const t=v(e.proxyUrl);n=t.path,r=t.query?b(t.query):null;}if(n){const e=U$1(t);t=n+"?"+e.path;const o=C({...r,...e.query});o&&(t=`${t}?${o}`);}return t}const L$1={path:"",query:""};function v(t){const e=t.indexOf("?");return -1!==e?(L$1.path=t.slice(0,e),L$1.query=t.slice(e+1)):(L$1.path=t,L$1.query=null),L$1}function I$1(t){return t=(t=ft(t=dt(t=v(t).path),!0)).toLowerCase()}function S(t){const e={proxyUrl:t.proxyUrl,urlPrefix:I$1(t.urlPrefix)},n=l.proxyRules,r=e.urlPrefix;let o=n.length;for(let i=0;i<n.length;i++){const t=n[i].urlPrefix;if(0===r.indexOf(t)){if(r.length===t.length)return -1;o=i;break}0===t.indexOf(r)&&(o=i+1);}return n.splice(o,0,e),o}function A$1(t){const e=l.proxyRules,n=I$1(t);for(let r=0;r<e.length;r++)if(0===n.indexOf(e[r].urlPrefix))return e[r]}function P$1(t,e){return t=k(t),e=k(e),ft(t)===ft(e)}function k(t){const e=(t=z$1(t)).indexOf("/sharing");return e>0?t.substring(0,e):t.replace(/\/+$/,"")}function B$1(t){const e=e=>null==e||e instanceof RegExp&&e.test(t)||"string"==typeof e&&t.startsWith(e),n=l.interceptors;if(n)for(const r of n)if(Array.isArray(r.urls)){if(r.urls.some(e))return r}else if(e(r.urls))return r;return null}function E(t,e,n=!1){const r=Ot(t),o=Ot(e);return !(!n&&r.scheme!==o.scheme)&&(null!=r.host&&null!=o.host&&(r.host.toLowerCase()===o.host.toLowerCase()&&r.port===o.port))}function J$1(t){if("string"==typeof t){if(!Q$1(t))return !0;t=Ot(t);}if(E(t,x))return !0;const e=l.trustedServers||[];for(let n=0;n<e.length;n++){const r=N$1(e[n]);for(let e=0;e<r.length;e++)if(E(t,r[e]))return !0}return !1}function N$1(t){return O[t]||(nt(t)||et(t)?O[t]=[new $$1(T(t))]:O[t]=[new $$1(`http://${t}`),new $$1(`https://${t}`)]),O[t]}function T(t,e=w,n){return et(t)?n&&n.preserveProtocolRelative?t:"http"===x.scheme&&x.authority===M$1(t).slice(2)?`http:${t}`:`https:${t}`:nt(t)?t:m$4(D$1("/"===t[0]?at(e):e,t))}function W$1(t,e=w,n){if(!Q$1(t))return t;const r=z$1(t),o=r.toLowerCase(),i=z$1(e).toLowerCase().replace(/\/+$/,""),s=n?z$1(n).toLowerCase().replace(/\/+$/,""):null;if(s&&0!==i.indexOf(s))return t;const u=(t,e,n)=>-1===(n=t.indexOf(e,n))?t.length:n;let l=u(o,"/",o.indexOf("//")+2),c=-1;for(;o.slice(0,l+1)===i.slice(0,l)+"/"&&(c=l+1,l!==o.length);)l=u(o,"/",l+1);if(-1===c)return t;if(s&&c<s.length)return t;t=r.slice(c);const f=i.slice(c-1).replace(/[^/]+/g,"").length;if(f>0)for(let a=0;a<f;a++)t=`../${t}`;else t=`./${t}`;return t}function z$1(t){return t=$t(t=yt(t=mt(t=T(t=t.trim()))))}function D$1(...t){const e=t.filter(r$2);if(!e||!e.length)return;const n=[];if(Q$1(e[0])){const t=e[0],r=t.indexOf("//");-1!==r&&(n.push(t.slice(0,r+1)),it(e[0])&&(n[0]+="/"),e[0]=t.slice(r+2));}else "/"===e[0][0]&&n.push("");const r=e.reduce(((t,e)=>e?t.concat(e.split("/")):t),[]);for(let o=0;o<r.length;o++){const t=r[o];".."===t&&n.length>0&&".."!==n[n.length-1]?n.pop():(!t&&o===r.length-1||t&&("."!==t||0===n.length))&&n.push(t);}return n.join("/")}function M$1(t,e=!1){if(F$1(t)||G$1(t))return null;let n=t.indexOf("://");if(-1===n&&et(t))n=2;else {if(-1===n)return null;n+=3;}const r=t.indexOf("/",n);return -1!==r&&(t=t.slice(0,r)),e&&(t=ft(t,!0)),t}function Q$1(t){return et(t)||nt(t)}function F$1(t){return null!=t&&"blob:"===t.slice(0,5)}function G$1(t){return "data:"===t.slice(0,5)}function H$1(t){const e=V$1(t);if(!e||!e.isBase64)return null;const n=atob(e.data),r=new Uint8Array(n.length);for(let o=0;o<n.length;o++)r[o]=n.charCodeAt(o);return r.buffer}const K$1=/^data:(.*?)(;base64)?,(.*)$/;function V$1(t){const e=t.match(K$1);if(!e)return null;const[,n,r,o]=e;return {mediaType:n,isBase64:!!r,data:o}}function X$1(t){return t.isBase64?`data:${t.mediaType};base64,${t.data}`:`data:${t.mediaType},${t.data}`}function et(t){return null!=t&&void 0!==t&&"/"===t[0]&&"/"===t[1]}function nt(t){return f$1.test(t)}function rt(t){return h$2.test(t)||"https"===x.scheme&&et(t)}function ot(t){return a.test(t)||"http"===x.scheme&&et(t)}function it(t){return p$1.test(t)}function ut(t){return et(t)?`https:${t}`:t.replace(a,"https:")}function lt(){return "http"===x.scheme}function ct(){return "https"===x.scheme}function ft(t,e=!1){return et(t)?t.slice(2):(t=t.replace(f$1,""),e&&t.length>1&&"/"===t[0]&&"/"===t[1]&&(t=t.slice(2)),t)}function at(t){const e=t.indexOf("//"),n=t.indexOf("/",e+2);return -1===n?t:t.slice(0,n)}function ht(t){let e=0;if(Q$1(t)){const n=t.indexOf("//");-1!==n&&(e=n+2);}const n=t.lastIndexOf("/");return n<e?t:t.slice(0,n+1)}function pt(t,e){if(!t)return "";const n=U$1(t).path.replace(/\/+$/,""),r=n.substring(n.lastIndexOf("/")+1);if(null==e||!e.length)return r;const o=new RegExp(`.(${e.join("|")})$`,"ig");return r.replace(o,"")}function dt(t){return t&&"/"===t[t.length-1]?t:`${t}/`}function gt(t){return t.replace(/\/+$/,"")}function mt(t){if(/^https?:\/\//i.test(t)){const e=v(t);t=(t=e.path.replace(/\/{2,}/g,"/")).replace("/","//"),e.query&&(t+=`?${e.query}`);}return t}function yt(t){return t.replace(/^(https?:\/\/)(arcgis\.com)/i,"$1www.$2")}function $t(t){const e=l.httpsDomains;if(!ot(t))return t;const n=t.indexOf("/",7);let r;if(r=-1===n?t:t.slice(0,n),r=r.toLowerCase().slice(7),d$1.test(r)){if(!r.endsWith(":80"))return t;r=r.slice(0,-3),t=t.replace(":80","");}return lt()&&r===x.authority&&!g.test(t)||(ct()&&r===x.authority||e&&e.some((t=>r===t||r.endsWith(`.${t}`)))||ct()&&!A$1(t))&&(t=ut(t)),t}function xt(t,e,n){if(!(e&&n&&t&&Q$1(t)))return t;const r=t.indexOf("//"),o=t.indexOf("/",r+2),i=t.indexOf(":",r+2),s=Math.min(o<0?t.length:o,i<0?t.length:i);if(t.slice(r+2,s).toLowerCase()!==e.toLowerCase())return t;return `${t.slice(0,r+2)}${n}${t.slice(s)}`}function Ot(t){return "string"==typeof t?new $$1(T(t)):(t.scheme||(t.scheme=x.scheme),t)}function wt(t){return Lt.test(t)}function Ut(t,e){const n=U$1(t),r=Object.keys(n.query||{});return r.length>0&&e&&e.warn("removeQueryParameters()",`Url query parameters are not supported, the following parameters have been removed: ${r.join(", ")}.`),n.path}function bt(t,e,n){const r=U$1(t),o=r.query||{};return o[e]=String(n),`${r.path}?${C(o)}`}function Rt(t,e){const n=U$1(t),r=n.query||{};for(const i in e)r[i]=e[i];const o=C(r);return o?`${n.path}?${o}`:n.path}function qt(t){if(t$3(t))return null;const e=t.match(jt);return e?e[1]:null}const jt=/.*?\.([^\/]*)$/,Lt=/(^data:image\/svg|\.svg$)/i;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
const r$1="4.20",s={request(e,t){var r;const s=null==(r=e.options)?void 0:r.responseType;return Promise.resolve().then(function () { return request; }).then((({default:r})=>{const n=e.options||{};return n.responseType="native"===s||"native-request-init"===s?"native-request-init":"array-buffer",n.signal=null==t?void 0:t.signal,r(e.url,n)})).then((e=>{const t={data:e.data,ssl:e.ssl};return "native-request-init"===e.requestOptions.responseType?(delete t.data.signal,t):{result:t,transferList:[t.data]}}))}};let n$3;function o(e){n$3=e;}function i$1(e){const r=n$3&&n$3.findCredential(e);return r&&r.token?bt(e,"token",r.token):e}s$4("host-webworker")||(s$4("edge")||s$4("trident"))&&console.warn("Deprecated browser - see http://esriurl.com/oldbrowser");

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
const t$1=["elevation3d.arcgis.com","js.arcgis.com","jsdev.arcgis.com","jsqa.arcgis.com","static.arcgis.com"];function r(c){const r=M$1(c,!0);return r&&r.endsWith(".arcgis.com")&&!t$1.includes(r)&&!c.endsWith("/sharing/rest/generateToken")}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
function t(t,i,s=!1,c){return new Promise(((d,a)=>{if(b$2(c))return void a(n$2());let m=()=>{v(),a(new Error(`Unable to load ${i}`));},l=()=>{const e=t;v(),d(e);},u=()=>{if(!t)return;const e=t;v(),e.src="",a(n$2());};const v=()=>{s$4("esri-image-decode")||(t.removeEventListener("error",m),t.removeEventListener("load",l)),m=null,l=null,t=null,r$2(c)&&c.removeEventListener("abort",u),u=null,s&&URL.revokeObjectURL(i);};r$2(c)&&c.addEventListener("abort",u),s$4("esri-image-decode")?t.decode().then(l,m):(t.addEventListener("error",m),t.addEventListener("load",l));}))}function n$2(){try{return new DOMException("Aborted","AbortError")}catch{const e=new Error;return e.name="AbortError",e}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
async function L(e,t){const r=G$1(e),s=F$1(e);s||r||(e=z$1(e));const n={url:e,requestOptions:{...e$1(t)}};let u=B$1(e);if(u){const e=await G(u,n);if(null!=e)return {data:e,getHeader:I,requestOptions:n.requestOptions,url:n.url};u.after||u.error||(u=null);}if(e=n.url,"image"===(t=n.requestOptions).responseType){if(s$4("host-webworker")||s$4("host-node"))throw B("request:invalid-parameters",new Error("responseType 'image' is not supported in Web Workers or Node environment"),n)}else if(r)throw B("request:invalid-parameters",new Error("Data URLs are not supported for responseType = "+t.responseType),n);if("head"===t.method){if(t.body)throw B("request:invalid-parameters",new Error("body parameter cannot be set when method is 'head'"),n);if(r||s)throw B("request:invalid-parameters",new Error("data and blob URLs are not supported for method 'head'"),n)}if(await N(),j)return j.execute(e,t);const c=h$3();v$1(t,(()=>c.abort()));const d={controller:c,credential:null,credentialToken:null,fetchOptions:null,hasToken:!1,interceptor:u,params:n,redoRequest:!1,useIdentity:U.useIdentity,useProxy:!1,useSSL:!1,withCredentials:!1},y=await X(d);return u&&u.after&&u.after(y),y}let j;const U=s$2.request,P="FormData"in e,D=[499,498,403,401],_=["COM_0056","COM_0057","SB_0008"],F=[/\/arcgis\/tokens/i,/\/sharing(\/rest)?\/generatetoken/i,/\/rest\/info/i],I=()=>null,M=Symbol();function R(e){const t=M$1(e);t&&!L._corsServers.includes(t)&&L._corsServers.push(t);}function H(e){const t=M$1(e);return !t||t.endsWith(".arcgis.com")||L._corsServers.includes(t)||J$1(t)}function B(e,t,s,o){let a="Error";const i={url:s.url,requestOptions:s.requestOptions,getHeader:I,ssl:!1};if(t instanceof s$3)return t.details?(t.details=y$1(t.details),t.details.url=s.url,t.details.requestOptions=s.requestOptions):t.details=i,t;if(t){const e=o&&(e=>o.headers.get(e)),r=o&&o.status,s=t.message;s&&(a=s),e&&(i.getHeader=e),i.httpStatus=(null!=t.httpCode?t.httpCode:t.code)||r||0,i.subCode=t.subcode,i.messageCode=t.messageCode,"string"==typeof t.details?i.messages=[t.details]:i.messages=t.details,i.raw=M in t?t[M]:t;}return g$1(t)?m$5():new s$3(e,a,i)}async function N(){s$4("host-webworker")?j||(j=await import('./request-9aa571de.js')):L._abortableFetch||(L._abortableFetch=e.fetch.bind(e));}async function A(){n$3||await import('./IdentityManager-d7d467bf.js');}async function $(r$1){const o=r$1.params.url,n=r$1.params.requestOptions,a=r$1.controller.signal,i=n.body;let l=null,u=null,c=null;if(P&&"HTMLFormElement"in e&&(i instanceof FormData?l=i:i instanceof HTMLFormElement&&(u=i,l=new FormData(u))),"string"==typeof i&&(c=i),r$1.fetchOptions={cache:n.cacheBust&&!L._abortableFetch.polyfill?"no-cache":"default",credentials:"same-origin",headers:n.headers||{},method:"head"===n.method?"HEAD":"GET",mode:"cors",redirect:"follow",signal:a},(l||c)&&(r$1.fetchOptions.body=l||c),"anonymous"===n.authMode&&(r$1.useIdentity=!1),r$1.hasToken=!!(/token=/i.test(o)||n.query&&n.query.token||l&&l.get&&l.get("token")||u&&u.elements.token),!r$1.hasToken&&s$2.apiKey&&r(o)&&(n.query||(n.query={}),n.query.token=s$2.apiKey,r$1.hasToken=!0),r$1.useIdentity&&!r$1.hasToken&&!r$1.credentialToken&&!K(o)&&!b$2(a)){let e;"immediate"===n.authMode?(await A(),e=await n$3.getCredential(o,{signal:a}),r$1.credential=e):"no-prompt"===n.authMode?(await A(),e=await n$3.getCredential(o,{prompt:!1,signal:a}).catch((()=>{})),r$1.credential=e):n$3&&(e=n$3.findCredential(o)),e&&(r$1.credentialToken=e.token,r$1.useSSL=!!e.ssl);}}function K(e){return F.some((t=>t.test(e)))}async function W(e){let r=e.params.url;const s=e.params.requestOptions,n=e.fetchOptions,a=F$1(r)||G$1(r),i=s.responseType||"json",l=a?0:null!=s.timeout?s.timeout:U.timeout;let u=!1;if(!a){e.useSSL&&(r=ut(r)),s.cacheBust&&"default"===n.cache&&(r=bt(r,"request.preventCache",Date.now()));let a={...s.query};e.credentialToken&&(a.token=e.credentialToken);let i=C(a);s$4("esri-url-encodes-apostrophe")&&(i=i.replace(/'/g,"%27"));const l=r.length+1+i.length;let c;u="delete"===s.method||"post"===s.method||"put"===s.method||!!s.body||l>U.maxUrlLength;const d=s.useProxy||!!A$1(r);if(d){const e=q(r);c=e.path,!u&&c.length+1+l>U.maxUrlLength&&(u=!0),e.query&&(a={...e.query,...a});}if("HEAD"===n.method&&(u||d)){if(u){if(l>U.maxUrlLength)throw B("request:invalid-parameters",new Error("URL exceeds maximum length"),e.params);throw B("request:invalid-parameters",new Error("cannot use POST request when method is 'head'"),e.params)}if(d)throw B("request:invalid-parameters",new Error("cannot use proxy when method is 'head'"),e.params)}if(u?(n.method="delete"===s.method?"DELETE":"put"===s.method?"PUT":"POST",s.body?r=Rt(r,a):(n.body=C(a),n.headers["Content-Type"]="application/x-www-form-urlencoded")):r=Rt(r,a),d&&(e.useProxy=!0,r=`${c}?${r}`),a.token&&P&&n.body instanceof FormData){const e=n.body;e.set?e.set("token",a.token):e.append("token",a.token);}if(s.hasOwnProperty("withCredentials"))e.withCredentials=s.withCredentials;else if(!E(r,x))if(J$1(r))e.withCredentials=!0;else if(n$3){const s=n$3.findServerInfo(r);s&&s.webTierAuth&&(e.withCredentials=!0);}e.withCredentials&&(n.credentials="include");}let d,f,h=0,C$1=!1;l>0&&(h=setTimeout((()=>{C$1=!0,e.controller.abort();}),l));try{if("native-request-init"===s.responseType)f=n,f.url=r;else if("image"!==s.responseType||"default"!==n.cache||"GET"!==n.method||u||z(s.headers)||!a&&!e.useProxy&&U.proxyUrl&&!H(r)){if(d=await L._abortableFetch(r,n),e.useProxy||R(r),"native"===s.responseType)f=d;else if("HEAD"!==n.method)if(d.ok){switch(i){case"array-buffer":f=await d.arrayBuffer();break;case"blob":case"image":f=await d.blob();break;default:f=await d.text();}if(h&&(clearTimeout(h),h=0),"json"===i||"xml"===i||"document"===i)if(f)switch(i){case"json":f=JSON.parse(f);break;case"xml":f=J(f,"application/xml");break;case"document":f=J(f,"text/html");}else f=null;if(f){if("array-buffer"===i||"blob"===i){const e=d.headers.get("Content-Type");if(/application\/json|text\/plain/i.test(e)&&f["blob"===i?"size":"byteLength"]<=750)try{const e=await new Response(f).json();e.error&&(f=e);}catch{}}"image"===i&&f instanceof Blob&&(f=await V(URL.createObjectURL(f),e,!0));}}else f=await d.text();}else f=await V(r,e);}catch(E){if("AbortError"===E.name){if(C$1)throw new Error("Timeout exceeded");throw m$5("Request canceled")}if(!(!d&&E instanceof TypeError&&U.proxyUrl)||s.body||"delete"===s.method||"head"===s.method||"post"===s.method||"put"===s.method||e.useProxy||H(r))throw E;e.redoRequest=!0,S({proxyUrl:U.proxyUrl,urlPrefix:M$1(r)});}finally{h&&clearTimeout(h);}return [d,f]}async function G(e,t){if(null!=e.responseData)return e.responseData;if(e.headers&&(t.requestOptions.headers={...t.requestOptions.headers,...e.headers}),e.query&&(t.requestOptions.query={...t.requestOptions.query,...e.query}),e.before){let o,n;try{n=await e.before(t);}catch(s){o=B("request:interceptor",s,t);}if((n instanceof Error||n instanceof s$3)&&(o=B("request:interceptor",n,t)),o)throw e.error&&e.error(o),o;return n}}function z(e){if(e)for(const t of Object.getOwnPropertyNames(e))if(e[t])return !0;return !1}function J(e,t){let r;try{r=(new DOMParser).parseFromString(e,t);}catch{}if(!r||r.getElementsByTagName("parsererror").length)throw new SyntaxError("XML Parse error");return r}async function X(e){var r,s;let o,n;await $(e);try{do{[o,n]=await W(e);}while(!await Q(e,o,n))}catch(l){const t=B("request:server",l,e.params,o);throw t.details.ssl=e.useSSL,e.interceptor&&e.interceptor.error&&e.interceptor.error(t),t}const a=e.params.url;if(/\/sharing\/rest\/(accounts|portals)\/self/i.test(a)&&!e.hasToken&&!e.credentialToken&&null!=(r=n)&&null!=(s=r.user)&&s.username&&!J$1(a)){const e=M$1(a,!0);e&&U.trustedServers.push(e);}const i=e.credential;if(i&&n$3){const e=n$3.findServerInfo(i.server);let r=e&&e.owningSystemUrl;if(r){r=r.replace(/\/?$/,"/sharing");const e=n$3.findCredential(r,i.userId);e&&-1===n$3._getIdenticalSvcIdx(r,e)&&e.resources.unshift(r);}}return {data:n,getHeader:o?e=>o.headers.get(e):I,requestOptions:e.params.requestOptions,ssl:e.useSSL,url:e.params.url}}async function Q(e,r,s){if(e.redoRequest)return e.redoRequest=!1,!1;const o=e.params.requestOptions;if(!r||"native"===o.responseType||"native-request-init"===o.responseType)return !0;let n,a,i,l;if(!r.ok)throw n=new Error(`Unable to load ${r.url} status: ${r.status}`),n[M]=s,n;null!=s&&s.error&&(n=s.error),n&&(a=Number(n.code),i=n.hasOwnProperty("subcode")?Number(n.subcode):null,l=n.messageCode,l=l&&l.toUpperCase());const u=o.authMode;if(403===a&&(4===i||n.message&&n.message.toLowerCase().indexOf("ssl")>-1&&-1===n.message.toLowerCase().indexOf("permission"))){if(!e.useSSL)return e.useSSL=!0,!1}else if(!e.hasToken&&e.useIdentity&&("no-prompt"!==u||498===a)&&-1!==D.indexOf(a)&&!K(e.params.url)&&(403!==a||-1===_.indexOf(l)&&(null==i||2===i&&e.credentialToken))){await A();try{const r=await n$3.getCredential(e.params.url,{error:B("request:server",n,e.params),prompt:"no-prompt"!==u,signal:e.controller.signal,token:e.credentialToken});return e.credential=r,e.credentialToken=r.token,e.useSSL=e.useSSL||r.ssl,!1}catch(c){if("no-prompt"===u)return e.credential=null,e.credentialToken=null,!1;n=c;}}if(n)throw n;return !0}function V(e,t$1,r=!1){const s=t$1.controller.signal,o=new Image;return t$1.withCredentials?o.crossOrigin="use-credentials":o.crossOrigin="anonymous",o.alt="",o.src=e,t(o,e,r,s)}L._abortableFetch=null,L._corsServers=["https://server.arcgisonline.com","https://services.arcgisonline.com"];

var request = /*#__PURE__*/Object.freeze({
	__proto__: null,
	'default': L
});

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
class i{constructor(){this._emitter=new i.EventEmitter(this);}emit(t,e){return this._emitter.emit(t,e)}on(t,e){return this._emitter.on(t,e)}once(t,e){return this._emitter.once(t,e)}hasEventListener(t){return this._emitter.hasEventListener(t)}}!function(n){class o{constructor(t=null){this.target=t,this._listenersMap=null;}clear(){this._listenersMap&&this._listenersMap.clear();}emit(t,e){const s=this._listenersMap&&this._listenersMap.get(t);if(!s)return !1;const r=this.target||this;return [...s].forEach((t=>{t.call(r,e);})),s.length>0}on(t,e){if(Array.isArray(t)){const r=t.map((t=>this.on(t,e)));return r$3(r)}if(t.indexOf(",")>-1)throw new TypeError("Evented.on() with a comma delimited string of event types is not supported");this._listenersMap||(this._listenersMap=new Map);const r=this._listenersMap.get(t)||[];return r.push(e),this._listenersMap.set(t,r),{remove:()=>{const s=this._listenersMap&&this._listenersMap.get(t)||[],r=s.indexOf(e);r>=0&&s.splice(r,1);}}}once(t,e){const s=this.on(t,(t=>{s.remove(),e.call(null,t);}));return s}hasEventListener(t){const e=this._listenersMap&&this._listenersMap.get(t);return null!=e&&e.length>0}}n.EventEmitter=o,n.EventedMixin=e=>{let s=class extends e{constructor(){super(...arguments),this._emitter=new o;}destroy(){this._emitter.clear();}emit(t,e){return this._emitter.emit(t,e)}on(t,e){return this._emitter.on(t,e)}once(t,e){return this._emitter.once(t,e)}hasEventListener(t){return this._emitter.hasEventListener(t)}};return s=e$2([n$5("esri.core.Evented")],s),s};let h=class extends p$3{constructor(){super(...arguments),this._emitter=new i.EventEmitter(this);}emit(t,e){return this._emitter.emit(t,e)}on(t,e){return this._emitter.on(t,e)}once(t,e){return this._emitter.once(t,e)}hasEventListener(t){return this._emitter.hasEventListener(t)}};h=e$2([n$5("esri.core.Evented")],h),n.EventedAccessor=h;}(i||(i={}));var n$1=i;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
class h$1{constructor(s){this.instance=s,this._resolver=E$1(),this._status=0,this._resolvingPromises=[],this._resolver.promise.then((()=>{this._status=1,this._cleanUp();}),(()=>{this._status=2,this._cleanUp();}));}addResolvingPromise(s){this._resolvingPromises.push(s),this._tryResolve();}isResolved(){return 1===this._status}isRejected(){return 2===this._status}isFulfilled(){return 0!==this._status}abort(){this._resolver.reject(m$5());}when(s,e){return this._resolver.promise.then(s,e)}_cleanUp(){this._allPromise=this._resolvingPromises=this._allPromise=null;}_tryResolve(){if(this.isFulfilled())return;const s=E$1(),e=[...this._resolvingPromises,m$4(s.promise)],t=this._allPromise=Promise.all(e);t.then((()=>{this.isFulfilled()||this._allPromise!==t||this._resolver.resolve(this.instance);}),(s=>{this.isFulfilled()||this._allPromise!==t||g$1(s)||this._resolver.reject(s);})),s.resolve();}}const n=e=>{let i=class extends e{constructor(...s){super(...s),this._promiseProps=new h$1(this),this.addResolvingPromise(Promise.resolve());}isResolved(){return this._promiseProps.isResolved()}isRejected(){return this._promiseProps.isRejected()}isFulfilled(){return this._promiseProps.isFulfilled()}when(s,e){return new Promise(((s,e)=>{this._promiseProps.when(s,e);})).then(s,e)}catch(s){return this.when(null,s)}addResolvingPromise(s){s&&!this._promiseProps.isFulfilled()&&this._promiseProps.addResolvingPromise("_promiseProps"in s?s.when():s);}};return i=e$2([n$5("esri.core.Promise")],i),i};let m$1=class extends(n(p$3)){};m$1=e$2([n$5("esri.core.Promise")],m$1);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
const d="not-loaded",u="loading",c="failed",h="loaded",p=s=>{let p=class extends s{constructor(...o){super(...o),this._loadController=null,this.loadError=null,this.loadStatus="not-loaded",this._set("loadWarnings",[]),this.addResolvingPromise(new Promise((o=>{const s=this.load.bind(this);this.load=a=>{const i=new Promise(((o,s)=>{const e=P$2(a,s);this.destroyed&&s(new s$3("load:instance-destroyed",`Instance of '${this.declaredClass||this.constructor.name}' is already destroyed`,{instance:this})),this._promiseProps.when(o,s).finally((()=>{e&&e.remove();}));}));if(this.loadStatus===d){this._set("loadStatus",u);const o=this._loadController=h$3();s({signal:o.signal}),v$1(o.signal,(()=>{this._promiseProps.abort();}));}return o(),i};}))),this.when((()=>{this._set("loadStatus",h),this._loadController=null;}),(o=>{this._set("loadStatus",c),this._set("loadError",o),this._loadController=null;}));}get loaded(){return this.loadStatus===h}get loadWarnings(){return this._get("loadWarnings")}load(){return null}cancelLoad(){var o;return this.isFulfilled()||(this._set("loadError",new s$3("load:cancelled","Cancelled")),null==(o=this._loadController)||o.abort()),this}};return e$2([y$2({readOnly:!0})],p.prototype,"loaded",null),e$2([y$2({readOnly:!0})],p.prototype,"loadError",void 0),e$2([y$2()],p.prototype,"loadStatus",void 0),e$2([y$2({type:[t$4],readOnly:!0})],p.prototype,"loadWarnings",null),p=e$2([n$5("esri.core.Loadable")],p),p};let m=class extends(p(m$1)){};m=e$2([n$5("esri.core.Loadable")],m),function(o){function t(o){return !(!o||!o.load)}o.LoadableMixin=p,o.isLoadable=t;}(m||(m={}));var f=m;

export { $$1 as $, A$1 as A, rt as B, C, D$1 as D, E, F$1 as F, G$1 as G, H$1 as H, ut as I, w as J, request as K, L, M$1 as M, P$1 as P, Q$1 as Q, Rt as R, T, U$1 as U, V$1 as V, W$1 as W, X$1 as X, n$3 as a, Ut as b, x as c, n as d, i$2 as e, f, gt as g, ht as h, i$3 as i, et as j, j$1 as k, i$1 as l, m$1 as m, n$1 as n, t as o, pt as p, b as q, r$1 as r, s, t$2 as t, o as u, r as v, wt as w, xt as x, qt as y, z$1 as z };
